if (self.CavalryLogger) { CavalryLogger.start_js(["HkLYr"]); }

__d("IrisProtocolMessageLifetime",[],(function a(b,c,d,e,f,g){f.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:30000,TTL_1MINUTE:60000,TTL_3MINUTES:180000,TTL_5MINUTES:300000,TTL_10MINUTES:600000,TTL_15MINUTES:900000,TTL_30MINUTES:1800000,TTL_1HOUR:3600000,TTL_2HOURS:7200000,TTL_4HOURS:14400000,TTL_8HOURS:28800000,TTL_12HOURS:43200000,TTL_24HOURS:86400000}}),null);
__d("MessageLiveLocationClientSyncProtocolStopReason",[],(function a(b,c,d,e,f,g){f.exports={EXPIRED:1,CANCELED:2,ARRIVED:3}}),null);
__d('DockTabsViewportFantaTabUtils',[],(function a(b,c,d,e,f,g){'use strict';var h=269;function i(){return h+1}function j(m){return Math.floor(m/h)}function k(m){if(!m)return null;var n=m.fantaTabModelStateGetter;return n?n():null}function l(m){return m?m.size:0}f.exports={getTabCountToFitWidth:j,getMinRequiredWidthForFirstFantaTab:i,getFantaTabModelFromCallbacks:k,getNumFantaTabsFromModel:l}}),null);
__d('DockTabsViewportPinnedConversationTabUtils',[],(function a(b,c,d,e,f,g){'use strict';var h=496+9+2,i=210+9+2,j=52;function k(){return h}function l(){return i}function m(){return j}function n(r){return r.getIsRaised()?k():l()}function o(){return k()+j}function p(r){var s=r||{},t=s.pinnedConvoTabStateGetter;return t?t():null}function q(r){return r?r.getTotalTabCount():0}f.exports={getRaisedPinnedConvoTabWidth:k,getLoweredPinnedConvoTabWidth:l,getPinnedConvoSelectorWidth:m,getPinnedConvoTabWidth:n,getMinRequiredWidthForFirstConvoTab:o,getPinnedConvoTabsStateFromCallbacks:p,getNumPinnedConvoTabsFromModel:q}}),null);
__d('DockTabsViewportCalculator',['csx','Arbiter','DataStore','Dock','DockTabsViewportFantaTabUtils','DockTabsViewportPinnedConversationTabUtils','DOM','Event','FullScreen','PinnedConversationNubsConfig','SubscriptionsHandler','Vector','ViewportBounds','ge','getViewportDimensions','setImmediate'],(function a(b,c,d,e,f,g,h){'use strict';var i=50,j=35,k=j,l='dock-tab-viewport-inst',m=c('DockTabsViewportFantaTabUtils').getMinRequiredWidthForFirstFantaTab,n=c('DockTabsViewportFantaTabUtils').getFantaTabModelFromCallbacks,o=c('DockTabsViewportFantaTabUtils').getNumFantaTabsFromModel,p=c('DockTabsViewportPinnedConversationTabUtils').getMinRequiredWidthForFirstConvoTab,q=c('DockTabsViewportPinnedConversationTabUtils').getNumPinnedConvoTabsFromModel,r=c('DockTabsViewportPinnedConversationTabUtils').getPinnedConvoTabsStateFromCallbacks;function s(u){return u?c('Vector').getElementDimensions(u).x:0}function t(u){this.$DockTabsViewportCalculatorImpl1=u;this.$DockTabsViewportCalculatorImpl3=0;this.$DockTabsViewportCalculatorImpl4=0;this.$DockTabsViewportCalculatorImpl5=null;this.$DockTabsViewportCalculatorImpl6=null;this.$DockTabsViewportCalculatorImpl7=false;this.$DockTabsViewportCalculatorImpl8=false;this.$DockTabsViewportCalculatorImpl9=false;this.$DockTabsViewportCalculatorImpl2=new (c('SubscriptionsHandler'))();this.$DockTabsViewportCalculatorImpl10();this.$DockTabsViewportCalculatorImpl11()}t.prototype.$DockTabsViewportCalculatorImpl10=function(){var u=this.$DockTabsViewportCalculatorImpl12.bind(this);this.$DockTabsViewportCalculatorImpl2.addSubscriptions(c('Event').listen(window,'resize',u),c('Dock').subscribe('resize',u),c('Arbiter').subscribeOnce('sidebar/initialized',u,c('Arbiter').SUBSCRIBE_NEW),c('FullScreen').subscribe('changed',function(){if(c('FullScreen').isFullScreen()){this.$DockTabsViewportCalculatorImpl7=true;this.$DockTabsViewportCalculatorImpl8=false}else{this.$DockTabsViewportCalculatorImpl7=false;if(this.$DockTabsViewportCalculatorImpl8){c('setImmediate')(function(){u()});this.$DockTabsViewportCalculatorImpl8=false}}}.bind(this)))};t.prototype.registerFantaTabCallbacks=function(u){this.$DockTabsViewportCalculatorImpl5=u};t.prototype.registerPinnedConvoTabCallbacks=function(u){this.$DockTabsViewportCalculatorImpl6=u};t.prototype.forceRecalculateFBDockWidth=function(){this.$DockTabsViewportCalculatorImpl11();this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:false,pinnedConvoUpdateData:null})};t.prototype.forceRecalculateChatTabs=function(){this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:true,pinnedConvoUpdateData:null})};t.prototype.forceRecalculatePinnedConvoTabs=function(u){this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:true,pinnedConvoUpdateData:u})};t.prototype.$DockTabsViewportCalculatorImpl12=function(){if(c('FullScreen').isFullScreen()||this.$DockTabsViewportCalculatorImpl7){this.$DockTabsViewportCalculatorImpl8=true;return}this.forceRecalculateFBDockWidth()};t.prototype.$DockTabsViewportCalculatorImpl13=function(u){var v=u.forceRecalculateChatTabs,w=u.pinnedConvoUpdateData,x=this.$DockTabsViewportCalculatorImpl14(),y=x.chatTabAvailableWidth,z=x.pinnedConvoTabAvailableWidth;this.$DockTabsViewportCalculatorImpl15(y,!!v);this.$DockTabsViewportCalculatorImpl16(z,w)};t.prototype.$DockTabsViewportCalculatorImpl16=function(u,v){var w=this.$DockTabsViewportCalculatorImpl6||{},x=w.onAvailableWidthChanged;x&&x(u,v)};t.prototype.$DockTabsViewportCalculatorImpl15=function(u,v){var w=this.$DockTabsViewportCalculatorImpl5||{},x=w.onAvailableWidthChanged;x&&x(u)};t.prototype.$DockTabsViewportCalculatorImpl17=function(){var u=n(this.$DockTabsViewportCalculatorImpl5);return o(u)};t.prototype.$DockTabsViewportCalculatorImpl18=function(){return m()};t.prototype.$DockTabsViewportCalculatorImpl14=function(){var u=this.$DockTabsViewportCalculatorImpl3,v={chatTabAvailableWidth:u,pinnedConvoTabAvailableWidth:0},w={chatTabAvailableWidth:0,pinnedConvoTabAvailableWidth:u},x=this.$DockTabsViewportCalculatorImpl17(),y=r(this.$DockTabsViewportCalculatorImpl6),z=q(y);if(!y||z===0){return v}else if(x===0)return w;var aa=this.$DockTabsViewportCalculatorImpl18();if(u<=aa)return v;var ba=p(),ca=u-aa,da=0;if(ca<ba){if(c('PinnedConversationNubsConfig').chatTabTypingPriority&&y&&(y.anyTabHasText()||y.anyTabHasFocus())){return w}else return v;}else da=ba;var ea=da,fa=Math.max(aa,u-da);return {chatTabAvailableWidth:fa,pinnedConvoTabAvailableWidth:ea}};t.prototype.$DockTabsViewportCalculatorImpl11=function(){this.$DockTabsViewportCalculatorImpl3=this.$DockTabsViewportCalculatorImpl19();this.$DockTabsViewportCalculatorImpl20('DockTabsViewportCalculator/recalcTotalDock_FOR_TEST_ONLY')};t.prototype.$DockTabsViewportCalculatorImpl21=function(){var u=this.$DockTabsViewportCalculatorImpl1;if(!u)return {buddyListNubWidth:0,employeeNubsWidth:0};var v=s(u),w=s(c('DOM').find(u,"._56ox")),x=s(c('DOM').scry(u,"._56oy")[0]),y=s(c('DOM').scry(u,"._ph1")[0]),z=Math.max(v-w-x-y,0);return {buddyListNubWidth:w,employeeNubsWidth:z}};t.prototype.$DockTabsViewportCalculatorImpl19=function(){var u=c('getViewportDimensions').withoutScrollbars().width;u-=c('ViewportBounds').getLeft()+c('ViewportBounds').getRight();u-=i;var v=this.$DockTabsViewportCalculatorImpl21(),w=v.buddyListNubWidth,x=v.employeeNubsWidth;u-=w;this.$DockTabsViewportCalculatorImpl4=Math.max(this.$DockTabsViewportCalculatorImpl4,x);u-=this.$DockTabsViewportCalculatorImpl4;u-=k;return Math.max(u,0)};t.prototype.enableTestInforms_FOR_TEST_ONLY=function(){this.$DockTabsViewportCalculatorImpl9=true};t.prototype.$DockTabsViewportCalculatorImpl20=function(u){if(this.$DockTabsViewportCalculatorImpl9)c('Arbiter').inform(u);};t.prototype.getChatTabAvailableDockWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl14().chatTabAvailableWidth};t.prototype.getPinnedConvoTabAvailableDockWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl14().pinnedConvoTabAvailableWidth};t.prototype.getAvailableTotalWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl3};f.exports={getInstance:function u(v){var w=c('ge')('pagelet_dock');if(!w||!c('DOM').contains(w,v))return null;var x=c('DataStore').get(w,l);if(x instanceof t)return x;var y=c('DOM').scry(w,'.fbDockWrapperRight .fbDock')[0];x=new t(y);c('DataStore').set(w,l,x);return x}}}),null);
__d('MercurySyncHolesTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear()}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:MercurySyncHolesLoggerConfig',this.$MercurySyncHolesTypedLogger1,c('Banzai').BASIC)};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:MercurySyncHolesLoggerConfig',this.$MercurySyncHolesTypedLogger1,c('Banzai').VITAL)};h.prototype.clear=function(){this.$MercurySyncHolesTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MercurySyncHolesTypedLogger1=babelHelpers['extends']({},this.$MercurySyncHolesTypedLogger1,j);return this};h.prototype.setDifference=function(j){this.$MercurySyncHolesTypedLogger1.difference=j;return this};h.prototype.setSeqID=function(j){this.$MercurySyncHolesTypedLogger1.seq_id=j;return this};h.prototype.setTopicType=function(j){this.$MercurySyncHolesTypedLogger1.topic_type=j;return this};h.prototype.setVC=function(j){this.$MercurySyncHolesTypedLogger1.vc=j;return this};var i={difference:true,seq_id:true,topic_type:true,vc:true};f.exports=h}),null);
__d('OmniMEventTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear()}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:OmniMEventLoggerConfig',this.$OmniMEventTypedLogger1,c('Banzai').BASIC)};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:OmniMEventLoggerConfig',this.$OmniMEventTypedLogger1,c('Banzai').VITAL)};h.prototype.clear=function(){this.$OmniMEventTypedLogger1={};return this};h.prototype.updateData=function(j){this.$OmniMEventTypedLogger1=babelHelpers['extends']({},this.$OmniMEventTypedLogger1,j);return this};h.prototype.setActionID=function(j){this.$OmniMEventTypedLogger1.action_id=j;return this};h.prototype.setActionSubTypeFromBlob=function(j){this.$OmniMEventTypedLogger1.action_sub_type_from_blob=j;return this};h.prototype.setActionTypeFromBlob=function(j){this.$OmniMEventTypedLogger1.action_type_from_blob=j;return this};h.prototype.setAgentName=function(j){this.$OmniMEventTypedLogger1.agent_name=j;return this};h.prototype.setAppID=function(j){this.$OmniMEventTypedLogger1.appid=j;return this};h.prototype.setAppversion=function(j){this.$OmniMEventTypedLogger1.appversion=j;return this};h.prototype.setClientUserID=function(j){this.$OmniMEventTypedLogger1.client_userid=j;return this};h.prototype.setClienttime=function(j){this.$OmniMEventTypedLogger1.clienttime=j;return this};h.prototype.setConfidence=function(j){this.$OmniMEventTypedLogger1.confidence=j;return this};h.prototype.setConfidenceRemapped=function(j){this.$OmniMEventTypedLogger1.confidence_remapped=j;return this};h.prototype.setContextUserID=function(j){this.$OmniMEventTypedLogger1.context_user_id=j;return this};h.prototype.setCuApp=function(j){this.$OmniMEventTypedLogger1.cu_app=j;return this};h.prototype.setDetectedLanguage=function(j){this.$OmniMEventTypedLogger1.detected_language=j;return this};h.prototype.setEventName=function(j){this.$OmniMEventTypedLogger1.event_name=j;return this};h.prototype.setIntentID=function(j){this.$OmniMEventTypedLogger1.intent_id=j;return this};h.prototype.setLiveLocationSuggestionsEnabled=function(j){this.$OmniMEventTypedLogger1.live_location_suggestions_enabled=j;return this};h.prototype.setLocationSuggestionsEnabled=function(j){this.$OmniMEventTypedLogger1.location_suggestions_enabled=j;return this};h.prototype.setMBarDisplayedOnThreadEnter=function(j){this.$OmniMEventTypedLogger1.m_bar_displayed_on_thread_enter=j;return this};h.prototype.setMessageID=function(j){this.$OmniMEventTypedLogger1.message_id=j;return this};h.prototype.setMessageLength=function(j){this.$OmniMEventTypedLogger1.message_length=j;return this};h.prototype.setName=function(j){this.$OmniMEventTypedLogger1.name=j;return this};h.prototype.setNumberOfCalendarEvents=function(j){this.$OmniMEventTypedLogger1.number_of_calendar_events=j;return this};h.prototype.setPersonalization=function(j){this.$OmniMEventTypedLogger1.personalization=j;return this};h.prototype.setPigeonID=function(j){this.$OmniMEventTypedLogger1.pigeon_id=j;return this};h.prototype.setPosition=function(j){this.$OmniMEventTypedLogger1.position=j;return this};h.prototype.setRemovedLocationSuggestions=function(j){this.$OmniMEventTypedLogger1.removed_location_suggestions=j;return this};h.prototype.setSerializedActions=function(j){this.$OmniMEventTypedLogger1.serialized_actions=c('GeneratedLoggerUtils').serializeVector(j);return this};h.prototype.setSource=function(j){this.$OmniMEventTypedLogger1.source=j;return this};h.prototype.setSuggestionData=function(j){this.$OmniMEventTypedLogger1.suggestion_data=c('GeneratedLoggerUtils').serializeMap(j);return this};h.prototype.setSuggestionIds=function(j){this.$OmniMEventTypedLogger1.suggestion_ids=c('GeneratedLoggerUtils').serializeVector(j);return this};h.prototype.setSuggestionMode=function(j){this.$OmniMEventTypedLogger1.suggestion_mode=j;return this};h.prototype.setSuggestionTitle=function(j){this.$OmniMEventTypedLogger1.suggestion_title=j;return this};h.prototype.setSuggestionType=function(j){this.$OmniMEventTypedLogger1.suggestion_type=j;return this};h.prototype.setThreadID=function(j){this.$OmniMEventTypedLogger1.thread_id=j;return this};h.prototype.setTotalSuggestions=function(j){this.$OmniMEventTypedLogger1.total_suggestions=j;return this};h.prototype.setVC=function(j){this.$OmniMEventTypedLogger1.vc=j;return this};var i={action_id:true,action_sub_type_from_blob:true,action_type_from_blob:true,agent_name:true,appid:true,appversion:true,client_userid:true,clienttime:true,confidence:true,confidence_remapped:true,context_user_id:true,cu_app:true,detected_language:true,event_name:true,intent_id:true,live_location_suggestions_enabled:true,location_suggestions_enabled:true,m_bar_displayed_on_thread_enter:true,message_id:true,message_length:true,name:true,number_of_calendar_events:true,personalization:true,pigeon_id:true,position:true,removed_location_suggestions:true,serialized_actions:true,source:true,suggestion_data:true,suggestion_ids:true,suggestion_mode:true,suggestion_title:true,suggestion_type:true,thread_id:true,total_suggestions:true,vc:true};f.exports=h}),null);
__d('ChatActivity',['Arbiter','Event','JSLogger','MercuryConfig','PresenceState','UserActivity'],(function a(b,c,d,e,f,g){var h=c('MercuryConfig').activity_limit||60000,i=c('MercuryConfig').idle_limit||1800000,j=c('MercuryConfig').idle_poll_interval||300000,k=c('JSLogger').create('chat_activity'),l=Date.now(),m=true;function n(){var r=Date.now();return !!(m&&r-l<h)}var o=Object.assign(new (c('Arbiter'))(),{isActive:n});function p(){var r=l;l=Date.now();if(l-r>i){k.debug('idle_to_active',r);c('PresenceState').doSync()}o.inform('activity')}c('Event').listen(window,'focus',function(){m=true;p()});c('Event').listen(window,'blur',function(){m=false});c('UserActivity').subscribe(function(){p()});function q(r){var s=r&&r.at&&c('PresenceState').verifyNumber(r.at);if(typeof s!=='number')s=null;return s||0}setInterval(function(){var r=Date.now(),s=q(c('PresenceState').get()),t=Math.max(l,s);if(r-t>i){k.debug('idle',{cookie:s,local:l});o.inform('idle',r-t)}},j);c('PresenceState').registerStateStorer(function(r){var s=q(r);if(s<l)r.at=l;return r});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(r,s){s.chat_activity={activity_limit:h,idle_limit:i,idle_poll_interval:j,last_active_time:l}});f.exports=o}),null);
__d('MercuryNotificationRenderer',['fbt','MercuryAssert','MercuryIDs','MercuryMessages','MercuryParticipants','MercuryThreads','MercuryViewer','MessagingGenericAdminTextType'],(function a(b,c,d,e,f,g,h){var i=c('MercuryMessages').get(),j=c('MercuryThreads').get(),k='source:messenger_growth:event_upcoming_bump';function l(m,n){c('MercuryAssert').isThreadID(m);j.getThreadMeta(m,function(o){i.getThreadMessagesRange(m,0,1,function(p){var q=p.length&&p[p.length-1],r=[];if(q.tags!==undefined)r=r.concat(q.tags);if(q.log_message_data&&(q.log_message_data.message_type==c('MessagingGenericAdminTextType').CONFIRM_FRIEND_REQUEST||q.log_message_data.message_type==c('MessagingGenericAdminTextType').WORK_INVITE_CLAIMED)){n(h._("New contact added"))}else if(r.indexOf(k)!==-1){n(h._("You have an upcoming event."))}else if(q&&q.author!=c('MercuryViewer').getID()){c('MercuryParticipants').get(q.author,function(s){var t=s.short_name,u=o.custom_nickname;if(u){var v=c('MercuryIDs').getUserIDFromParticipantID(s.id);if(u[v])t=u[v];}if(o.name){n(h._("{senderName} messaged {groupName}",[h.param('senderName',t),h.param('groupName',o.name)]))}else if(c('MercuryIDs').isGroupChat(m)){n(h._("{name} messaged your group",[h.param('name',t)]))}else n(h._("{name} messaged you",[h.param('name',t)]));})}else n(h._("New message!"));})})}f.exports={renderDocumentTitle:l}}),null);
__d('MercuryTimestampTracker',['MercuryActionType','MercuryDispatcher','MercuryPayloadSource','MercurySingletonProvider'],(function a(b,c,d,e,f,g){'use strict';h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};function h(j){this.$MercuryTimestampTracker1=j;this.$MercuryTimestampTracker3=0;this.$MercuryTimestampTracker2=c('MercuryDispatcher').getForFBID(this.$MercuryTimestampTracker1);this.$MercuryTimestampTracker2.subscribe('update-messages',this.$MercuryTimestampTracker4.bind(this))}h.prototype.$MercuryTimestampTracker4=function(j,k){if(!k.actions||!k.actions.length)return;if(k.payload_source===c('MercuryPayloadSource').CLIENT_SEND_MESSAGE||k.payload_source===c('MercuryPayloadSource').UNKNOWN)return;for(var l=0;l<k.actions.length;l++){var m=k.actions[l],n=m.action_type;if(n==c('MercuryActionType').USER_GENERATED_MESSAGE&&m.thread_id&&m.timestamp>this.$MercuryTimestampTracker3)this.$MercuryTimestampTracker3=m.timestamp;}};h.prototype.getLastUserMessageTimestamp=function(){return this.$MercuryTimestampTracker3};var i=new (c('MercurySingletonProvider'))(h);f.exports=h}),null);
__d('ChatTitleBarBlinker',['ChatActivity','DocumentTitle','JSLogger','MercuryThreadInformer','MercuryNotificationRenderer','PresenceState','MercuryTimestampTracker'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadInformer').get(),i=c('MercuryTimestampTracker').get(),j=c('JSLogger').create('chat_title'),k=null,l=0,m=false;function n(){if(k){k.stop();k=null;return true}return false}function o(u){var v=u||i.getLastUserMessageTimestamp();if(l<=v){l=v;if(n()||m)c('PresenceState').doSync();}}var p={blink:function u(v,w){if(!k&&l<w)c('MercuryNotificationRenderer').renderDocumentTitle(v,function(x){if(!k)k=c('DocumentTitle').blink(x);});},stopBlinking:function u(){o()},blinkingElsewhere:function u(){m=true}};function q(u){var v=c('PresenceState').verifyNumber(u.sb2);if(!v||v<=l)return null;return v}function r(u){var v=u&&q(u);if(v){l=v;j.debug('load',l);n();m=false}}function s(u){var v=q(u);if(!v){j.debug('store',l);u.sb2=l;m=false}return u}c('PresenceState').registerStateStorer(s);c('PresenceState').registerStateLoader(r);h.subscribe('thread-read-changed',function(u,v){var w=i.getLastUserMessageTimestamp(),x=0;for(var y in v)if(v[y].mark_as_read&&v[y].timestamp>=w&&v[y].timestamp>x)x=v[y].timestamp;x&&o(x)});c('ChatActivity').subscribe('activity',function(){return o()});var t=c('PresenceState').getInitial();if(t)l=q(t)||0;f.exports=p}),null);
__d('MercuryIgnoredBlockedParticipantsRe',['bs_caml_obj','bs_js_boolean','MercuryIDs'],(function a(b,c,d,e,f,g){'use strict';function h(l,m,n){var o=n.participants.filter(function(p){return c('bs_caml_obj').caml_notequal(p,c('MercuryIDs').getParticipantIDFromUserID(l))});return o.filter(function(p){return +(+m.has(p)!==0)})}function i(l,m,n){return c('bs_js_boolean').to_js_boolean(1- +n.is_canonical&&+(h(l,m,n).length>0))}function j(l,m,n){if(n.is_canonical){return []}else return h(l,m,n);}function k(l,m,n){var o=+n.is_canonical;if(o!==0){var p=n.participants.filter(function(q){return c('bs_caml_obj').caml_notequal(q,c('MercuryIDs').getParticipantIDFromUserID(l))});return c('bs_js_boolean').to_js_boolean(1- +p.every(function(q){return 1- +m.has(q)}))}else return false;}g.findIntersection=h;g.isPresentInGroupThread=i;g.participantsInGroupThread=j;g.qualifiesAs=k}),null);
__d('mercuryBlockedParticipantsRe',['Set','utilsRe','MercuryIDs','bs_js_primitive','MercuryDispatcher','mercurySingletonProviderRe','MercuryIgnoredBlockedParticipantsRe'],(function a(b,c,d,e,f,g){'use strict';function h(m,n){var o=n.message_blocked_ids;if(o==null){return 0}else{o.forEach(function(p){if(m.has(p)){+m['delete'](p);return 0}else{m.add(p);return 0}});return 0}}function i(m){var n=new (c('Set'))(),o=c('MercuryDispatcher').getForFBID(m);o.subscribe("update-blocked-users",function(p,q){var r=q.actions;if(!(r==null))r.forEach(function(t){return h(n,t)});h(n,q);var s=c('utilsRe').$pipe$unknown(c('bs_js_primitive').null_undefined_to_opt(q.participants),[]);s.forEach(function(t){var u=c('utilsRe').nullUndefinedBooleanToOptionBool(t.is_messenger_blocked),v=t.fbid;if(u){if(u[0]!==0){if(v==null){return 0}else{n.add(c('MercuryIDs').getParticipantIDFromUserID(v));return 0}}else if(v==null){return 0}else{+n['delete'](c('MercuryIDs').getParticipantIDFromUserID(v));return 0}}else return 0;});return 0});return {findIntersection:function p(q){return c('MercuryIgnoredBlockedParticipantsRe').findIntersection(m,n,q)},isPresentInGroupThread:function p(q){return c('MercuryIgnoredBlockedParticipantsRe').isPresentInGroupThread(m,n,q)},blockedParticipantsInGroupThread:function p(q){return c('MercuryIgnoredBlockedParticipantsRe').participantsInGroupThread(m,n,q)},isMessageBlocked:function p(q){return c('MercuryIgnoredBlockedParticipantsRe').qualifiesAs(m,n,q)},__fbid:m}}var j=c('mercurySingletonProviderRe').Provider([i]),k=j[0],l=j[1];g.getForFBID=k;g.get=l}),null);
__d('MercuryBrowserAlerts',['ArbiterMixin','ChatActivity','ChatConfig','ChatOptions','ChatTitleBarBlinker','Event','Map','mercuryBlockedParticipantsRe','MercuryIDs','MercuryThreadInfo','MercuryThreads','MercuryViewer','MessagingTag','Sound','UserActivity'],(function a(b,c,d,e,f,g){'use strict';var h=c('mercuryBlockedParticipantsRe').get(),i=c('MercuryThreads').get(),j=3,k=600000,l=new (c('Map'))(),m=0;function n(){return !c('UserActivity').isOnTab()&&!c('UserActivity').hasBeenInactive()}function o(){l=new (c('Map'))()}function p(r){if(c('ChatOptions').getSetting('sound')&&!n())c('Sound').play([c('ChatConfig').get('sound.notif_ogg_url'),c('ChatConfig').get('sound.notif_mp3_url')],r,false);}var q=Object.assign({init:function r(){c('Event').listen(window,'focus',function(){o();clearInterval(m)});c('Event').listen(window,'blur',function(){m=setInterval(o,k)})},messageReceived:function r(s){if(s.author&&c('MercuryViewer').isViewer(s.author)||!s.is_unread||s.folder!=c('MessagingTag').INBOX&&s.folder!=c('MessagingTag').ARCHIVED)return;var t=s.thread_id,u=c('ChatActivity').isActive();if(u){var v=false;q.inform('before-alert',{threadID:t,cancelAlert:function w(){v=true}})}i.getThreadMeta(t,function(w){var x=c('MercuryThreadInfo').isMuted(w),y=c('MercuryIDs').getUserIDFromParticipantID(c('MercuryViewer').getID());if(x)if(!c('MercuryThreadInfo').areMentionsMuted(w)){if(!s.profile_ranges||!s.profile_ranges.some||!s.profile_ranges.some(function(ba){return ba.id===y}))return;}else return;if(h.isPresentInGroupThread(w))return;var z=s.timestamp;if(u){!v&&p(z)}else{c('ChatTitleBarBlinker').blink(t,z);var aa=l.get(t)||0;if(aa<j){l.set(t,aa+1);p(z)}}c('ChatTitleBarBlinker').blinkingElsewhere()})}},c('ArbiterMixin'));f.exports=q}),null);
__d('ChatAppActions',['ChatDispatcher','ChatAppActionTypes'],(function a(b,c,d,e,f,g){'use strict';var h={tti:function i(){c('ChatDispatcher').dispatch({type:c('ChatAppActionTypes').TTI})},hide:function i(){c('ChatDispatcher').dispatch({type:c('ChatAppActionTypes').HIDE})},unhide:function i(){c('ChatDispatcher').dispatch({type:c('ChatAppActionTypes').UNHIDE})},setInitialDisplayDone:function i(){c('ChatDispatcher').dispatch({type:c('ChatAppActionTypes').INITIAL_DISPLAY_DONE})},load:function i(){c('ChatDispatcher').dispatch({type:c('ChatAppActionTypes').LOAD})}};f.exports=h}),null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],(function a(b,c,d,e,f,g){var h=function i(j,k){this._userID=j;this._logger=c('JSLogger').create('blackbird');this._getState=function(){if(c('ChatVisibility').isOnline())return c('PresencePrivacy').allows(this._userID)?i.NORMAL:i.BLOCKED;return i.OFFLINE};this._togglePrivacy=function(){var m=this._getState();switch(this._getState()){case i.OFFLINE:if(c('ChatVisibility').isOnline()){this._logger.error('tabs_already_online');break}this._logger.log('tabs_go_online',{tab_id:this._userID});c('ChatVisibility').goOnline(function(){if(!c('PresencePrivacy').allows(this._userID)){if(this._getState()!==i.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy()}}.bind(this));break;case i.BLOCKED:c('PresencePrivacy').allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case i.NORMAL:c('PresencePrivacy').disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};var l=function(){k&&k(this._getState())}.bind(this);l();this._subscribeToken=c('PresencePrivacy').subscribe('privacy-changed',l)};h.OFFLINE='offline';h.BLOCKED='blocked';h.NORMAL='normal';Object.assign(h.prototype,{togglePrivacy:function i(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy()},destroy:function i(){this._subscribeToken&&c('PresencePrivacy').unsubscribe(this._subscribeToken)}});f.exports=h}),null);
__d('MontageDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(){h.apply(this,arguments)}f.exports=new j({strict:false})}),null);
__d('MontageActions',['MontageDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({REQUEST_UPDATE:null,HAS_UPDATED:null}),i={Types:h,requestUpdate:function j(k){c('MontageDispatcher').dispatch({type:h.REQUEST_UPDATE,threadFBID:k})},hasUpdated:function j(k){c('MontageDispatcher').dispatch({type:h.HAS_UPDATED,threadFBID:k})}};f.exports=i}),null);
__d('MercuryCanonicalGroupThreadManager',['Bootloader','KeyedCallbackManager','MercuryIDs','MercuryPayloadSource','MercuryServerPayloadPreprocessor','MercurySingletonProvider','MercuryThreads','MercuryServerDispatcher','SubscriptionsHandler'],(function a(b,c,d,e,f,g){'use strict';function h(j){this.$MercuryCanonicalGroupThreadManager1=j;this.$MercuryCanonicalGroupThreadManager2=new (c('KeyedCallbackManager'))();this.$MercuryCanonicalGroupThreadManager3=c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager6=c('MercuryThreads').getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager4={};this.$MercuryCanonicalGroupThreadManager8();this.$MercuryCanonicalGroupThreadManager9();this.$MercuryCanonicalGroupThreadManager7={}}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.getCanonicalGroupThreadIDForParticipants=function(j,k){j=this.$MercuryCanonicalGroupThreadManager10(j);var l=this.$MercuryCanonicalGroupThreadManager11(j),m=this.$MercuryCanonicalGroupThreadManager2.executeOrEnqueue(l,k);this.$MercuryCanonicalGroupThreadManager12(j);return m};h.prototype.unsubscribe=function(j){if(j)this.$MercuryCanonicalGroupThreadManager2.unsubscribe(j);};h.prototype.$MercuryCanonicalGroupThreadManager11=function(j){return j.sort().join(',')};h.prototype.$MercuryCanonicalGroupThreadManager13=function(j,k){var l=c('MercuryIDs').getThreadIDFromThreadFBID(k);this.$MercuryCanonicalGroupThreadManager2.setResource(j,l);this.$MercuryCanonicalGroupThreadManager4[l]=j};h.prototype.$MercuryCanonicalGroupThreadManager12=function(j){var k=this.$MercuryCanonicalGroupThreadManager11(j),l={canonical_group_key:k,participants:j};c('MercuryServerDispatcher').trySend('/ajax/mercury/search_canonical_groups.php',l,null,this.$MercuryCanonicalGroupThreadManager1)};h.prototype.$MercuryCanonicalGroupThreadManager8=function(){c('MercuryServerDispatcher').registerEndpoints({'/ajax/mercury/search_canonical_groups.php':{request_user_id:this.$MercuryCanonicalGroupThreadManager1,mode:c('MercuryServerDispatcher').IMMEDIATE,handler:function(j){this.handleUpdate(j)}.bind(this)}})};h.prototype.$MercuryCanonicalGroupThreadManager10=function(j){if(j.indexOf(this.$MercuryCanonicalGroupThreadManager1)===-1)j.push(this.$MercuryCanonicalGroupThreadManager1);return j};h.prototype.handleUpdate=function(j){if(j.mercury_payload)this.$MercuryCanonicalGroupThreadManager3.handleUpdate(j.mercury_payload);var k=j.canonical_group;if(k)for(var l in k)this.$MercuryCanonicalGroupThreadManager13(l,k[l]);};h.prototype.getNow=function(j){var k=this.$MercuryCanonicalGroupThreadManager11(this.$MercuryCanonicalGroupThreadManager10(j));return this.$MercuryCanonicalGroupThreadManager2.getResource(k)};h.prototype.$MercuryCanonicalGroupThreadManager9=function(){c('Bootloader').loadModules(["MercuryThreadInformer"],function(j){var k=j.getForFBID(this.$MercuryCanonicalGroupThreadManager1),l=new (c('SubscriptionsHandler'))();l.addSubscriptions(k.subscribe('threads-deleted',function(m,n){for(var o in n)if(this.$MercuryCanonicalGroupThreadManager4[o]){this.$MercuryCanonicalGroupThreadManager2.setResource(this.$MercuryCanonicalGroupThreadManager4[o],undefined);delete this.$MercuryCanonicalGroupThreadManager4[o]}}.bind(this)));this.$MercuryCanonicalGroupThreadManager5=l}.bind(this),'MercuryCanonicalGroupThreadManager')};var i=new (c('MercurySingletonProvider'))(h);f.exports=h}),null);
__d('FantaGetMessageActions',['FantaDispatcher','MercuryCanonicalGroupThreadManager','MercuryIDs','MercuryTypeaheadConstants','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ADD_PARTICIPANTS:null,CLEAR_PARTICIPANTS:null,CLEAR_PREVIEW:null,FETCH_MORE_MESSAGES:null,ON_BOOTLOAD_TYPEAHEAD:null,ON_GET_THREAD_PREVIEW_RESPONSE:null,ON_GET_THREAD_RESPONSE:null,ON_MESSAGE_STORE_RESPONSE:null,ON_PAGE_NULL_RESPONSE:null,ON_PRIVACY_STATE_CHANGE:null,ON_SHOW_CONTEXT_BANNER_TIMER:null,REFRESH_THREAD:null,THREADS_UPDATED:null}),i={Types:h,addParticipants:function j(k,l){var m,n=l.length===1&&l[0].getInfo().render_type===c('MercuryTypeaheadConstants').THREAD_TYPE,o=void 0;if(n){var p=l[0].getInfo().mercury_thread;if(p)o=c('MercuryIDs').getThreadIDFromThreadFBID(p.thread_fbid);}else if(l.length===1){var q=l[0].info&&l[0].info.uid;if(q)o=c('MercuryIDs').getThreadIDFromUserID(q);}else if(l.length===0){c('FantaDispatcher').dispatch({type:h.CLEAR_PARTICIPANTS,tabID:k});return}else (function(){var r=c('MercuryCanonicalGroupThreadManager').get(),s=l.map(function(u){return u.info.uid});c('FantaDispatcher').dispatch({type:h.CLEAR_PREVIEW,tabID:k,tokens:l});var t=r.getCanonicalGroupThreadIDForParticipants(Array.from(s),function(u){r.unsubscribe(t);if(u)c('FantaDispatcher').dispatch({type:h.ADD_PARTICIPANTS,previewTabID:u,tabID:k,tokens:l});})})();if(o)c('FantaDispatcher').dispatch({type:h.ADD_PARTICIPANTS,previewTabID:o,tabID:k,tokens:l});},onBootloadTypeahead:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_BOOTLOAD_TYPEAHEAD,tabID:k,thread:l})},fetchMoreMessages:function j(k){c('FantaDispatcher').dispatch({type:h.FETCH_MORE_MESSAGES,threadID:k})},refreshThread:function j(k){c('FantaDispatcher').dispatch({type:h.REFRESH_THREAD,threadID:k})},onGetThreadResponse:function j(k){c('FantaDispatcher').dispatch({type:h.ON_GET_THREAD_RESPONSE,thread:k})},onGetThreadPreviewResponse:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_GET_THREAD_PREVIEW_RESPONSE,tabID:k,thread:l})},onShowContextBannerTimer:function j(k){c('FantaDispatcher').dispatch({type:h.ON_SHOW_CONTEXT_BANNER_TIMER,threadID:k})},onMessageStoreResponse:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_MESSAGE_STORE_RESPONSE,messages:k,tabID:l})},threadsUpdated:function j(k){c('FantaDispatcher').dispatch({type:h.THREADS_UPDATED,threads:k})},onPrivacyStateChange:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_PRIVACY_STATE_CHANGE,threadID:k,privacyState:l})},onPageNullResponse:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_PAGE_NULL_RESPONSE,threadID:k,nullStateCTA:l})}};f.exports=i}),null);
__d('FantaTabSheetActions',['FantaDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CLOSE_ADD_FRIENDS_SHEET:null,CLOSE_ADD_MORE_FRIENDS_SHEET:null,CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:null,CLOSE_EMPLOYEE_WORK_USER_SHEET:null,CLOSE_NAME_CONVERSATION_TAB_SHEET:null,CLOSE_PAGE_INDICATOR_SHEET:null,CLOSE_READ_ONLY_PERMANENT_SHEET:null,CLOSE_READ_ONLY_SHEET:null,CLOSE_USER_FOCUS_AND_BYPASS_SHEET:null,CLOSE_USER_TIMEZONE_SHEET:null,ON_BOOTLOAD_EVENT_REMINDER:null,ON_IS_PAGE_TAB:null,OPEN_ADD_MORE_FRIENDS_SHEET:null,OPEN_APPOINTMENT_SHEET:null,OPEN_BYPASS_FOCUS_SHEET:null,OPEN_EMPLOYEE_AWAY_SHEET:null,OPEN_EMPLOYEE_PERSONAL_USER_SHEET:null,OPEN_EMPLOYEE_WORK_USER_SHEET:null,OPEN_NAME_CONVERSATION_TAB_SHEET:null,OPEN_PAGE_INDICATOR_SHEET:null,OPEN_READ_ONLY_PERMANENT_SHEET:null,OPEN_READ_ONLY_SHEET:null,OPEN_USER_FOCUS_SHEET:null,OPEN_USER_TIMEZONE_SHEET:null}),i={Types:h,openUserFocusSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_USER_FOCUS_SHEET,tabID:k})},openBypassFocusSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_BYPASS_FOCUS_SHEET,tabID:k})},closeUserFocusAndBypassSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_USER_FOCUS_AND_BYPASS_SHEET,tabID:k})},openUserTimezoneSheet:function j(k,l){c('FantaDispatcher').dispatch({type:h.OPEN_USER_TIMEZONE_SHEET,tabID:k,timezoneInfo:l})},closeUserTimezoneSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_USER_TIMEZONE_SHEET,tabID:k})},openAddMoreFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_ADD_MORE_FRIENDS_SHEET,tabID:k})},closeAddMoreFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_ADD_MORE_FRIENDS_SHEET,tabID:k})},closeAddFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_ADD_FRIENDS_SHEET,tabID:k})},openNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_NAME_CONVERSATION_TAB_SHEET,tabID:k})},closeNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_NAME_CONVERSATION_TAB_SHEET,tabID:k})},openReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_SHEET,tabID:k})},closeReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_SHEET,tabID:k})},openReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_PERMANENT_SHEET,tabID:k})},closeReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_PERMANENT_SHEET,tabID:k})},openEmployeeAwaySheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_AWAY_SHEET,tabID:k})},openEmployeePersonalUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_PERSONAL_USER_SHEET,tabID:k})},closeEmployeePersonalUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET,tabID:k})},openEmployeeWorkUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_WORK_USER_SHEET,tabID:k})},closeEmployeeWorkUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_EMPLOYEE_WORK_USER_SHEET,tabID:k})},openPageIndicatorSheet:function j(k,l){c('FantaDispatcher').dispatch({type:h.OPEN_PAGE_INDICATOR_SHEET,description:l,tabID:k})},closePageIndicatorSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_PAGE_INDICATOR_SHEET,tabID:k})},onIsPageTab:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_IS_PAGE_TAB,pageIndicator:l,tabID:k})},onBootloadEventReminder:function j(k){c('FantaDispatcher').dispatch({type:h.ON_BOOTLOAD_EVENT_REMINDER,tabID:k})},openAppointmentBannerSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_APPOINTMENT_SHEET,tabID:k})}};f.exports=i}),null);
__d('MercurySheetPolicy',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h={ChatThreadIsMutedTabSheet:{isPermanent:false,isSheetWithInput:false},ChatUserFocusSheet:{isPermanent:true,isSheetWithInput:true},ChatUserFocusBypassSheet:{isPermanent:true,isSheetWithInput:true},ChatUserTimezoneSheet:{isPermanent:true,isSheetWithInput:true},ChatUserBlockedTabSheet:{isPermanent:true,isSheetWithInput:false},ChatUploadWarningTabSheet:{isPermanent:false,isSheetWithInput:false},ChatThreadIsMessageBlockedSheet:{isPermanent:true,isSheetWithInput:false},ChatReadOnlyTabSheet:{isPermanent:false,isSheetWithInput:false},ChatReadOnlyPermanentTabSheet:{isPermanent:true,isSheetWithInput:false},ChatOfflineTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNoRecipientsTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNewMessagesTabSheet:{isPermanent:true,isSheetWithInput:true},ChatNameConversationTabSheet:{isPermanent:true,isSheetWithInput:true},ChatEmployeeAwaySheet:{isPermanent:true,isSheetWithInput:false},ChatUserIsPersonalUserSheet:{isPermanent:true,isSheetWithInput:false},ChatUserIsWorkUserSheet:{isPermanent:true,isSheetWithInput:true},ChatEventReminderTabSheet:{isPermanent:true,isSheetWithInput:false},ChatAppointmentBanner:{isPermanent:true,isSheetWithInput:false},ChatMontageSheet:{isPermanent:false,isSheetWithInput:false},ChatJoinCallSheet:{isPermanent:true,isSheetWithInput:false},FantaAddFriendsSheet:{isPermanent:true,isSheetWithInput:true},FantaAddMoreFriendsSheet:{isPermanent:true,isSheetWithInput:true},ChatRoomAssociatedObjectSheet:{isPermanent:false,isSheetWithInput:false}},i={canReplaceOpenSheet:function j(k,l){var m=this.getType(l),n=this.isPermanent(l),o=this.isSheetWithInput(l),p=this.getType(k),q=this.isPermanent(k),r=this.isSheetWithInput(k);if(r)return !!(m!==p&&o);if(q&&!n)return false;if(p===this.sheets.ChatThreadIsMessageBlockedSheet)return false;return true},getType:function j(k){var l=k.getType||k.type&&k.type.getType||function(){return k},m=l.call(k);return m},isPermanent:function j(k){if(typeof k==='string'&&h[k])return h[k].isPermanent;var l=k.isPermanent||k.type&&k.type.isPermanent||function(){return false},m=l.call(k);return m},isSheetWithInput:function j(k){if(typeof k==='string'&&h[k])return h[k].isSheetWithInput;var l=k.isSheetWithInput||k.type&&k.type.isSheetWithInput||function(){return false},m=l.call(k);return m},sheets:c('keyMirror')(h)};f.exports=i}),null);
__d("TimeSpentRoomTypeEnum",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({GROUP:"GROUP",EVENT:"EVENT"})}),null);
__d('MessageThreadAssociatedObjectUtils',['TimeSpentRoomTypeEnum'],(function a(b,c,d,e,f,g){'use strict';var h={shouldRender:function i(j){return j&&j.room_type===c('TimeSpentRoomTypeEnum').GROUP&&!j.is_workplace_community},isLinkedToGroupChat:function i(j){return j&&j.room_type===c('TimeSpentRoomTypeEnum').GROUP&&!j.is_workplace_community}};f.exports=h}),null);
__d("MessengerApprovalModeTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPEN:0,APPROVALS:1})}),null);
__d("MessengerJoinableModeType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({PRIVATE:0,JOINABLE:1})}),null);
__d("MessengerParticipantAddModeTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADD:"ADD",INVITE:"INVITE",ADD_INVITE:"ADD_INVITE"})}),null);
__d('MessengerAdminGroupUtils',['fbt','MercuryConfig','MercuryIDs','MessageThreadAssociatedObjectUtils','MessengerApprovalModeTypes','MessengerJoinableModeType','MessengerParticipantAddModeTypes','WorkModeConfig','CurrentUser','QE2Logger'],(function a(b,c,d,e,f,g,h){'use strict';var i='messenger_use_new_group_participant_suggestion_ranking',j='show_nullstate_chat_tab_composer',k='show_nullstate_chat_tab_group_chat',l={isJoinableAndOpenThread:function m(n){return this.isJoinableThread(n)&&this.isApprovalOpenThread(n)},isJoinableAndApprovalRequiredThread:function m(n){return !!(this.isJoinableThread(n)&&n&&n.approval_mode===c('MessengerApprovalModeTypes').APPROVALS)},shouldAddToApprovalQueue:function m(n,o){return !!(this.isJoinableAndApprovalRequiredThread(n)&&n&&!l.isViewerAdmin(n.admin_ids,o))},isJoinableThread:function m(n){return !!(c('MercuryConfig').WWWJoinableMasterGK&&n&&n.is_thread_queue_enabled===true&&n.joinable_mode&&n.joinable_mode.mode===c('MessengerJoinableModeType').JOINABLE)},isGroupChat:function m(n){return !!(n&&c('MessageThreadAssociatedObjectUtils').isLinkedToGroupChat(n.associated_object))},shouldInvite:function m(n){return !!(c('MercuryConfig').WWWJoinableMasterGK&&n&&n.participant_add_mode===c('MessengerParticipantAddModeTypes').INVITE)},isApprovalOpenThread:function m(n){return !!(c('MercuryConfig').WWWJoinableMasterGK&&n&&n.approval_mode===c('MessengerApprovalModeTypes').OPEN)},isOwner:function m(n,o){return n&&this.isJoinableThread(o)},canSeeGroupOptions:function m(n,o,p){var q=c('WorkModeConfig').is_work_user;return !q&&this.isJoinableThread(o)},canSeeBotsInGroupTypeahead:function m(){var n=c('CurrentUser').isWorkUser();return n&&c('MercuryConfig').WorkShowBotsInGroupTypeaheadGK},canMakeOthersAdmins:function m(n,o,p){return this.isOwner(n,p)&&!o},canMakeSelfAdmin:function m(n,o){return this.isJoinableThread(o)&&o.admin_ids.length===0&&n},canRemoveAdmin:function m(n,o,p){return this.isOwner(n,p)&&o},canRemoveFromGroup:function m(n,o){return this.isOwner(n,o)||!this.isJoinableThread(o)},showJoinableLink:function m(n){var o=!!(n&&n.joinable_mode&&n.joinable_mode.link),p=l.isJoinableThread(n);return p&&o},showJoinableApprovalToggle:function m(n,o){if(n.associated_object&&!n.associated_object.approval_mode_toggleable)return false;var p=l.isViewerAdmin(n.admin_ids,o);return l.isOwner(p,n)},showApprovalQueue:function m(n,o){var p=l.isViewerAdmin(n.admin_ids,o),q=l.isOwner(p,n),r=0;if(n&&n.approval_queue_ids&&n.approval_queue_ids.length)r=n.approval_queue_ids.length;var s=l.isJoinableAndApprovalRequiredThread(n);return s&&q&&r>0},showParticipantsModal:function m(n,o,p){return this.isJoinableThread(p)&&!n&&!o},useNewGroupMemberSuggestionRanking:function m(){c('QE2Logger').logExposureForUser(i);return c('MercuryConfig').MessengerNewGroupParticipantSuggestionQE},showDefaultListForNewPersonAddChatTab:function m(){c('QE2Logger').logExposureForUser(k);return c('MercuryConfig').ChatGroupChat},showDefaultListForNewChatTab:function m(){c('QE2Logger').logExposureForUser(j);return c('MercuryConfig').ChatComposer},canUpdateThreadCustomization:function m(n,o){var p=l.isJoinableThread(n),q=l.isViewerAdmin(n.admin_ids,o);return n.is_subscribed&&(!p||q)},isViewerAdmin:function m(n,o){return this.isAdmin(n,c('MercuryIDs').getParticipantIDFromUserID(o))},isAdmin:function m(n,o){return n!==null&&n!==undefined&&n.indexOf(o)!==-1},getLeaveGroupBodyText:function m(n,o){return this.isOwner(n,o)?h._("Leaving this group will remove you as an owner and allow other members to manage the group. You will no longer be able to send or receive new messages."):h._("You will stop receiving messages from this conversation and people will see that you left.")},getLeaveGroupTitleText:function m(n,o){return this.isOwner(n,o)?h._("Leave this conversation?"):h._("Leave Conversation?")},getLeaveGroupButtonText:function m(n,o){return this.isOwner(n,o)?h._("Leave converstaion"):h._("Leave")},getMakeOwnerBodyText:function m(n,o){return n?h._("As a group owner, you will be able to manage group ownership and remove members from the conversation. Only owners will be able to add other owners."):h._("As a group owner, \"{owner's name}\" will be able to manage group ownership and remove members from the conversation. They will be able to remove ownership from other owners.",[h.param('owner\'s name',o)])},getMakeOwnerTitleText:function m(n){return n?h._("Become group owner?"):h._("Add group owner?")},getMakeOwnerButtonText:function m(n){return n?h._("Become owner"):h._("Make owner")},getRemoveOwnerBodyText:function m(n,o,p){var q=void 0;if(n&&o){q=h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group. Any other member will be able to own the group.")}else if(n&&!o){q=h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group.")}else q=h._("\"{owner's name}\" will no longer manage group ownership and remove members from the conversation. They will still be a participant in the group.",[h.param('owner\'s name',p)]);return q}};f.exports=l}),null);
__d("MessengerRoomPrivacyMode",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({WHITELISTED_MODE:0,PUBLIC_MODE:1})}),null);
__d('FantaComposeViewReducers',['Bootloader','FantaGetMessageActions','FantaTabSheetActions','MercuryDataSourceWrapper','MercurySheetPolicy','MercuryTypeaheadConstants','MessengerRoomPrivacyMode','MessengerAdminGroupUtils','ifRequired'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaGetMessageActions').Types,i=c('FantaTabSheetActions').Types;function j(r,s){switch(s.type){case h.ON_GET_THREAD_RESPONSE:case h.ON_GET_THREAD_PREVIEW_RESPONSE:var t=s.thread,u=s.tabID||t.thread_id;r=k(r,t,u);}return r}function k(r,s,t){if(s.participants.length===0){r=m(r,t,s);r=p(r,t,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet)}return r}function l(r,s){switch(s.type){case h.ON_BOOTLOAD_TYPEAHEAD:var t=s.thread,u=t.thread_id;r=m(r,u,t);}return r}function m(r,s,t){if(r.mercury.tabContents.get(s).typeahead)return r;c('ifRequired')('ChatTabTypeaheadRenderer',function(u){c('ifRequired')('ContextualTypeaheadView',function(v){c('ifRequired')('MercuryTypeahead',function(w){if(!r.mercury.tabContents.get(s))return;var x=!!(t&&t.participants&&t.participants.length===0),y=!!(t&&t.associated_object&&t.associated_object.privacy_mode===c('MessengerRoomPrivacyMode').WHITELISTED_MODE),z=x?c('MercuryDataSourceWrapper').chat_typeahead_source:y?c('MercuryDataSourceWrapper').chat_add_people_froup_source:c('MercuryDataSourceWrapper').chat_add_people_source;z.setShowThreads(x);if(x){z.setShowDefaultList(c('MessengerAdminGroupUtils').showDefaultListForNewChatTab())}else if(!y)z.setShowDefaultList(c('MessengerAdminGroupUtils').showDefaultListForNewPersonAddChatTab());if(y)z.setQueryData({thread_id:t.thread_fbid});var aa=new w(z,v);aa.setViewOption('renderer',u);aa.setExcludedParticipantsFromThreadMeta(t);r=r.mergeIn(['mercury','tabContents',s],{typeahead:aa})},function(){return o(s,t)})},function(){return o(s,t)})},function(){return o(s,t)});return r}function n(r,s){switch(s.type){case i.OPEN_ADD_MORE_FRIENDS_SHEET:var t=s.tabID,u=r.mercury.tabContents.get(t).thread;if(u){r=m(r,t,u);return p(r,s.tabID,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet)}}return r}function o(r,s){c('Bootloader').loadModules(["ChatTabTypeaheadRenderer","ContextualTypeaheadView","MercuryTypeahead"],function(t,u,v){c('FantaGetMessageActions').onBootloadTypeahead(r,s)},'FantaComposeViewReducers')}function p(r,s,t){var u=r.mercury.tabContents.get(s),v=r.tabGroup.tabs.get(s);if(!v||!u)return r;var w=u.openSheet;if(w&&!c('MercurySheetPolicy').canReplaceOpenSheet(w,t))return r;r=r.mergeIn(['mercury','tabContents',s],{openSheet:t});return r}function q(r,s){switch(s.type){case h.ADD_PARTICIPANTS:var t=s.tokens,u=s.tabID,v=t.length===1&&t[0].getInfo().render_type===c('MercuryTypeaheadConstants').THREAD_TYPE;if(!v)return p(r,u,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet);}return r}f.exports={addParticipants:q,onBootloadTypeahead:l,onGetThreadResponse:j,openAddMoreFriends:n}}),null);
__d('FantaMessageActions',['Bootloader','FantaDispatcher','MercuryConfig','ifRequired','keyMirror','emptyFunction','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CANCEL_FILE_UPLOAD:null,COMPOSER_TEXT_UPDATE:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,PREPARE_FILES_FOR_SEND:null,RECEIVED_NEW_MESSAGE:null,REMOVE_SHARE_PREVIEW:null,SEND_GROUP_MESSAGE:null,SEND_HOT_LIKE:null,SEND_MESSAGE:null,SEND_PHOTO:null,SEND_STICKER:null,UPDATE_GROUP_NAME:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null});function i(){var l=document.createElement('form');l.action=c('MercuryConfig').upload_url;l.method='post';return l}function j(l,m){var n=document.createElement('input');n.type='file';n.name='attachment[]';n.multiple=true;if(m)n.onchange=m;l.appendChild(n);return n}var k={Types:h,prepareFilesForSend:function l(m,n){this.dispatchOrBootloadUploader(function(){c('FantaDispatcher').dispatch({type:h.PREPARE_FILES_FOR_SEND,tabID:m,files:n})})},openUploadFilePicker:function l(m){var n=i(),o=j(n,function(){k.prepareFilesForSend(m,this.files)});o.click()},uploadedFile:function l(m,n,o){this.dispatchOrBootloadUploader(function(){c('FantaDispatcher').dispatch({type:h.UPLOADED_FILE,tabID:m,uploadID:n,payload:o})})},uploadFileFailed:function l(m,n){this.dispatchOrBootloadUploader(function(){c('FantaDispatcher').dispatch({type:h.UPLOAD_FILE_FAILED,tabID:m,uploadID:n})})},cancelFileUpload:function l(m,n){this.dispatchOrBootloadUploader(function(){c('FantaDispatcher').dispatch({type:h.CANCEL_FILE_UPLOAD,tabID:m,uploadID:n})})},linkPreview:function l(m,n){this.dispatchOrBootloadSharePreview(function(){c('FantaDispatcher').dispatch({type:h.LINK_PREVIEW,tabID:m,uri:n})})},loadedShareData:function l(m,n){this.dispatchOrBootloadSharePreview(function(){c('FantaDispatcher').dispatch({type:h.LOADED_SHARE_DATA,tabID:m,attachmentData:n})})},loadingShareData:function l(m){this.dispatchOrBootloadSharePreview(function(){c('FantaDispatcher').dispatch({type:h.LOADING_SHARE_DATA,tabID:m})})},removeSharePreview:function l(m){this.dispatchOrBootloadSharePreview(function(){c('FantaDispatcher').dispatch({type:h.REMOVE_SHARE_PREVIEW,tabID:m})})},receivedNewMessage:function l(m,n){c('FantaDispatcher').dispatch({type:h.RECEIVED_NEW_MESSAGE,tabID:m,message:n})},updateGroupName:function l(m,n){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.UPDATE_GROUP_NAME,threadID:m,newName:n})})},sendGroupMessage:function l(m,n){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.SEND_GROUP_MESSAGE,threadID:m,onSendSuccess:n})})},sendMessage:function l(m,n,o){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.SEND_MESSAGE,threadID:m,message:n,onSendSuccess:o})})},sendPhoto:function l(m,n,o){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.SEND_PHOTO,onSendSuccess:o,photoData:n,threadID:m})})},sendHotLike:function l(m,n,o,p,q){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.SEND_HOT_LIKE,emoji:n,onSendSuccess:q,size:o,source:p,threadID:m})})},sendSticker:function l(m,n,o){this.dispatchOrBootloadSendMessages(function(){c('FantaDispatcher').dispatch({type:h.SEND_STICKER,threadID:m,stickerID:n,onSendSuccess:o})})},composerTextUpdate:function l(m,n){if(n.length>0)c('ifRequired')('FantaReducersSendMessages',c('emptyFunction'),function(){return this.dispatchOrBootloadSendMessages(c('emptyFunction'))}.bind(this));this.dispatchOrBootloadSharePreview(function(){c('FantaDispatcher').dispatch({type:h.COMPOSER_TEXT_UPDATE,threadID:m,message:n})})},dispatchOrBootloadSendMessages:function l(m){c('ifRequired')('FantaReducersSendMessages',function(){c('setImmediate')(m)},function(){c('Bootloader').loadModules(["FantaAppStore","FantaReducersSendMessages"],function(n,o){n.addReducers(o);c('setImmediate')(m)},'FantaMessageActions')})},dispatchOrBootloadUploader:function l(m){c('ifRequired')('FantaReducersFileUploader',function(){m()},function(){c('Bootloader').loadModules(["FantaAppStore","FantaReducersFileUploader"],function(n,o){n.addReducers(o);m()},'FantaMessageActions')})},dispatchOrBootloadSharePreview:function l(m){c('ifRequired')('FantaReducersSharePreview',function(){m()},function(){c('Bootloader').loadModules(["FantaAppStore","FantaReducersSharePreview"],function(n,o){n.addReducers(o);m()},'FantaMessageActions')})}};f.exports=k}),null);
__d('FantaReducersCookie',['FantaMessageActions','FantaTabActions','MercuryConfig','PresenceState','debounce','emptyFunction'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types,j=c('MercuryConfig').FRC?c('debounce')(c('PresenceState').doSync,300):c('emptyFunction');function k(n,o){switch(o.type){case h.RECEIVED_NEW_MESSAGE:case i.CLOSE_ALL_TABS:case i.CLOSE_AND_TAB_NEXT:case i.CLOSE_TAB:case i.DELETE_TAB:case i.MINIMIZE_ALL_TABS:case i.MINIMIZE_TAB:case i.OPEN_TAB:case i.OPEN_TAB_WITH_INTERSTITIAL_DATA:case i.REPLACE_TAB:case i.UNMINIMIZE_TAB:j();return m(n);}return n}function l(n,o){switch(o.type){case i.LOAD_FROM_DATA:return n.mergeIn(['tabGroup'],{updatedTime:o.tabData.updatedTime});}return n}function m(n){return n.mergeIn(['tabGroup'],{updatedTime:Date.now()})}f.exports={updateCookie:k,loadFromData:l}}),null);
__d('FantaReducersDockCalculator',['Arbiter','FantaTabActions','FantaMessageActions','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaTabActions').Types,i=c('FantaMessageActions').Types,j=null;function k(n){j=n;c('setImmediate')(function(){c('Arbiter').inform('FantaReducersDockCalculator/shouldRecalculate')})}function l(n){if(!j||n.size!==j.size){k(n)}else{var o=false;n.forEach(function(p){var q=j&&j.get(p.id);if(!q||p.isMinimized!==q.isMinimized)o=true;});if(o)k(n);}}function m(n,o){var p=n.tabGroup.tabs;switch(o.type){case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.DELETE_TAB:case h.MINIMIZE_ALL_TABS:case h.MINIMIZE_TAB:case h.OPEN_TAB:case h.OPEN_TAB_WITH_INTERSTITIAL_DATA:case h.UNMINIMIZE_TAB:k(p);break;case h.LOAD_FROM_DATA:case i.RECEIVED_NEW_MESSAGE:l(p);break;}return n}f.exports={recalculateDock:m}}),null);
__d('FantaTypeJoinableThread',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={admins:[],approvalMode:0,associatedObject:null,description:null,friendsInParticipants:[],imageURL:null,isViewerSubscribed:false,isWorkpaceChat:false,joinableMode:{mode:0,link:''},linkHash:'',participants:[],threadID:null,threadFBID:null,threadName:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d('FantaTypeFileUploader',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={ANIMATED_IMAGE:'animated_image',AUDIO:'audio',FILE:'file',GENERIC_ATTACHMENT:'generic_attachment',IMAGE:'image',VIDEO:'video'},k={uploadedFiles:c('immutable').Map(),uploadingFiles:c('immutable').Map()};h=babelHelpers.inherits(l,c('immutable').Record(k));i=h&&h.prototype;l.prototype.getTypeIDs=function(m){return this.uploadedFiles.reduce(function(n,o){if(o.type===m&&o.uploadedID)n=n.concat(o.uploadedID);return n},[])};function l(){h.apply(this,arguments)}l.fileTypes=j;f.exports=l}),null);
__d('FantaTypeSharePreview',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={isLoading:false,params:null,type:null,uri:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d('FantaTypeTabContents',['ChatPrivacyActionController','FantaGetMessageActions','FantaTypeFileUploader','FantaTypeSharePreview','immutable','MercuryIDs','emptyFunction','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={composerText:'',fileUploader:new (c('FantaTypeFileUploader'))(),hasFetchedAll:false,id:'',isScrolledToBottom:true,messages:c('immutable').List(),messageStore:null,nullStateCTA:null,openSheet:null,pageIndicator:null,pageIndicatorDescription:null,privacyController:null,sharePreview:new (c('FantaTypeSharePreview'))(),showContextBanner:false,showUnseenMessages:c('emptyFunction'),signatureID:null,joinableInterstitialData:null,thread:null,threadPreviewID:null,threadPreviewRecipients:null,timezoneInfo:null,typeahead:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(l){var m=void 0,n=c('MercuryIDs').getUserIDFromThreadID(l.id);if(n)m=new (c('ChatPrivacyActionController'))(n,function(o){c('setImmediate')(function(){c('FantaGetMessageActions').onPrivacyStateChange(l.id,o)})});i.constructor.call(this,babelHelpers['extends']({privacyController:m},l))}f.exports=k}),null);
__d('FantaReducersMercury',['Arbiter','AsyncSignal','AvailableList','AvailableListConstants','Bootloader','FantaAvailableStatus','FantaGetMessageActions','FantaMessageActions','FantaTabActions','FantaTabSheetActions','FantaTypeJoinableThread','FantaTypeTabContents','JSLogger','MercuryIDs','MercuryThreadIDMap','MessagingTagConstants','WorkFocusMode','getPageIDFromThreadID','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadIDMap').get(),i=c('JSLogger').create('FantaReducersMercury'),j=c('FantaMessageActions').Types,k=c('FantaTabActions').Types,l=c('FantaGetMessageActions').Types;function m(){return Math.floor(Math.random()*2147483648).toString(16)}function n(ha,ia){switch(ia.type){case k.OPEN_TAB:case k.OPEN_TAB_WITH_INTERSTITIAL_DATA:var ja=ia.tabID;c('ifRequired')('FantaTabsReactApp',function(ma){if(!c('MercuryIDs').isValidThreadID(ja)){ha=ha.deleteIn(['tabGroup','tabs',ja]);v(ja)}else{da(ha,ja);ea(ja)}},function(){return ha=o(ha,ia.tabID)});ha=q(ha,ja);var ka=m();ha=ha.mergeIn(['mercury','tabContents',ja],{signatureID:ka});new (c('AsyncSignal'))('/ajax/chat/opentab_tracking.php',{threadID:ja,userID:c('MercuryIDs').getUserIDFromThreadID(ja),signatureID:ka}).send();if(ia.interstitialData){var la=new (c('FantaTypeJoinableThread'))(ia.interstitialData);ha=ha.mergeIn(['mercury','tabContents',ja],{joinableInterstitialData:la})}c('Arbiter').inform('jewel/hide');return ha;}return ha}function o(ha,ia){c('ifRequired')('FantaTabsSlimApp',function(ja){if(!c('MercuryIDs').isValidThreadID(ia)){ha=ha.deleteIn(['tabGroup','tabs',ia]);v(ia)}else{da(ha,ia);ea(ia)}},function(){da(ha,ia);ea(ia)});return ha}function p(ha,ia){switch(ia.type){case j.RECEIVED_NEW_MESSAGE:ha=q(ha,ia.tabID);}return ha}function q(ha,ia){var ja,ka=ha.mercury.tabContents.get(ia);if(!ka){var ja=function(){var la=c('getPageIDFromThreadID')(ia);if(la)c('Bootloader').loadModules(["PagesMercuryChatTabIndicatorHandler"],function(ma){var na=c('AvailableListConstants').OFFLINE,oa=new ma(la,na,function(pa){c('setImmediate')(function(){c('FantaTabSheetActions').openPageIndicatorSheet(ia,pa)})},function(){c('setImmediate')(function(){return c('FantaTabSheetActions').closePageIndicatorSheet(ia)})});c('setImmediate')(function(){c('FantaTabSheetActions').onIsPageTab(ia,oa)});oa.checkResponsiveness()},'FantaReducersMercury');return {v:ha.setIn(['mercury','tabContents',ia],new (c('FantaTypeTabContents'))({id:ia}))}}();if(typeof ja==="object")return ja.v;}return ha}function r(ha,ia){switch(ia.type){case k.REPLACE_TAB:ha=u(ha,ia.newTabID);ha=q(ha,ia.newTabID);return ha;}return ha}function s(ha,ia){switch(ia.type){case l.ADD_PARTICIPANTS:var ja=ia.tabID,ka=ia.previewTabID;if(!ha.mercury.tabContents.get(ja))return ha;ha=ha.mergeIn(['mercury','tabContents',ja],{threadPreviewID:ka});return ha;}return ha}function t(ha,ia){switch(ia.type){case l.CLEAR_PARTICIPANTS:var ja=ia.tabID;ha=ha.setIn(['mercury','tabContents',ja],new (c('FantaTypeTabContents'))({id:ja}));}return ha}function u(ha,ia){c('ifRequired')('FantaTabsReactApp',function(ja){if(!c('MercuryIDs').isValidThreadID(ia)){ha=ha.deleteIn(['tabGroup','tabs',ia]);v(ia)}},function(){c('ifRequired')('FantaTabsSlimApp',function(ja){if(!c('MercuryIDs').isValidThreadID(ia)){ha=ha.deleteIn(['tabGroup','tabs',ia]);v(ia)}})});return ha}function v(ha){h.getClientIDFromServerID(ha,function(ia){return c('setImmediate')(function(){if(c('MercuryIDs').isValidThreadID(ia)){c('FantaTabActions').openTab(ia)}else i.error('invalid id',ha);})})}function w(ha,ia){switch(ia.type){case k.FOCUS_TAB:da(ha,ia.tabID);}return ha}function x(ha,ia){switch(ia.type){case k.CLOSE_TAB:var ja=ia.tabID;ha=z(ha,ja);}return ha}function y(ha,ia){switch(ia.type){case k.DELETE_TAB:var ja=ia.tabID;ha=z(ha,ja);ha=ha.deleteIn(['mercury','tabContents',ja]);}return ha}function z(ha,ia){c('ifRequired')('MessengerVideoAutoplayActions',function(ja){ja.deleteThread(ia)});c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ia);return ha}function aa(ha,ia){switch(ia.type){case k.CLOSE_ALL_TABS:c('ifRequired')('MessengerVideoAutoplayActions',function(ja){ja.deleteAllThreads()});return ha;}return ha}function ba(ha,ia){switch(ia.type){case k.FOCUS_NEXT_TAB:case k.FOCUS_PREVIOUS_TAB:case k.CLOSE_AND_TAB_NEXT:var ja=ha.tabGroup.focusedTabID;if(ja)da(ha,ja);}return ha}function ca(ha,ia){switch(ia.type){case k.CLOSE_AND_TAB_NEXT:var ja=ia.tabID;c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ja);}return ha}function da(ha,ia){var ja=c('MercuryIDs').getUserIDFromThreadID(ia);if(ja)c('AvailableList').updateForID(ja);var ka=ha.mercury.tabContents.get(ia);if(ka){var la=ka.thread,ma=ka.pageIndicator;if(ma)ma.notifyPageOnlineStatusChanged(c('FantaAvailableStatus').getStatus(la,ia));}}function ea(ha){if(!c('MercuryIDs').isValidThreadID(ha))return;c('Bootloader').loadModules(["GroupChatMessageBlockAlert","GroupChatMessageIgnoreAlert","mercuryBlockedParticipantsRe","mercuryIgnoredParticipantsRe","MercuryThreadActions","MercuryThreads"],function(ia,ja,ka,la,ma,na){var oa=ma.get(),pa=na.get(),qa=ka.get(),ra=la.get();pa.getThreadMeta(ha,function(sa){if(qa.isPresentInGroupThread(sa)){ia.show(qa.blockedParticipantsInGroupThread(sa),function(){c('FantaTabActions').focusTab(ha)},function(){c('FantaTabActions').closeTab(ha);oa.leaveGroup(ha)})}else if(ra.isPresentInGroupThread(sa))ja.show(ra.ignoredParticipantsInGroupThread(sa),function(){c('FantaTabActions').focusTab(ha)},function(){c('FantaTabActions').closeTab(ha);c('Bootloader').loadModules(["IgnoreMessagesTypedLogger","IgnoreMessagesLoggingEvent","IgnoreMessagesPlatforms"],function(ta,ua,va){oa.changeFolder(ha,c('MessagingTagConstants').other);new ta().setEvent(ua.IGNORE_CONFIRMED).setThreadID(c('MercuryIDs').getThreadFBIDFromThreadID(ha)).setPlatform(va.CHAT_TABS).log()},'FantaReducersMercury')});})},'FantaReducersMercury')}function fa(ha,ia){switch(ia.type){case k.UNMINIMIZE_TAB:da(ha,ia.tabID);}return ha}function ga(ha,ia){switch(ia.type){case k.LOAD_FROM_DATA:for(var ja=ha.tabGroup.tabs.keys(),ka=Array.isArray(ja),la=0,ja=ka?ja:ja[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ma;if(ka){if(la>=ja.length)break;ma=ja[la++]}else{la=ja.next();if(la.done)break;ma=la.value}var na=ma;ha=q(ha,na)}}return ha}f.exports={addParticipants:s,clearParticipants:t,closeAllTabs:aa,closeAndTabNext:ca,closeTab:x,deleteTab:y,focusTab:w,focusTabEvents:ba,loadFromData:ga,openTab:n,receivedNewMessage:p,replaceTab:r,unminimizeTab:fa}}),null);
__d('FantaReducersMessages',['FantaGetMessageActions','FantaMessageActions','FantaTabActions','MercuryBrowserAlerts'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types,j=c('FantaGetMessageActions').Types;function k(r,s){switch(s.type){case h.RECEIVED_NEW_MESSAGE:var t=s.message;c('MercuryBrowserAlerts').messageReceived(t);return r;}return r}function l(r,s){switch(s.type){case h.COMPOSER_TEXT_UPDATE:var t=s.message,u=s.threadID;if(!r.mercury.tabContents.get(u))return r;return r.mergeIn(['mercury','tabContents',u],{composerText:t});}return r}function m(r,s){switch(s.type){case i.CLOSE_TAB:if(!r.mercury.tabContents.get(s.tabID))return r;return r.mergeIn(['mercury','tabContents',s.tabID],{composerText:''});}return r}function n(r,s){switch(s.type){case i.CLOSE_ALL_TABS:var t=r.mercury.tabContents;t.forEach(function(u){var v=u.id;r=r.setIn(['mercury','tabContents',v],u.set('composerText',''))});return r;}return r}function o(r,s){switch(s.type){case i.SCROLL_BOTTOM_CHANGED:var t=s.tabID,u=s.isScrolledToBottom,v=s.showUnseenMessages;if(!r.mercury.tabContents.get(t))return r;r=r.mergeIn(['mercury','tabContents',t],{isScrolledToBottom:u,showUnseenMessages:v});}return r}function p(r,s){switch(s.type){case i.SHOW_UNSEEN_MESSAGES:var t=s.tabID,u=r.mercury.tabContents.get(t);if(u)u.showUnseenMessages();}return r}function q(r,s){switch(s.type){case j.ON_GET_THREAD_RESPONSE:var t=s.thread,u=t.thread_id,v=r.mercury.tabContents.get(u);if(!v)return r;r=r.mergeIn(['mercury','tabContents',u],{thread:t});break;}return r}f.exports={closeAllTabs:n,closeTab:m,composerTextUpdate:l,onGetThreadResponse:q,receivedNewMessage:k,scrollBottomChanged:o,showUnseenMessages:p}}),null);
__d('FantaTypeTab',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={focusCounter:0,id:'',isHovered:false,isMinimized:false,openCounter:0,entryPoint:'unknown'};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d('FantaTypeTabGroup',['FantaConst','immutable','MercuryConfig'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={allowedRaisedTabs:c('FantaConst').DEFAULT_ALLOWED_RAISED_TABS,focusedTabID:null,tabs:c('immutable').Map({}),updatedTime:0};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;k.prototype.getRaisedandUnraisedTabs=function(){var l=void 0,m=void 0;if(c('MercuryConfig').FantaTabOrdering){m=function q(r){return r.openCounter*-1};l=function q(r){return r.focusCounter*-1}}else{m=function q(r){return r.openCounter};l=function q(r){return r.focusCounter*-1}}var n=this.tabs.sortBy(l),o=n.slice(this.allowedRaisedTabs),p=n.take(this.allowedRaisedTabs).sortBy(m);return {raisedTabs:p,unraisedTabs:o}};function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("isWebMessengerURI",[],(function a(b,c,d,e,f,g){function h(i){return /^(\/messages)/.test(i.getPath())}f.exports=h}),null);
__d('FantaReducersTabs',['EventProfiler','FantaConst','FantaMessageActions','FantaTabActions','FantaTypeTab','FantaTypeTabGroup','LogHistory','PinnedConversationNubsConfig','URI','isWebMessengerURI'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types,j='tab_',k=c('LogHistory').getInstance('fanta_tabs'),l=1,m=1,n=1;function o(na,oa){switch(oa.type){case i.OPEN_TAB:case i.OPEN_TAB_WITH_INTERSTITIAL_DATA:k.debug(oa.type,JSON.stringify({id:oa.tabID}));if(m===1)c('EventProfiler').tagCurrentActiveInteractionsAs('FirstChatTabOpen');return v(na,oa.tabID||j+n++,true,oa.entryPoint);}return na}function p(na,oa){switch(oa.type){case i.REPLACE_TAB:var pa=oa.tabID,qa=oa.newTabID,ra=na.tabGroup,sa=ra.tabs,ta=sa.get(pa);k.debug(oa.type,JSON.stringify({id:pa,isExisting:!!ta,newID:qa}));if(ta){var ua=ta.id===na.tabGroup.focusedTabID;na=na.setIn(['tabGroup','tabs',qa],ta.merge({id:qa})).deleteIn(['tabGroup','tabs',pa]);return v(na,qa,ua,'replace_tab')}return v(na,qa,false,'replace_tab');}return na}function q(na,oa){switch(oa.type){case i.MINIMIZE_TAB:return w(na,oa.tabID,true);}return na}function r(na,oa){switch(oa.type){case i.UNMINIMIZE_TAB:return w(na,oa.tabID,false);}return na}function s(na,oa){switch(oa.type){case i.FOCUS_TAB:var pa=oa.tabID;return ca(na,pa);}return na}function t(na,oa){switch(oa.type){case i.BLUR_TAB:return da(na,oa.tabID);}return na}function u(na,oa){switch(oa.type){case h.RECEIVED_NEW_MESSAGE:var pa=oa.tabID,qa=na.tabGroup.tabs.get(pa);k.debug(oa.type,JSON.stringify({id:pa,isOpen:!!qa}));if(!qa){var ra=na.tabGroup.focusedTabID;na=v(na,pa,false,'message_received');var sa=c('URI').getNextURI();if(c('isWebMessengerURI')(sa)){return na=w(na,pa,true)}else if(ra)return ca(na,ra);}}return na}function v(na,oa,pa){var qa=arguments.length<=3||arguments[3]===undefined?'unknown':arguments[3],ra=na.tabGroup,sa=ra.tabs,ta=sa.get(oa);if(!ta){ta=new (c('FantaTypeTab'))({id:oa,focusCounter:l,openCounter:m++,entryPoint:qa});na=na.setIn(['tabGroup','tabs',oa],ta)}else if(ta.isMinimized&&pa)na=w(na,oa,false);if(pa)return ca(na,oa);return na}function w(na,oa,pa){var qa=na.tabGroup,ra=qa.tabs.get(oa);if(ra)na=na.mergeIn(['tabGroup','tabs',oa],{isMinimized:pa});return na}function x(na,oa){switch(oa.type){case i.MINIMIZE_ALL_TABS:for(var pa=na.tabGroup.tabs.keys(),qa=Array.isArray(pa),ra=0,pa=qa?pa:pa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var sa;if(qa){if(ra>=pa.length)break;sa=pa[ra++]}else{ra=pa.next();if(ra.done)break;sa=ra.value}var ta=sa;na=w(na,ta,true)}return na;}return na}function y(na,oa){switch(oa.type){case i.CLOSE_TAB:case i.DELETE_TAB:var pa=oa.tabID;k.debug(oa.type,JSON.stringify({id:pa}));return z(na,pa);}return na}function z(na,oa){na=da(na,oa);return na.deleteIn(['tabGroup','tabs',oa])}function aa(na,oa){switch(oa.type){case i.CLOSE_ALL_TABS:k.debug(oa.type);na=da(na,na.tabGroup.focusedTabID);return na.setIn(['tabGroup','tabs'],na.tabGroup.tabs.clear());}return na}function ba(na,oa){switch(oa.type){case i.CLOSE_AND_TAB_NEXT:k.debug(oa.type,JSON.stringify({id:oa.tabID}));na=z(na,oa.tabID);return la(na);}return na}function ca(na,oa){var pa=arguments.length<=2||arguments[2]===undefined?false:arguments[2],qa=na.tabGroup,ra=qa.tabs.get(oa);if(ra)na=na.mergeIn(['tabGroup','tabs',oa],{focusCounter:l++});var sa=pa?null:oa;na=na.mergeIn(['tabGroup'],{focusedTabID:sa});return na}function da(na,oa){if(na.tabGroup.focusedTabID===oa)return na.mergeIn(['tabGroup'],{focusedTabID:null});return na}function ea(na,oa){switch(oa.type){case i.HOVERED_TAB:var pa=oa.tabID;return ga(na,pa,true);}return na}function fa(na,oa){switch(oa.type){case i.UNHOVERED_TAB:var pa=oa.tabID;return ga(na,pa,false);}return na}function ga(na,oa,pa){var qa=na.tabGroup,ra=qa.tabs.get(oa);if(ra)na=na.mergeIn(['tabGroup','tabs',oa],{isHovered:pa});return na}function ha(na,oa){switch(oa.type){case i.SET_ALLOWED_RAISED_TABS:var pa=oa.allowedRaisedTabs;if(pa!==na.tabGroup.allowedRaisedTabs)k.debug(oa.type,JSON.stringify({count:pa}));return ia(na,pa);}return na}function ia(na){var oa=arguments.length<=1||arguments[1]===undefined?c('FantaConst').DEFAULT_ALLOWED_RAISED_TABS:arguments[1];if(oa===na.tabGroup.allowedRaisedTabs)return na;if(!c('PinnedConversationNubsConfig').chatTabTypingPriority)oa=Math.max(1,oa);return na.mergeIn(['tabGroup'],{allowedRaisedTabs:oa})}function ja(na,oa){switch(oa.type){case i.LOAD_FROM_DATA:var pa=na.tabGroup,qa=oa.tabData,ra=pa.updatedTime;if(ra>=qa.updatedTime||qa.updatedTime===undefined)return na;na=ia(na.set('tabGroup',new (c('FantaTypeTabGroup'))()),pa.allowedRaisedTabs);var sa=[];qa.tabs.sort(function(ta,ua){return ta.openCounter-ua.openCounter}).forEach(function(ta){sa.push(ta.id);na=v(na,ta.id,false,'loaded_from_data');if(ta.isMinimized)na=w(na,ta.id,ta.isMinimized);});qa.tabs.sort(function(ta,ua){return ta.focusCounter-ua.focusCounter}).forEach(function(ta){na=ca(na,ta.id,true)});k.debug(oa.type,JSON.stringify({updatedTime:ra,newerTime:qa.updatedTime,opened:sa}));na=qa.focusedTabID?ca(na,qa.focusedTabID,true):da(na);}return na}function ka(na,oa){switch(oa.type){case i.FOCUS_NEXT_TAB:return la(na);}return na}function la(na){var oa=na.tabGroup.focusedTabID,pa=na.tabGroup.getRaisedandUnraisedTabs(),qa=pa.raisedTabs,ra=qa.count();if(ra===0){return na}else if(qa.count()===1)return ca(na,qa.first().id);var sa=qa.skipUntil(function(ta){return ta.id===oa}).rest();if(sa.count()===0){return ca(na,qa.first().id)}else return ca(na,sa.first().id);}function ma(na,oa){switch(oa.type){case i.FOCUS_PREVIOUS_TAB:var pa=na.tabGroup.focusedTabID,qa=na.tabGroup.getRaisedandUnraisedTabs(),ra=qa.raisedTabs;if(ra.count()<2)return na;var sa=ra.reverse().skipUntil(function(ta){return ta.id===pa}).rest();if(sa.count()===0){return ca(na,ra.last().id)}else return ca(na,sa.first().id);}return na}f.exports={blurTab:t,closeAllTabs:aa,closeAndTabNext:ba,closeTab:y,focusNextTab:ka,focusPreviousTab:ma,focusTab:s,hoveredTab:ea,loadFromData:ja,minimizAllTabs:x,minimizeTab:q,openTab:o,receivedNewMessage:u,replaceTab:p,setAllowedRaisedTabs:ha,unhoveredTab:fa,unminimizeTab:r}}),null);
__d('FantaTypeMercuryState',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={tabContents:c('immutable').Map({})};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d('FantaTypeAppState',['FantaTypeMercuryState','FantaTypeTabGroup','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={tabGroup:new (c('FantaTypeTabGroup'))(),mercury:new (c('FantaTypeMercuryState'))()};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d('FantaAppStore',['FantaDispatcher','FantaReducersCookie','FantaReducersDockCalculator','FantaReducersMercury','FantaReducersMessages','FantaReducersTabs','FantaComposeViewReducers','FantaTypeAppState','FluxReduceStore','MercuryConfig','PresenceState'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[].concat(Object.values(c('FantaReducersTabs')),Object.values(c('FantaReducersMercury')),Object.values(c('FantaReducersMessages')),Object.values(c('FantaReducersDockCalculator')),Object.values(c('FantaReducersCookie')),Object.values(c('FantaComposeViewReducers')));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('FantaTypeAppState'))()};k.prototype.ignoreReducer=function(m){var n=Object.values(m);j=j.filter(function(o){return !n.find(function(p){return p===o})})};k.prototype.addReducers=function(m){this.ignoreReducer(m);j=j.concat(Object.values(m))};k.prototype.reduce=function(m,n){return j.reduce(function(o,p){return p(o,n)},m)};function k(){h.apply(this,arguments)}var l=new k(c('FantaDispatcher'));if(!c('MercuryConfig').FRC)l.addListener(function(){return c('PresenceState').doSync()});f.exports=l}),null);
__d('FantaCookieUtil',['FantaConst','Map','MercuryIDs','MercuryThreads','WorkModeConfig'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreads').get(),i={convertCookieData:function j(k,l,m){var n={tabs:[],focusedTabID:null,updatedTime:0,interstitialData:m},o=[],p=this._getCookieKeys();k=k||{};if(k[p.tabs])o=k[p.tabs];o.forEach(function(v){n.tabs.push({id:v.i,isMinimized:!v.r,openCounter:v.o,focusCounter:v.f})});if(l)for(var q=l.tabs.values(),r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t;if(h.isEmptyLocalThread(u.id))n.tabs.push({id:u.id,isMinimized:u.isMinimized,openCounter:u.openCounter,focusCounter:u.focusCounter});}n.focusedTabID=k[p.focusedTabID];n.updatedTime=k[p.updatedTime];return n},createCookieData:function j(k,l){var m=[],n=this._getCookieKeys();for(var o=k.tabs.values(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;if(!c('MercuryIDs').isLocalThread(s.id))m.push({i:s.id,r:s.isMinimized?undefined:1,o:s.openCounter,f:s.focusCounter});}l[n.tabs]=m;l[n.focusedTabID]=k.focusedTabID;l[n.updatedTime]=k.updatedTime;return l},_getCookieKeys:function j(){var k=c('WorkModeConfig').is_work_user;return {tabs:k?c('FantaConst').cookieIDs.WORK_COOKIE_ID:c('FantaConst').cookieIDs.PERSONAL_COOKIE_ID,focusedTabID:k?c('FantaConst').cookieIDs.WORK_FOCUS_COOKIE_ID:c('FantaConst').cookieIDs.PERSONAL_FOCUS_COOKIE_ID,updatedTime:k?c('FantaConst').cookieIDs.WORK_TIME_COOKIE_ID:c('FantaConst').cookieIDs.PERSONAL_TIME_COOKIE_ID}}};f.exports=i}),null);
__d('FantaMercuryThreadEventsBootloaded',['Bootloader','MercuryThreadInformer','MercuryThreads','MercuryViewer'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadInformer').get(),i=c('MercuryThreads').get(),j={onMessagesReceived:function k(l){h.subscribe('messages-received',function(m,n){var o,p=function r(s){var t,u=n[s],v=function x(y){var z=u[y];if(z.author!=c('MercuryViewer').getID()){if(!z.is_unread)return 'continue';i.getThreadMeta(s,function(aa){c('Bootloader').loadModules(["ChatTabPolicy"],function(ba){ba.messageIsAllowed(aa,z,function(){l(s,z)})},'FantaMercuryThreadEventsBootloaded')})}};for(var w=0;w<u.length;w++){var t=v(w);if(t==='continue')continue;}};for(var q in n)p(q);})}};f.exports=j}),null);
__d('FantaTabViewportManager',['Arbiter','DockTabsViewportCalculator','DockTabsViewportFantaTabUtils','FantaTabActions','immutable','ifRequired','isWebMessengerURI','setImmediate'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j=c('DockTabsViewportCalculator').getInstance(i);if(!j)return;j.registerFantaTabCallbacks({fantaTabModelStateGetter:function k(){var l=c('immutable').Map({});c('ifRequired')('FantaAppStore',function(m){l=m.getState().tabGroup.tabs});return l},onAvailableWidthChanged:function k(l){c('setImmediate')(function(){c('FantaTabActions').setAllowedRaisedTabs(c('DockTabsViewportFantaTabUtils').getTabCountToFitWidth(l))})}});c('Arbiter').subscribe('FantaReducersDockCalculator/shouldRecalculate',function(){j.forceRecalculateChatTabs()});j.forceRecalculateFBDockWidth();c('Arbiter').subscribe('page_transition',function(k,l){if(c('isWebMessengerURI')(l.uri))c('setImmediate')(function(){return c('FantaTabActions').minimizeAllTabs()});})}f.exports={init:h}}),null);
__d('HotLikeSound',['MercurySoundsConfig','SoundPlayer','StickerConstants'],(function a(b,c,d,e,f,g){'use strict';var h=[c('MercurySoundsConfig').hot_like_grow_mp3_url,c('MercurySoundsConfig').hot_like_grow_ogg_url],i=[c('MercurySoundsConfig').hot_like_pop_mp3_url,c('MercurySoundsConfig').hot_like_pop_ogg_url],j=[c('MercurySoundsConfig').hot_like_outgoing_small_mp3_url,c('MercurySoundsConfig').hot_like_outgoing_small_ogg_url],k=[c('MercurySoundsConfig').hot_like_outgoing_medium_mp3_url,c('MercurySoundsConfig').hot_like_outgoing_medium_ogg_url],l=[c('MercurySoundsConfig').hot_like_outgoing_large_mp3_url,c('MercurySoundsConfig').hot_like_outgoing_large_ogg_url],m=function o(){return false},n={setCheckSoundEnabledFunc:function o(p){m=p},start:function o(){this._play(h)},stop:function o(){c('SoundPlayer').stop(h)},pop:function o(){this.stop();this._play(i)},snap:function o(p){this.stop();if(p===c('StickerConstants').HOT_LIKE_SMALL_STICKER_ID)this._play(j);if(p===c('StickerConstants').HOT_LIKE_MEDIUM_STICKER_ID)this._play(k);if(p===c('StickerConstants').HOT_LIKE_LARGE_STICKER_ID)this._play(l);},_play:function o(p){if(m())c('SoundPlayer').play(p);}};f.exports=n}),null);
__d('MercuryDeliveryReceipts',['ArbiterMixin','Map','MercuryDispatcher','MercurySingletonProvider','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(l){'use strict';i.constructor.call(this);this.$MercuryDeliveryReceipts2=l;this.$MercuryDeliveryReceipts3=new (c('Map'))();this.$MercuryDeliveryReceipts1=c('MercuryDispatcher').getForFBID(this.$MercuryDeliveryReceipts2);this.$MercuryDeliveryReceipts1.subscribe('update-delivery',function(m,n){if(n.delivery_receipts)for(var o in n.delivery_receipts){var p=n.delivery_receipts[o],q=this.$MercuryDeliveryReceipts3.get(o)||0;if(p>q){this.$MercuryDeliveryReceipts3.set(o,p);this.informDeliveryStatusChanged(o)}}}.bind(this))}j.getForFBID=function(l){'use strict';return k.getForFBID(l)};j.get=function(){'use strict';return k.get()};j.prototype.informDeliveryStatusChanged=function(l){'use strict';var m=new (c('Map'))();m.set(l,true);this.inform('change',m)};j.prototype.getDeliveryTime=function(l){'use strict';return this.$MercuryDeliveryReceipts3.get(l)||0};var k=new (c('MercurySingletonProvider'))(j);f.exports=j}),null);
__d('MercuryDeliveryState',['MercuryConfig','MercuryIDs','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap','MercuryThreadInformer','PresencePrivacy','UserActivity','debounceAcrossTransitions'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryConfig').delivery_timeout||120000;i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercuryDeliveryState1=k;this.$MercuryDeliveryState2=c('MercuryServerRequests').getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState3=c('MercuryThreadInformer').getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState4=c('MercuryThreadIDMap').getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState5=[];this.$MercuryDeliveryState6={};this.$MercuryDeliveryState3.subscribe('messages-received',this.$MercuryDeliveryState7.bind(this));c('UserActivity').subscribe(c('debounceAcrossTransitions')(this.$MercuryDeliveryState8,300,this))}i.prototype.$MercuryDeliveryState7=function(k,l){for(var m in l){var n=l[m];n.forEach(function(o){if(this.$MercuryDeliveryState9(o)){this.$MercuryDeliveryState5.push(o);this.$MercuryDeliveryState4.getServerIDFromClientID(m,function(p){if(!this.$MercuryDeliveryState6[p])this.$MercuryDeliveryState6[p]=[];this.$MercuryDeliveryState6[p].push(o.message_id)}.bind(this))}}.bind(this))}if(c('UserActivity').isActive(h))this.$MercuryDeliveryState8();};i.prototype.$MercuryDeliveryState8=function(){if(this.$MercuryDeliveryState5.length===0&&Object.keys(this.$MercuryDeliveryState6).length===0)return;var k=this.$MercuryDeliveryState5.map(function(l){return l.message_id});if(k)this.$MercuryDeliveryState2.sendDeliveryReceipts(k,this.$MercuryDeliveryState6);this.$MercuryDeliveryState6={};this.$MercuryDeliveryState5=[]};i.prototype.$MercuryDeliveryState9=function(k){var l=k.author?c('MercuryIDs').getUserIDFromParticipantID(k.author):null;if(l===this.$MercuryDeliveryState1)return false;if(!k.is_unread)return false;if(!c('PresencePrivacy').allows(l))return false;return true};var j=new (c('MercurySingletonProvider'))(i);f.exports=i}),null);
__d('MercuryDelayedDispatcher',['MercuryDispatcher','MercuryServerPayloadPreprocessor','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap'],(function a(b,c,d,e,f,g){'use strict';function h(j){this.$MercuryDelayedDispatcher1=j;this.$MercuryDelayedDispatcher2=[];this.$MercuryDelayedDispatcher3=c('MercuryThreadIDMap').getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4=c('MercuryDispatcher').getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher5=c('MercuryServerRequests').getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher6=c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4.subscribe('model-update-completed',function(k,l){return this.$MercuryDelayedDispatcher7()}.bind(this))}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.handleUpdateWaitForThread=function(j,k){var l=this.$MercuryDelayedDispatcher3.getClientIDFromServerIDNow(k);if(l){this.$MercuryDelayedDispatcher8(j);return}this.$MercuryDelayedDispatcher3.getClientIDFromServerID(k,function(){return this.$MercuryDelayedDispatcher2.push({thread_fbid:k,payload:j})}.bind(this));this.$MercuryDelayedDispatcher5.ensureThreadIsFetched(k)};h.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher2&&this.$MercuryDelayedDispatcher2.length){var j=this.$MercuryDelayedDispatcher2.shift(),k=j.thread_fbid,l=j.payload;this.handleUpdateWaitForThread(l,k)}};h.prototype.$MercuryDelayedDispatcher8=function(j){if(j.from_client){this.$MercuryDelayedDispatcher4.handleUpdate(j)}else this.$MercuryDelayedDispatcher6.handleUpdate(j);};var i=new (c('MercurySingletonProvider'))(h);f.exports=h}),null);
__d('MercurySyncChannelMonitor',['Arbiter','ChannelConstants','CurrentUser','MercurySingletonProvider','MercurySyncFakeDFFSender'],(function a(b,c,d,e,f,g){'use strict';function h(j){this.handleAwfulChannelEvent=function(){if(!c('CurrentUser').isLoggedInNow()){this.killSubscriptions();return}c('MercurySyncFakeDFFSender').getForFBID(this.$MercurySyncChannelMonitor1).sendGlobalDFF()}.bind(this);this.$MercurySyncChannelMonitor1=j;this.$MercurySyncChannelMonitor2=false}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.setupSubscriptions=function(){if(!this.$MercurySyncChannelMonitor2){this.$MercurySyncChannelMonitor4=c('Arbiter').subscribe(c('ChannelConstants').JUMPSTART,this.handleAwfulChannelEvent);this.$MercurySyncChannelMonitor3=c('Arbiter').subscribe(c('ChannelConstants').THROTTLED,this.handleAwfulChannelEvent);this.$MercurySyncChannelMonitor2=true}};h.prototype.killSubscriptions=function(){if(this.$MercurySyncChannelMonitor2){c('Arbiter').unsubscribe(this.$MercurySyncChannelMonitor4);c('Arbiter').unsubscribe(this.$MercurySyncChannelMonitor3);this.$MercurySyncChannelMonitor2=false}};var i=new (c('MercurySingletonProvider'))(h);f.exports=h}),null);
__d('MercuryProfileRanges',['idx'],(function a(b,c,d,e,f,g){'use strict';function h(i){if(!i.id&&i.i)return {id:i.i,offset:i.o,length:i.l};return i}f.exports={extractFromDelta:function i(j){var k,l=(k=j)!=null?(k=k.data)!=null?k.prng:k:k;if(!l)return undefined;var m=[];try{m=JSON.parse(l);if(m.length>0)return m.map(h);}catch(n){}return m}}}),null);
__d("MNCommerceBubbleType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FB_RETAIL_RECEIPT:1,FB_RETAIL_CANCELLATION:2,FB_RETAIL_SHIPMENT:3,FB_RETAIL_SHIPMENT_TRACKING_EVENT_ETA:4,FB_RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:5,FB_RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:6,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:7,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:8,FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:9,FB_RETAIL_SHIPMENT_ETA:10,FB_RETAIL_NOW_IN_STOCK:11,FB_RETAIL_AGENT_ITEM_SUGGESTION:12,FB_RETAIL_AGENT_ITEM_RECEIPT:13,FB_RETAIL_PROMOTIONAL_MSG:14})}),null);
__d("MNCommerceCallToActionType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPEN_NATIVE:1,OPEN_URL:2,OPEN_CANCEL_RIDE_MUTATION:3,POSTBACK:4,ACCOUNT_LINK:5,MANAGE_MESSAGES:6,SHARE:7,PAYMENT:8,FACEBOOK_REPORT_A_PROBLEM:9,SUBSCRIPTION_PRESELECT:10,NAVIGATION:11,EXTENSIBLE_SHARE:12,OPEN_REACT_NATIVE_MINI_APP:13,OPEN_PAGE_ABOUT:14})}),null);
__d("ServicesCalendarSyncType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CLIENT_ONLY:"client_only",NO_CALENDAR_SYNC:"no_calendar_sync",SERVER_CONTINUOUS:"server_continuous",SERVER_SINGLE:"server_single"})}),null);
__d('messengerStoryAttachmentTransformerRe',['fbt','URI','bs_array','bs_string','bs_caml_array','bs_js_boolean','bs_caml_format','CurrentUser','bs_js_primitive','FundsAvailability','bs_js_null_undefined','P2PTransferStatus','MNCommerceBubbleType','PaymentModulesClient','MercuryAttachmentType','bs_caml_builtin_exceptions','P2PPaymentRequestStatus','ServicesCalendarSyncType','MNCommerceCallToActionType','MNCommerceShipmentTrackingEventTypes','LeadGenInfoFieldTypes'],(function a(b,c,d,e,f,g,h){'use strict';function i(na){return c('bs_array').map(function(oa){var pa=oa.user_confirmation,qa=pa==null?[null,null,null,null,false]:[pa.cancel_button_label,pa.continue_button_label,pa.confirmation_message,pa.confirmation_title,true],ra=oa.payment_metadata;return {action_link:oa.action_link,action_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceCallToActionType')[oa.action_open_type])),title:oa.title,confirmation_cancel_label:qa[0],confirmation_continue_label:qa[1],confirmation_message:qa[2],confirmation_title:qa[3],id:oa.id,is_disabled:oa.is_disabled,is_mutable_by_server:oa.is_mutable_by_server,payment_metadata:ra==null?{payment_module_config:null,total_price:null}:{payment_module_config:ra.payment_module_config,total_price:ra.total_price},render_style:oa.render_style,webview_metadata:{messenger_extensions:oa.webview_metadata.messenger_extensions,webview_height_ratio:oa.webview_metadata.webview_height_ratio,webview_share_button:oa.webview_metadata.webview_share_button},should_show_user_confirmation:qa[4],page_id:oa.page_id}},na)}function j(na){return c('bs_array').map(function(oa){var pa=oa.url,qa=pa==null?null:new (c('URI'))(pa).getUnqualifiedURI().toString();return {title:oa.title,uri:qa}},na)}function k(na){if(!(na==null)&&na!==""){return "#"+c('bs_string').sub(na,2,na.length-2|0)}else return null;}function l(na){if(na==null){return null}else return {url:na.uri,src:na.uri,width:na.width,height:na.height};}function m(na){return {id:na.id,name:na.name,desc:na.desc,thumb_url:na.thumb_url,item_url:na.item_url,title:na.name,text:na.desc,source:na.source,image_aspect_ratio:na.image_aspect_ratio,metalines:{metaline_1:na.first_metaline,metaline_2:na.second_metaline,metaline_3:na.third_metaline},default_action:na.default_action,call_to_actions:i(na.call_to_actions)}}function n(na){return {city:na.city,country:na.country,latitude:na.latitude,longitude:na.longitude,postal_code:na.postal_code,state:na.state,street_1:na.streets.length?c('bs_caml_array').caml_array_get(na.streets,0):null,street_2:na.streets.length>1?c('bs_caml_array').caml_array_get(na.streets,1):null,timezone:na.timezone}}function o(na){var oa=na.retail_carrier,pa=na.shipdate_for_display,qa={};c('bs_array').iter(function(wa){var xa=wa.messenger_commerce_location;if(xa==null){return 0}else{qa[wa.id]=n(xa);return 0}},na.shipment_tracking_events.nodes);var ra={};c('bs_array').iter(function(wa){var xa=m(wa);ra[xa.id]=xa;return 0},na.retail_shipment_items.nodes);var sa=oa.logo,ta=oa.legal_terms_of_service_text,ua=na.receipt,va=na.recipient;return {id:na.id,shipment_id:na.id,tracking_number:na.tracking_number,carrier:oa.name,carrier_tracking_url:oa.carrier_tracking_url,carrier_logo:sa==null?null:{url:sa.uri,width:sa.width,height:sa.height},display_ship_date:pa,estimated_delivery_display_time:na.estimated_delivery_time_for_display,origin:n(na.commerce_origin),destination:n(na.commerce_destination),items:ra,tracking_event_polyline:qa,legal_text:ta==null?null:ta.text,receipt_id:ua==null?null:ua.receipt_id,recipient_name:va==null?null:va.name,delivered:c('bs_array').fold_left(function(wa,xa){if(xa.shipment_tracking_event_type==="DELIVERED"){return true}else return wa;},false,na.shipment_tracking_events.nodes),messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[na.bubble_type]))}}function p(na){var oa=na.shipment.estimated_delivery_time_for_display,pa=na.shipment.shipdate_for_display,qa=na.shipment.retail_carrier,ra={};c('bs_array').iter(function(ua){var va=ua.messenger_commerce_location;if(va==null){return 0}else{ra[ua.id]=n(va);return 0}},na.shipment.shipment_tracking_events.nodes);var sa=na.messenger_commerce_location,ta=qa.logo;return {id:na.id,shipment_id:na.shipment.id,tracking_number:na.shipment.tracking_number,display_ship_date:pa,estimated_delivery_display_time:oa===""?pa:oa,origin:n(na.shipment.commerce_origin),destination:n(na.shipment.commerce_destination),carrier:qa.name,carrier_tracking_url:qa.carrier_tracking_url,display_time:na.tracking_event_time_for_display,tracking_event_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceShipmentTrackingEventTypes')[na.shipment_tracking_event_type])),tracking_event_location:sa==null?null:n(sa),tracking_event_description:na.tracking_event_description,tracking_event_polyline:ra,carrier_logo:ta==null?null:{url:ta.uri,width:ta.width,height:ta.height},items:c('bs_array').map(m,na.shipment.retail_shipment_items.nodes),messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[na.bubble_type])),delivered:c('bs_js_boolean').to_js_boolean(+(na.shipment_tracking_event_type==="DELIVERED"))}}function q(na,oa){var pa=oa.cover_photo,qa;if(pa==null){qa=[null,null,null]}else{var ra=pa.photo.image,sa=ra==null?[null,null]:[ra.uri,{height:ra.height,width:ra.width}];qa=[pa.photo.id,sa[0],sa[1]]}var ta=oa.location,ua=ta==null?[null,null]:[ta.latitude,ta.longitude],va=oa.overall_star_rating;return {address:oa.address.single_line_full_address,category:oa.top_category_name,coverPhotoID:qa[0],coverPhotoURL:qa[1],coverPhotoDimensions:qa[2],latitude:ua[0],longitude:ua[1],name:oa.name,rating:va==null?null:va.value,pageID:oa.id,priceRange:oa.price_range_description,viewerID:na}}function r(na){var oa=na.group_commerce_item_seller,pa=na.primary_photo,qa;if(pa==null){qa=null}else{var ra=pa.image;qa=ra==null?null:ra.uri}return {caption:na.group_commerce_item_description.text,desc:na.group_commerce_item_description.text,owner_id:oa==null?null:oa.id,price:na.formatted_price.text,text:na.group_commerce_item_description.text,title:na.group_commerce_item_title,thumb_url:qa,url:na.url}}function s(na){return {app_name:na.application_name,artists:na.artist_names,audio_url:na.audio_url,duration_ms:na.duration_ms,title:na.music_title}}function t(na){var oa=na.payment;return {id:na.id,desc:na.desc,display_total_cost:na.total_cost,merchant_name:na.merchant_name,target_url:na.target_url,thumb_url:na.thumb_url,raw_amount:na.raw_amount,payment_id:oa==null?null:oa.id,total_cost:{amount:c('bs_caml_format').caml_float_of_string(na.price_amount),currency:na.price_currency},name:na.name}}function u(na){return {id:na.id,canDonate:na.canDonate,hasViewerDonated:na.hasViewerDonated,fundraiserDetailedProgressText:na.fundraiserDetailedProgressText,fundraiserSubtitleText:na.fundraiserSubtitleText,focusedCoverPhoto:na.focusedCoverPhoto}}function v(na){return {id:na.id,name:na.name,desc:na.desc,thumb_url:na.thumb_url,item_url:na.item_url,title:na.name,text:na.desc,source:na.source,image_aspect_ratio:na.image_aspect_ratio,metalines:{metaline_1:na.first_metaline,metaline_2:na.second_metaline,metaline_3:na.third_metaline},default_action:na.default_action,call_to_actions:i(na.call_to_actions)}}function w(na){var oa=na.guestStatus,pa=na.event_place,qa=na.social_context;return {eventID:na.eventID,guestStatus:oa==null?"unknown":c('bs_string').lowercase(oa),canViewerJoin:na.canViewerJoin,timeString:na.timeString,locationString:pa==null?null:pa.name,socialOrTimeContextString:qa==null?null:qa.text,connectedButtonText:h._("Joined"),unconnectedButtonText:h._("Going"),watchStatus:c('bs_string').lowercase(na.watchStatus),showInterestedAction:c('bs_js_boolean').to_js_boolean(+(na.connection_style==="INTERESTED")),canViewerWatch:na.canViewerWatch}}function x(na){var oa=function nb(ob){var pb=ob.page_call_to_action;if(pb==null){return undefined}else return pb.id;},pa=function nb(ob){var pb=ob.page_call_to_action;if(pb==null){return false}else{var qb=pb.component_flow_service_config;if(qb==null){return false}else return true;}},qa=na.page,ra=qa==null?[undefined,undefined,undefined,false]:[qa.id,c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('ServicesCalendarSyncType')[qa.calendar_sync_type])),oa(qa),pa(qa)],sa=na.native_component_flow_request,ta;if(sa==null){ta=null}else{var ua=sa.page,va=sa.page,wa=sa.page,xa;if(wa==null){xa=undefined}else{var ya=wa.profile_picture;xa=ya==null?undefined:ya.uri}var za=sa.suggested_time_range,ab=sa.product_item,bb=sa.product_item,cb=sa.product_item,db=sa.product_item,eb;if(db==null){eb=undefined}else{var fb=db.profile_picture;eb=fb==null?undefined:fb.uri}var gb=sa.user,hb=sa.user,ib=sa.user,jb;if(ib==null){jb=undefined}else{var kb=ib.profile_picture;jb=kb==null?undefined:kb.uri}ta={requestAdminApprovalType:sa.request_admin_approval_type,availability:sa.availability,calendarSyncType:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('ServicesCalendarSyncType')[sa.calendar_sync_type])),hasSavedToCalendar:sa.has_saved_to_calendar,generalInfo:sa.service_general_info,id:sa.id,pageID:ua==null?undefined:ua.id,pageName:va==null?undefined:va.name,pageProfilePic:xa,preferredTimeRange:za==null?null:{end:za.end,start:za.start},price:ab==null?null:ab.experimental_freeform_price,duration:bb==null?null:bb.duration_in_seconds,requestedTime:sa.requested_time,serviceName:cb==null?null:cb.name,serviceProfilePic:eb,specialRequest:sa.special_request,status:sa.booking_status_value,statusLabel:sa.status,userID:gb==null?undefined:gb.id,username:hb==null?undefined:hb.short_name,userProfilePic:jb,additionalInfo:sa.additional_info}}var lb=na.message_bubble_type,mb;switch(lb){case "CANCELLED":mb=["Cancelled",h._("Cancelled")];break;case "DECLINED":mb=["Declined",h._("Declined")];break;case "REQUESTED":mb=["Requested",h._("Requested")];break;case "SCHEDULEED":mb=["Scheduled",h._("Scheduled")];break;default:throw [c('bs_caml_builtin_exceptions').invalid_argument,"Erroneous target status"];}return {id:na.id,pageID:ra[0],calendarSyncType:ra[1],ctaID:ra[2],hasServiceConfig:ra[3],userID:na.user.id,status:mb[0],statusLabel:mb[1],viewerID:c('CurrentUser').getAccountID(),requestMetadata:ta}}function y(na){return {live_location_id:na.live_location_id,is_expired:c('bs_js_boolean').to_js_boolean(na.is_expired),expiration_time:na.expiration_time,sender:na.sender,coordinate:na.coordinate,location_title:na.location_title,sender_destination:na.sender_destination,stop_reason:na.stop_reason}}function z(na){var oa=na.first_metaline;return {desc:na.description,id:na.id,image_aspect_ratio:na.image_aspect_ratio,item_url:na.target_url,metalines:oa==null?{}:{metaline_1:oa},name:na.name,source:na.source_name,text:na.description,thumb_url:na.image_url,title:na.name,default_action:na.default_action,call_to_actions:i(na.call_to_actions),media_blob_attachments:na.media_blob_attachments}}function aa(na){var oa=c('bs_array').map(z,na.business_items.nodes),pa=i(na.call_to_actions);return {message:na.message,call_to_actions:pa,items:oa}}function ba(na){return {message:na.message,call_to_actions:i(na.call_to_actions),items:c('bs_array').map(z,na.promotion_items.nodes)}}function ca(na){var oa=na.partner_logo;return {account_holder_name:na.account_holder_name,adjustments:c('bs_array').map(function(pa){return {adjustment_type:pa.adjustment_type,display_adjustment_amount:pa.adjustment_amount}},na.adjustments),cancellation_url:na.cancellation_url,items:c('bs_array').map(z,na.items.nodes),merchant_name:na.merchant_name,messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[na.messenger_commerce_bubble_type])),order_id:na.order_id,order_time:na.order_time,order_url:na.order_url,payment_method:na.payment_method,receipt_id:na.receipt_id,recipient_name:na.recipient_name,shipping_cost:na.shipping_cost,shipping_method:na.shipping_method,status:na.status,structured_address:{city:na.structured_address.city,state:na.structured_address.state,country:na.structured_address.country,postal_code:na.structured_address.postal_code,street_1:c('bs_caml_array').caml_array_get(na.structured_address.streets,0),street_2:c('bs_caml_array').caml_array_get(na.structured_address.streets,1)},subtotal:na.subtotal,total_cost:na.total_cost,total_tax:na.total_tax,partner_logo:oa==null?undefined:oa.uri}}function da(na,oa){return {payment_modules_client:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('PaymentModulesClient')[oa.payment_modules_client])),is_viewer_seller:oa.is_viewer_seller,payment_snippet:oa.payment_snippet,item_list:c('bs_array').map(function(pa){return {item_id:pa.item_id,name:pa.name,subtitle:pa.subtitle,description:pa.description,unit_price:pa.unit_price,image_urls:c('bs_array').map(function(qa){return qa.uri},pa.images),quantity:pa.quantity}},oa.item_list),components:oa.components,payment_call_to_actions:oa.payment_call_to_actions,click_action:oa.click_action,actor_id:na,invoicer_id:oa.invoicer_id}}var ea=function na(oa){var pa=c("LeadGenInfoFieldTypes"),qa={},ra=[];for(var sa=oa.field_data_list,ta=Array.isArray(sa),ua=0,sa=ta?sa:sa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var va;if(ta){if(ua>=sa.length)break;va=sa[ua++]}else{ua=sa.next();if(ua.done)break;va=ua.value}var wa=va,xa=wa.field_type,ya=wa.label,za=wa.values;if(xa===pa.CUSTOM){ra.push({label:ya,values:za})}else qa[xa]={label:ya,values:za};}qa.questions=ra;return qa};function fa(na,oa){var pa=oa.invite_recipient,qa=pa==null?null:pa.id,ra=oa.invite_sender,sa=ra==null?null:ra.id;return {quick_invite_id:oa.id,recipient_id:qa,sender_id:sa,is_viewer_recipient:c('bs_js_boolean').to_js_boolean(+(na===qa))}}function ga(na){var oa=function ra(sa){if(sa==null){return null}else return sa.uri;},pa=na.listing_category,qa=pa==null?[null,null]:[pa.offer_image,pa.request_image];return {listingType:na.listing_type,mapURI:oa(na.map_image),offerURI:oa(qa[0]),requestURI:oa(qa[1])}}function ha(na){return {sender:na.sender,receiver:na.receiver,transfer_id:na.transfer_id,bubbleView:na.bubble_view}}function ia(na){var oa=na.receiver_profile,pa;if(oa==null){pa=null}else{var qa=oa.profile_picture;pa={id:oa.id,name:oa.short_name,full_name:oa.name,picture:qa==null?null:qa.uri,profile_url:oa.url}}var ra=na.sender,sa;if(ra==null){sa={}}else{var ta=ra.profile_picture;sa={id:ra.id,name:ra.name,full_name:ra.full_name,picture:ta==null?null:ta.uri,profile_uri:ra.url}}var ua=na.transfer_context,va;if(ua==null){va=[null,null,null]}else{var wa=ua.transfer_theme;va=[ua.memoText,c('bs_array').map(function(za){var ab=za.image;if(ab==null){return null}else return ab.uri;},ua.memo_images),wa==null?null:wa.id]}var xa=na.platform_item,ya=xa==null?null:{name:xa.name,description:xa.description,image:c('bs_array').map(function(za){var ab=za.image;if(ab==null){return null}else return ab.uri;},xa.photos),refURL:xa.url};return {sender:sa,amountWithSymbol:na.transaction_amount.formatted_amount,status:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('P2PTransferStatus')[na.transfer_status])),receiver:pa,transfer_id:na.transfer_id,completedTime:na.completedTime,updatedTime:na.updatedTime,creationTime:na.creationTime,amount:na.transaction_amount.amount,memoText:va[0],memoPhotoURLs:va[1],themeID:va[2],discountAmount:na.amount_fb_discount.formatted,fundsAvailability:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('FundsAvailability')[na.funds_availability])),groupThreadFBID:na.group_thread_fbid,platform_item:ya,statusDescription:{markup:na.status_description},bubbleView:na.bubble_view}}function ja(na){var oa=na.requester,pa;if(oa==null){pa=undefined}else{var qa=oa.profile_picture;pa={id:oa.id,name:oa.short_name,full_name:oa.name,picture:qa==null?null:qa.uri,profile_url:oa.url}}var ra=na.requestee,sa;if(ra==null){sa=undefined}else{var ta=ra.profile_picture;sa={id:ra.id,name:ra.short_name,full_name:ra.name,picture:ta==null?null:ta.uri,profile_url:ra.url}}var ua=c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('P2PPaymentRequestStatus')[na.request_status])),va=na.transfer,wa=va==null?[null,""]:[ia(va),va.id],xa=na.request_theme;return {amount:na.transaction_amount.amount,amountWithSymbol:na.amount.formatted,requestee:sa,requester:pa,currentStatus:ua,currency:na.amount.currency,creationTime:na.creation_time,groupThreadFBID:na.group_thread_fbid,id:na.id,memoText:na.memo_text,themeID:xa==null?null:xa.id,transfer:wa[0],transferID:wa[1],updatedTime:na.updated_time,statusDescription:{markup:na.status_description}}}function ka(na){var oa=ja({amount:na.amount,transaction_amount:na.transaction_amount,requester:na.requester,requestee:na.requestee,request_status:na.request_status,request_theme:na.request_theme,id:na.id,memo_text:na.memo_text,transfer:na.transfer,creation_time:na.creation_time,group_thread_fbid:na.group_thread_fbid,updated_time:na.updated_time,status_description:na.status_description}),pa={individualRequests:c('bs_array').map(ja,na.individual_requests)};return Object.assign(oa,pa)}function la(na,oa){var pa=oa.media,qa=pa==null?null:pa.animated_image,ra=pa==null?null:pa.image,sa={};c('bs_array').iter(function(gb){var hb=gb.value;sa[gb.key]=hb==null?null:hb.text;return 0},oa.properties);var ta=oa.target,ua;if(ta==null){ua=null}else switch(ta.tag|0){case 0:ua=ga(ta[0]);break;case 1:ua=ha(ta[0]);break;case 2:ua=ia(ta[0]);break;case 3:ua=ka(ta[0]);break;case 4:ua=da(na,ta[0]);break;case 7:ua=ba(ta[0]);break;case 8:ua=aa(ta[0]);break;case 10:ua=ea(ta[0]);break;case 11:ua=y(ta[0]);break;case 12:ua=fa(na,ta[0]);break;case 13:ua=x(ta[0]);break;case 14:var va=ta[0],wa=va.genie_sender,xa=wa==null?[null,null]:[wa.messaging_actor.id,wa.messaging_actor.name],ya=xa[0],za=va.story_attachment,ab=za==null?null:ma(na,{legacy_attachment_id:ya,story_attachment:{action_links:za.action_links,messaging_attribution:za.messaging_attribution,deduplication_key:za.deduplication_key,description:za.description,media:za.media,properties:za.properties,source:za.source,style_list:za.style_list,title_with_entities:za.title_with_entities,url:za.url,subattachments:[],target:null}});ua={genie_id:ya,genie_name:xa[1],attachment:ab};break;case 15:ua=w(ta[0]);break;case 16:ua=s(ta[0]);break;case 18:ua=v(ta[0]);break;case 19:ua=t(ta[0]);break;case 20:ua=u(ta[0]);break;case 21:ua=ca(ta[0]);break;case 23:ua=r(ta[0]);break;case 24:ua=q(na,ta[0]);break;case 30:ua=p(ta[0]);break;case 31:ua=o(ta[0]);break;default:ua=ta[0];}var bb=oa.target,cb=!(bb==null)&&bb.tag===7?0:null,db=oa.description,eb=oa.source,fb=oa.title_with_entities;return {description:db==null?null:db.text,media:{animated_image:qa==null?null:qa.uri,animated_image_size:qa==null?{height:null,width:null}:{height:qa.height,width:qa.width},image:ra==null?null:ra.uri,image_size:ra==null?{height:null,width:null}:{height:ra.height,width:ra.width},duration:pa==null?null:pa.playable_duration,playable:pa==null?null:pa.is_playable,source:pa==null?null:pa.playable_url},source:eb==null?null:eb.text,style_list:oa.style_list,title:fb==null?null:fb.text,action_links:j(oa.action_links),messaging_attribution:oa.messaging_attribution,properties:sa,uri:oa.url,deduplication_key:oa.deduplication_key,target:ua,label:cb}}function ma(na,oa){var pa=oa.story_attachment,qa;if(pa==null){qa=null}else{var ra={share_id:oa.legacy_attachment_id,subattachments:c('bs_array').map(function(ta){return la(na,ta)},pa.subattachments)},sa={description:pa.description,media:pa.media,source:pa.source,style_list:pa.style_list,title_with_entities:pa.title_with_entities,properties:pa.properties,url:pa.url,deduplication_key:pa.deduplication_key,action_links:pa.action_links,messaging_attribution:pa.messaging_attribution,target:pa.target};qa=Object.assign(ra,la(na,sa))}return {app_attribution:null,attach_type:c('MercuryAttachmentType').SHARE,name:null,url:null,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:null,metadata:null,share:qa,thumbnail_url:null}}g._getCallToActions=i;g._getActionLinks=j;g._getColor=k;g._getLogo=l;g._getCommerceLocation=n;g._getMessengerRetailShipmentTarget=o;g._getShipmentTrackingEventTarget=p;g._getPageTarget=q;g._getGroupCommerceProductItemTarget=r;g._getExternalSongTarget=s;g._getAgentSuggestionItemTarget=t;g._getFundraiserTarget=u;g._getRetailItemTarget=v;g._getEventTarget=w;g._getPagesPlatformBookingMessageTarget=x;g._getMessageLiveLocationTarget=y;g._getBusinessRetailItem=z;g._getMessengerBusinessMessageTarget=aa;g._getMessengerRetailPromotionTarget=ba;g._getMessengerRetailReceiptTarget=ca;g._getPagesPlatformAttachmentTarget=da;g._getPagesPlatformLeadGenInfoTarget=ea;g._getQuickInviteTarget=fa;g._getCrisisListingTarget=ga;g._getMoneyTransferTarget=ha;g._getP2PTransferTarget=ia;g._getP2PTransferRequestTarget=ja;g._getP2PTransferRequestWithIndividualRequests=ka;g.transformStoryAttachment=la;g.getExtensibleAttachmentPayload=ma}),null);
__d('messengerAttachmentTransformerRe',['fbt','bs_array','bs_js_boolean','bs_pervasives','MercuryAttachmentType','MercuryAttachmentContentType','messengerStoryAttachmentTransformerRe'],(function a(b,c,d,e,f,g,h){'use strict';function i(q){if(q.is_malicious){return {app_attribution:null,icon_type:c('MercuryAttachmentContentType').UNKNOWN,metadata:null,name:null,preview_height:null,preview_url:null,preview_width:null,rel:null,share:null,thumbnail_url:null,url:null,attach_type:c('MercuryAttachmentType').ERROR,error_msg:h._("This attachment has been marked as malicious."),message_file_fbid:null,url_shimhash:null,url_skipshim:null}}else{var r=q.attribution_app,s;if(r==null){s=null}else{var t=r.square_logo;s={id:r.id,icon_url:t==null?null:t.uri,metadata:q.attribution_metadata,name:r.name}}var u=q.url;return {app_attribution:s,icon_type:q.content_type,metadata:null,name:q.filename,preview_height:null,preview_url:null,preview_width:null,rel:"ignore",share:null,thumbnail_url:null,url:u==null?null:u,attach_type:c('MercuryAttachmentType').FILE,error_msg:undefined,message_file_fbid:q.message_file_fbid,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim}}}function j(q,r,s){var t=q.chat_image,u=t==null?[null,null,null]:[t.uri,t.width,t.height],v=u[0],w=q.chat_image,x=w==null?null:{width:w.width,height:w.height},y=q.large_image,z=y==null?[null,null]:[y.uri,{width:y.width,height:y.height}],aa=q.inbox_image,ba=aa==null?[null,null]:[aa.uri,{width:aa.width,height:aa.height}],ca=q.attribution_app,da;if(ca==null){da=null}else{var ea=ca.square_logo;da={id:ca.id,icon_url:ea==null?null:ea.uri,metadata:q.attribution_metadata,name:ca.name}}return {app_attribution:da,attach_type:c('MercuryAttachmentType').VIDEO,name:q.filename,url:q.playable_url,rel:"async",preview_url:v,preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').VIDEO,metadata:{fbid:q.legacy_attachment_id,render_as_sticker:c('bs_js_boolean').to_js_boolean(+(q.video_type==="SPEAKING_STICKER")),dimensions:{width:q.original_dimensions.x,height:q.original_dimensions.y},duration:q.playable_duration_in_ms,large_size:z[1],large_preview:z[0],chat_size:x,chat_preview:v,inbox_size:ba[1],inbox_preview:ba[0],pageid:s?r:undefined},thumbnail_url:v,share:null}}function k(q){var r=q.attribution_app,s;if(r==null){s=null}else{var t=r.square_logo;s={id:r.id,icon_url:t==null?null:t.uri,metadata:q.attribution_metadata,name:r.name}}return {app_attribution:s,attach_type:c('MercuryAttachmentType').FILE,name:q.filename,url:q.playable_url,rel:"ignore",preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').MUSIC,metadata:{duration:q.playable_duration_in_ms,isVoicemail:q.is_voicemail?"1":"0",type:q.audio_type==="VOICE_MESSAGE"?"fb_voice_message":q.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"?"fb_voice_message_with_transcript":"file_attachment"},thumbnail_url:null,share:null,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim}}function l(q,r,s){var t=q.preview_image,u=t==null?[null,null,null]:[t.uri,t.width,t.height],v=q.animated_image,w=v==null?null:v.uri,x=q.attribution_app,y;if(x==null){y=null}else{var z=x.square_logo;y={id:x.id,icon_url:z==null?null:z.uri,metadata:q.attribution_metadata,name:x.name}}return {app_attribution:y,attach_type:c('MercuryAttachmentType').ANIMATED_IMAGE,name:q.filename,url:w,rel:"async",preview_url:u[0],preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').PHOTO,metadata:{fbid:q.legacy_attachment_id,image:w,dimensions:c('bs_pervasives').string_of_int(q.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(q.original_dimensions.y)),pageid:s?r:undefined},thumbnail_url:w,share:null}}function m(q){var r=q.original_extension==="gif"?c('MercuryAttachmentType').ANIMATED_IMAGE:q.render_as_sticker?c('MercuryAttachmentType').THIRDPARTYSTICKER:c('MercuryAttachmentType').PHOTO,s=q.preview,t=s==null?[null,null,null]:[s.uri,s.width,s.height],u;if(r===c('MercuryAttachmentType').PHOTO){var v=q.large_preview;u=v==null?[null,null,null]:[v.uri,v.width,v.height]}else u=[null,null,null];var w=q.attribution_app,x;if(w==null){x=null}else{var y=w.square_logo;x={id:w.id,icon_url:y==null?null:y.uri,metadata:q.attribution_metadata,name:w.name}}var z=q.thumbnail;return {app_attribution:x,attach_type:r,name:q.filename,url:null,rel:"async",preview_url:t[0],preview_width:t[1],preview_height:t[2],large_preview_url:u[0],large_preview_width:u[1],large_preview_height:u[2],icon_type:c('MercuryAttachmentContentType').PHOTO,metadata:{fbid:q.legacy_attachment_id,dimensions:c('bs_pervasives').string_of_int(q.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(q.original_dimensions.y))},thumbnail_url:z==null?null:z.uri,share:null}}function n(q,r){var s=r,t=q;if(q>=r){var u=c('bs_pervasives').min(120,t/2),v=u/(t/2);return [u|0,s/2*v|0]}else{var w=c('bs_pervasives').min(120,s/2),x=w/(s/2);return [t/2*x|0,w|0]}}function o(q){var r=n(q.width,q.height),s=q.pack,t=q.sprite_image,u=q.sprite_image_2x,v=q.padded_sprite_image,w=q.padded_sprite_image_2x;return {app_attribution:null,attach_type:c('MercuryAttachmentType').STICKER,name:null,url:q.url,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').UNKNOWN,metadata:{accessibilityLabel:q.label,stickerID:q.id,packID:s==null?null:s.id,frameCount:q.frame_count,frameRate:q.frame_rate,framesPerRow:q.frame_count>1?q.frames_per_row:1,framesPerCol:q.frame_count>1?q.frames_per_column:1,height:r[1],width:r[0],spriteURI:t==null?null:t.uri,spriteURI2x:u==null?null:u.uri,paddedSpriteURI:v==null?null:v.uri,paddedSpriteURI2x:w==null?null:w.uri,thumbnail_url:null,share:null}}}function p(q,r,s){var t=[],u=r.extensible_attachment;if(!(u==null))t.push(c('messengerStoryAttachmentTransformerRe').getExtensibleAttachmentPayload(q,u));var v=r.sticker;if(!(v==null))t.push(o(v));var w=r.blob_attachments;if(!(w==null))c('bs_array').iter(function(x){switch(x.tag|0){case 0:t.push(m(x[0]));return 0;case 1:t.push(l(x[0],q,s));return 0;case 2:t.push(k(x[0]));return 0;case 3:t.push(j(x[0],q,s));return 0;case 4:t.push(i(x[0]));return 0;}},w);return t}g._getFilePayload=i;g._getVideoPayload=j;g._getAudioPayload=k;g._getAnimatedImagePayload=l;g._getImagePayload=m;g._getStickerDimensions=n;g._getStickerPayload=o;g.transformAttachment=p}),null);
__d("InstantGameUpdateXMATUpdateType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNKNOWN:"unknown",GAME_SCORE:"game_score",CUSTOM_MESSAGE:"custom_message"})}),null);
__d("MNCommerceMessageType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({TEXT:"text",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",ROBOT_TEXT:"robot_text",LOCATION:"location",FORCED_FETCH_MESSAGE:"forced_fetch_message",SENDER_ACTION:"sender_action",RETAIL_PRODUCT_SUBSCRIPTION:"retail_product_subscription",RETAIL_PROMOTION:"retail_promotion",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_SHIPMENT:"retail_shipment",SHIPMENT_TRACKING_EVENT:"shipment_tracking_event",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_CHECKIN:"airline_checkin",AIRLINE_BOARDINGPASS:"airline_boardingpass",AIRLINE_UPDATE:"airline_update",AIRLINE_ITINERARY:"airline_itinerary",CONTENT_SUBSCRIPTION:"content_subscription",AD_ADMIN_TEXT:"ad_admin_text",AD_TEXT:"ad_text",AD_BUBBLE:"ad_bubble",NON_AD:"non_ad",UNKNOWN:"unknown",OTHER:"other",TEMPLATE:"template",OPEN_GRAPH:"open_graph",GENERIC:"generic",LIST:"list",COMPACT_LIST:"compact_list",BUTTON:"button",RECEIPT:"receipt",GENERIC_LEGACY:"generic_legacy",FALLBACK:"fallback",RIDE_INTENT:"ride_intent",RIDE_SIGNUP:"ride_signup",RIDE_WELCOME:"ride_welcome",RIDE_ORDER_CONFIRMATION:"ride_order_confirmation",RIDE_REQUESTED:"ride_requested",RIDE_DRIVER_ON_THE_WAY:"ride_driver_on_the_way",RIDE_NO_DRIVER:"ride_no_driver",RIDE_DRIVER_ARRIVING:"ride_driver_arriving",RIDE_DRIVER_CANCELED:"ride_driver_canceled",RIDE_RIDER_CANCELED:"ride_rider_canceled",RIDE_COMPLETE:"ride_complete",RIDE_ADMIN_MESSAGE:"ride_admin_message",RIDE_RECEIPT:"ride_receipt",RIDE_REENGAGEMENT_FIRST_RIDE:"ride_reengagement_first_ride",GET_RIDE:"give_get_ride",GIVE_RIDE:"send_give_get_ride",REFERER_PROMO:"referer_promo",INSTANT_GAMES_SHARE:"instant_games_share",INSTANT_GAMES_SCORE:"instant_games_score",LINK:"link_admin_message",UNLINK:"unlink_admin_message",BLOCK_ALL:"block_all_admin_message",UNBLOCK_ALL:"unblock_all_admin_message",BLOCK_PROMOTION:"block_promotion_admin_message",UNBLOCK_PROMOTION:"unblock_promotion_admin_message",INITIAL_PROMOTION:"initial_promotion_admin_message",WEAK_CONSENT_ADMIN_MESSAGE:"weak_consent_admin_message",MESSENGER_TEAM_BOT_MESSAGE:"messenger_team_bot",MESSENGER_BOT_BASE_GENERIC:"messenger_bot_base_generic",COMMERCE_COMPACT_LIST:"commerce_compact_list",MEDIA:"media"})}),null);
__d('MessagingTagUtils',['MessagingSourceEnum','MessagingTagConstants','MercuryMessageSourceTags','Set'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('Set'))(Object.values(c('MessagingSourceEnum')));function i(l){for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p;if(h.has(q))return q;}return c('MessagingSourceEnum').UNKNOWN}function j(l){for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p,r=q.split(c('MessagingTagConstants').app_id_root);if(r.length>1)return r[1].trim();}return null}function k(l,m){var n=[],o=j(l);if(o&&c('MessagingTagConstants').orca_app_ids.indexOf(o)!==-1)n.push(c('MercuryMessageSourceTags').MESSENGER);if(c('MessagingTagConstants').chat_sources.indexOf(m)!==-1)n.push(c('MercuryMessageSourceTags').CHAT);if(c('MessagingTagConstants').email_source===m)n.push(c('MercuryMessageSourceTags').EMAIL);if(c('MessagingTagConstants').mobile_sources.indexOf(m)!==-1)n.push(c('MercuryMessageSourceTags').MOBILE);return n}f.exports={getSourceFromTags:i,getSourceTags:k}}),null);
__d("P2PPaymentLogMessageSubtype",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SENT_IN_GROUP:"sent_in_group",CANCELED_SENDER_RISK:"canceled_sender_risk",CANCELED_DECLINED:"canceled_declined",CANCELED_RECIPIENT_RISK:"canceled_recipient_risk",CANCELED_EXPIRED:"canceled_expired",CANCELED_SAME_CARD:"canceled_same_card",CANCELED_CUSTOMER_SERVICE:"canceled_customer_service",CANCELED_CHARGEBACK:"canceled_chargeback",CANCELED_SYSTEM_FAIL:"canceled_system_fail",REQUEST_CANCELED_BY_REQUESTER:"request_canceled_by_requester",REQUEST_DECLINED_BY_REQUESTEE:"request_declined_by_requestee",REQUEST_EXPIRED:"request_expired",REQUEST_REMINDER:"request_reminder",MONEY_RAIN_GAME_ENTRY_POINT:"money_rain_game_entry_point"})}),null);
__d('messengerMessageTransformerRe',['FBID','bs_array','bs_block','bs_string','getByPath','bs_js_boolean','MercuryIDs','bs_pervasives','bs_caml_format','CurrentUser','bs_js_primitive','MessagingTag','bs_js_null_undefined','MercuryActionType','MessagingTagUtils','MessagingSourceEnum','StoryAttachmentStyle','MNCommerceMessageType','MercuryLogMessageType','P2PPaymentLogMessageSubtype','MessagingGenericAdminTextType','InstantGameUpdateXMATUpdateType','messengerAttachmentTransformerRe'],(function a(b,c,d,e,f,g){'use strict';function h(o,p,q){var r;if(o.__typename==="GroupPollExtensibleMessageAdminText"){var s=o.question,t;if(s==null){t=[{},null]}else{var u=Object.assign({},s);Object.assign(u,{total_count:o.total_count,options:c('bs_array').map(function(v){var w=Object.assign({},v);return Object.assign(w,{total_count:v.voters.nodes.length,voters:c('bs_array').map(function(x){return x.id},v.voters.nodes)})},s.options.nodes)});t=[u,s.id]}r={message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:{event_type:c('bs_string').lowercase(o.event_type),question_id:t[1],question_json:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(JSON.stringify(t[0])))}}}else r=o.__typename==="InstantGameUpdateExtensibleMessageAdminText"?{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:{game_id:c('getByPath')(o,["game","id"]),update_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('InstantGameUpdateXMATUpdateType')[o.update_type])),collapsed_text:o.collapsed_text,expanded_text:o.expanded_text,cta_url:c('getByPath')(o,["instant_game_update_data","cta_url"]),cta_title:c('getByPath')(o,["instant_game_update_data","cta_title"]),custom_image_url:c('getByPath')(o,["instant_game_update_data","photo","image","uri"]),template:c('getByPath')(o,["instant_game_update_data","template"])}}:o.__typename==="MessengerAdContextAdminText"?{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:{ad_url:o.ad_url}}:o.__typename==="ThemeColorExtensibleMessageAdminText"||o.__typename==="ThreadIconExtensibleMessageAdminText"||o.__typename==="ThreadNicknameExtensibleMessageAdminText"||o.__typename==="AcceptPendingThreadExtensibleMessageAdminText"||o.__typename==="AddContactExtensibleMessageAdminText"||o.__typename==="RtcCallLogExtensibleMessageAdminText"||o.__typename==="GameScoreExtensibleMessageAdminText"||o.__typename==="ConfirmFriendRequestExtensibleMessageAdminText"||o.__typename==="PartiesInviteExtensibleMessageAdminText"||o.__typename==="AppointmentReminderExtensibleMessageAdminText"?{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:Object.assign({},o)}:{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:undefined};return {log_message_body:q,log_message_data:r,log_message_type:c('MercuryLogMessageType').GENERIC_ADMIN_TEXT}}function i(o){return c('bs_array').map(function(p){if(p==="p2p_transfer"){return c('StoryAttachmentStyle').ORION}else if(p==="p2p_payment_request"){return c('StoryAttachmentStyle').ORION_REQUEST}else return p;},o)}function j(o){var p=o.target,q;if(p==null){q=null}else if(p.__typename==="CrisisListing"){q=c('bs_block').__(0,[{listing_type:p.listing_type,listing_category:p.listing_category,map_image:p.map_image}])}else if(p.__typename==="MoneyTransfer"){q=c('bs_block').__(1,[{sender:p.sender,receiver:p.receiver,transfer_id:p.transfer_id,bubble_view:p.bubble_view}])}else if(p.__typename==="PeerToPeerTransfer"){q=c('bs_block').__(2,[{sender:p.sender,receiver_profile:p.receiver_profile,transaction_amount:p.transaction_amount,transfer_status:p.transfer_status,transfer_id:p.transfer_id,completedTime:p.completedTime,updatedTime:p.updatedTime,creationTime:p.creationTime,transfer_context:p.transfer_context,amount_fb_discount:p.amount_fb_discount,funds_availability:p.funds_availability,group_thread_fbid:p.group_thread_fbid,platform_item:p.platform_item,id:p.id,status_description:p.status_description,bubble_view:p.bubble_view}])}else if(p.__typename==="PeerToPeerPaymentRequest"){q=c('bs_block').__(3,[{amount:p.amount,transaction_amount:p.transaction_amount,requester:p.requester,requestee:p.requestee,request_status:p.request_status,request_theme:p.request_theme,id:p.id,memo_text:p.memo_text,transfer:p.transfer,creation_time:p.creation_time,group_thread_fbid:p.group_thread_fbid,updated_time:p.updated_time,status_description:p.status_description,individual_requests:p.individual_requests}])}else if(p.__typename==="PaymentPlatformAttachment"){q=c('bs_block').__(4,[{payment_modules_client:p.payment_modules_client,is_viewer_seller:p.is_viewer_seller,payment_snippet:p.payment_snippet,item_list:p.item_list,components:p.components,payment_call_to_actions:p.payment_call_to_actions,click_action:p.click_action,invoicer_id:p.invoicer_id}])}else if(p.__typename==="MomentsAppMessengerInvitation"){q=c('bs_block').__(5,[{snippet:p.snippet}])}else if(p.__typename==="MomentsAppMessengerPhotoRequest"){q=c('bs_block').__(6,[{snippet:p.snippet}])}else if(p.__typename==="MessengerRetailPromotion"){q=c('bs_block').__(7,[{message:p.message,call_to_actions:p.call_to_actions,promotion_items:p.promotion_items}])}else if(p.__typename==="MessengerBusinessMessage"){q=c('bs_block').__(8,[{message:p.message,call_to_actions:p.call_to_actions,business_items:p.business_items}])}else if(p.__typename==="Video"){q=c('bs_block').__(9,[{video_id:p.video_id}])}else if(p.__typename==="PagesPlatformLeadGenInfo"){q=c('bs_block').__(10,[{field_data_list:p.field_data_list}])}else if(p.__typename==="MessageLiveLocation"){q=c('bs_block').__(11,[{live_location_id:p.live_location_id,is_expired:p.is_expired,expiration_time:p.expiration_time,sender:p.sender,coordinate:p.coordinate,location_title:p.location_title,sender_destination:p.sender_destination,stop_reason:p.stop_reason}])}else if(p.__typename==="QuickInvite"){q=c('bs_block').__(12,[{id:p.id,invite_sender:p.invite_sender,invite_recipient:p.invite_recipient}])}else if(p.__typename==="PagesPlatformBookingMessage"){q=c('bs_block').__(13,[{id:p.id,page:p.page,message_bubble_type:p.message_bubble_type,user:p.user,native_component_flow_request:p.native_component_flow_request}])}else if(p.__typename==="GenieMessage"){q=c('bs_block').__(14,[{genie_sender:p.genie_sender,story_attachment:p.story_attachment}])}else if(p.__typename==="Event"){q=c('bs_block').__(15,[{eventID:p.eventID,guestStatus:p.guestStatus,canViewerJoin:p.canViewerJoin,timeString:p.timeString,event_place:p.event_place,social_context:p.social_context,watchStatus:p.watchStatus,connection_style:p.connection_style,canViewerWatch:p.canViewerWatch}])}else if(p.__typename==="ExternalSong"){q=c('bs_block').__(16,[{application_name:p.application_name,artist_names:p.artist_names,audio_url:p.audio_url,duration_ms:p.duration_ms,music_title:p.music_title}])}else if(p.__typename==="LightweightAction"){q=c('bs_block').__(17,[{lwa_state:p.lwa_state,lwa_type:p.lwa_type}])}else if(p.__typename==="MessengerRetailItem"){q=c('bs_block').__(18,[{id:p.id,name:p.name,desc:p.desc,thumb_url:p.thumb_url,item_url:p.item_url,source:p.source,image_aspect_ratio:p.image_aspect_ratio,first_metaline:p.first_metaline,second_metaline:p.second_metaline,third_metaline:p.third_metaline,default_action:p.default_action,call_to_actions:p.call_to_actions}])}else if(p.__typename==="AgentItemSuggestion"){q=c('bs_block').__(19,[{id:p.id,desc:p.desc,total_cost:p.total_cost,merchant_name:p.merchant_name,target_url:p.target_url,thumb_url:p.thumb_url,raw_amount:p.raw_amount,payment:p.payment,price_amount:p.price_amount,price_currency:p.price_currency,name:p.name}])}else if(p.__typename==="FundraiserPersonToCharity"||p.__typename==="FundraiserPersonForPerson"){var r=p.fundraiser_detailed_progress_text,s=p.fundraiser_subtitle_text,t=p.focused_cover_photo;q=c('bs_block').__(20,[{id:p.id,canDonate:p.can_donate,hasViewerDonated:p.has_viewer_donated,fundraiserDetailedProgressText:r==null?null:r.text,fundraiserSubtitleText:s==null?null:s.text,focusedCoverPhoto:t==null?null:{src:t.photo.image.uri,data:{height:t.photo.image.height,width:t.photo.image.width}}}])}else q=p.__typename==="MessengerRetailReceipt"?c('bs_block').__(21,[{account_holder_name:p.account_holder_name,adjustments:p.retail_adjustments,cancellation_url:p.cancellation_url,items:p.retail_items,merchant_name:p.merchant_name,messenger_commerce_bubble_type:p.bubble_type,order_id:p.receipt_id,order_time:p.order_time_for_display,order_url:p.receipt_url,payment_method:p.order_payment_method,receipt_id:p.id,recipient_name:p.recipient_name,shipping_cost:p.shipping_cost,shipping_method:p.shipping_method,status:p.status,structured_address:p.structured_address,subtotal:p.subtotal,total_cost:p.total,total_tax:p.tax,partner_logo:p.partner_log}]):p.__typename==="JobApplication"?c('bs_block').__(22,[{id:p.id}]):p.__typename==="GroupCommerceProductItem"?c('bs_block').__(23,[{group_commerce_item_description:p.group_commerce_item_description,group_commerce_item_seller:p.group_commerce_item_seller,formatted_price:p.formatted_price,group_commerce_item_title:p.group_commerce_item_title,primary_photo:p.primary_photo,url:p.url}]):p.__typename==="Page"?c('bs_block').__(24,[{address:p.address,top_category_name:p.top_category_name,cover_photo:p.cover_photo,location:p.location,name:p.name,overall_star_rating:p.overall_star_rating,id:p.id,price_range_description:p.price_range_description}]):p.__typename==="MessengerEventReminder"?c('bs_block').__(25,[{is_active:p.is_active}]):p.__typename==="AirlineBoardingPassCollectionMessageAttachment"?c('bs_block').__(26,[{tint_color:p.tint_color,logo:p.logo,flight_label:p.flight_label,boarding_time_label:p.boarding_time_label,departure_label:p.departure_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,flight_terminal_label:p.flight_terminal_label,flight_gate_label:p.flight_gate_label,view_boarding_pass_cta_label:p.view_boarding_pass_cta_label,boarding_passes:p.boarding_passes,share_cta_label:p.share_cta_label,message_cta_label:p.message_cta_label,boarding_pass_title_label:p.boarding_pass_title_label,boarding_pass_error_title_label:p.boarding_pass_error_title_label}]):p.__typename==="AirlineCheckInReminderMessageAttachment"?c('bs_block').__(27,[{pnr_number:p.pnr_number,tint_color:p.tint_color,checkin_url:p.checkin_url,booking_number_label:p.booking_number_label,flight_label:p.flight_label,arrival_time_label:p.arrival_time_label,departure_time_label:p.departure_time_label,checkin_cta_label:p.checkin_cta_label,logo:p.logo,flight_infos:p.flight_infos}]):p.__typename==="AirlineUpdateMessageAttachment"?c('bs_block').__(28,[{pnr_number:p.pnr_number,tint_color:p.tint_color,update_type:p.update_type,departure_time_label:p.departure_time_label,arrival_time_label:p.arrival_time_label,booking_number_label:p.booking_number_label,flight_gate_label:p.flight_gate_label,flight_label:p.flight_label,flight_status_label:p.flight_status_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,logo:p.logo,flight_info:p.flight_info,hightlighted_labels:p.hightlighted_labels}]):p.__typename==="AirlineItineraryMessageAttachment"?c('bs_block').__(29,[{confirmation_number:p.confirmation_number,pnr_number:p.pnr_number,tint_color:p.tint_color,formatted_total:p.formatted_total,itemized_price_infos:p.itemized_price_infos,formatted_tax:p.formatted_tax,formatted_base_price:p.formatted_base_price,passenger_infos:p.passenger_infos,logo:p.logo,aircraft_type_label:p.aircraft_type_label,arrival_time_label:p.arrival_time_label,base_price_label:p.base_price_label,booking_number_label:p.booking_number_label,cabin_type_label:p.cabin_type_label,departure_time_label:p.departure_time_label,flight_confirmation_label:p.flight_confirmation_label,flight_date_label:p.flight_date_label,flight_label:p.flight_label,flight_terminal_label:p.flight_terminal_label,itinerary_error_title_label:p.itinerary_error_title_label,itinerary_title_label:p.itinerary_title_label,passenger_name_label:p.passenger_name_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,purchase_summary_label:p.purchase_summary_label,taxes_label:p.taxes_label,total_label:p.total_label,view_details_cta_label:p.view_details_cta_label,itinerary_legs:p.itinerary_legs}]):p.__typename==="MessengerRetailShipmentTrackingEvent"?c('bs_block').__(30,[{id:p.id,shipment:p.shipment,tracking_event_time_for_display:p.tracking_event_time_for_display,shipment_tracking_event_type:p.shipment_tracking_event_type,messenger_commerce_location:p.messenger_commerce_location,tracking_event_description:p.tracking_event_description,bubble_type:p.bubble_type}]):p.__typename==="MessengerRetailShipment"?c('bs_block').__(31,[{id:p.id,tracking_number:p.tracking_number,shipdate_for_display:p.shipdate_for_display,estimated_delivery_time_for_display:p.estimated_delivery_time_for_display,commerce_origin:p.commerce_origin,commerce_destination:p.commerce_destination,retail_carrier:p.retail_carrier,shipment_tracking_events:p.shipment_tracking_events,receipt:p.receipt,recipient:p.recipient,retail_shipment_items:p.retail_shipment_items,bubble_type:p.bubble_type}]):null;return {description:o.description,media:o.media,source:o.source,style_list:i(o.style_list),title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,target:q}}function k(o){var p=j({description:o.description,media:o.media,source:o.source,style_list:o.style_list,title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,target:o.target});if(p==null){return null}else{var q=c('bs_array').map(j,o.subattachments);return Object.assign({subattachments:q},p)}}function l(o){var p=o.blob_attachments,q=[];if(!(p==null))c('bs_array').iter(function(r){if(r.__typename==="MessageImage"){q.push(c('bs_block').__(0,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,preview:r.preview,large_preview:r.large_preview,thumbnail:r.thumbnail,legacy_attachment_id:r.legacy_attachment_id,original_dimensions:r.original_dimensions,original_extension:r.original_extension,render_as_sticker:r.render_as_sticker}]));return 0}else if(r.__typename==="MessageAnimatedImage"){q.push(c('bs_block').__(1,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,animated_image:r.animated_image,legacy_attachment_id:r.legacy_attachment_id,preview_image:r.preview_image,original_dimensions:r.original_dimensions}]));return 0}else if(r.__typename==="MessageAudio"){q.push(c('bs_block').__(2,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,is_voicemail:r.is_voicemail,audio_type:r.audio_type,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0}else if(r.__typename==="MessageVideo"){q.push(c('bs_block').__(3,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,legacy_attachment_id:r.legacy_attachment_id,chat_image:r.chat_image,video_type:r.video_type,original_dimensions:r.original_dimensions,large_image:r.large_image,inbox_image:r.inbox_image}]));return 0}else if(r.__typename==="MessageFile"){q.push(c('bs_block').__(4,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,url:r.url,content_type:r.content_type,is_malicious:r.is_malicious,message_file_fbid:r.message_file_fbid,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0}else return 0;},p);return q}function m(o){var p=o.message;if(p==null){return []}else{var q=[];c('bs_array').iter(function(r){var s=r.entity;if(s==null){return 0}else{var t=s.id,u=s.thread_key;if(t==null){if(u==null){return 0}else{var v=u.thread_fbid;if(v==null){return 0}else{q.push({id:v,offset:r.offset,length:r.length,type:r.__typename});return 0}}}else{q.push({id:t,offset:r.offset,length:r.length,type:r.__typename});return 0}}},p.ranges);return q}}function n(o,p,q,r){var s={};c('bs_array').iter(function(xa){s[xa.user.id]=xa.reaction;return 0},p.message_reactions);var t=+c('FBID').isUser(p.message_sender.id),u=t?c('MessagingTagUtils').getSourceFromTags(p.tags_list):c('MessagingSourceEnum').UNKNOWN,v=t?c('MessagingTagUtils').getSourceTags(p.tags_list,u):[],w=p.commerce_message_type,x=p.customizations,y={thread_id:q.thread_id,thread_fbid:q.thread_fbid,other_user_fbid:q.other_user_fbid,action_type:p.__typename==="UserMessage"?c('MercuryActionType').USER_GENERATED_MESSAGE:c('MercuryActionType').LOG_MESSAGE,message_id:p.message_id,threading_id:null,offline_threading_id:p.offline_threading_id,author:c('MercuryIDs').getParticipantIDFromUserID(p.message_sender.id),author_email:p.message_sender.email,ephemeral_ttl_mode:p.ttl,timestamp:c('bs_caml_format').caml_float_of_string(p.timestamp_precise),is_unread:p.unread,is_filtered_content:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT)!==-1)),is_filtered_content_bh:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_BH)!==-1)),is_filtered_content_account:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_ACCOUNT)!==-1)),is_filtered_content_quasar:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_QUASAR)!==-1)),is_filtered_content_invalid_app:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_INVALID_APP)!==-1)),is_sponsored:p.is_sponsored,commerce_message_type:w==null?null:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceMessageType')[w])),customizations:x==null?[]:x,source:u,source_tags:v,tags:p.tags_list,is_spoof_warning:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').DOMAIN_AUTH_FAIL)!==-1||p.tags_list.indexOf(c('MessagingTag').SPAM_SPOOFING)!==-1||p.tags_list.indexOf(c('MessagingTag').SPOOF_WARNING)!==-1)),folder:q.folder,platform_xmd:p.platform_xmd_encoded,message_source:p.message_source_data,montage_reply_data:p.montage_reply_data,skip_bump_thread:false,profile_ranges:m(p),reactions:s};if(p.__typename==="UserMessage"){var z=l(p),aa=p.extensible_attachment,ba;if(aa==null){ba=null}else{var ca=aa.story_attachment;ba={legacy_attachment_id:aa.legacy_attachment_id,story_attachment:ca==null?null:k(ca)}}var da=c('messengerAttachmentTransformerRe').transformAttachment(o,{extensible_attachment:ba,blob_attachments:z,sticker:p.sticker},r),ea=p.message,fa=p.page_admin_sender;Object.assign(y,{body:ea==null?null:ea.text,creator_info:fa==null?null:{creatorID:fa.admin_id,creatorName:fa.name,creatorType:fa.sender_type,labelType:fa.label_type,pageID:fa.page_id,profileURI:fa.profile_uri},subject:null,has_attachment:c('bs_js_boolean').to_js_boolean(+(da.length>0)),attachments:da,raw_attachments:null,ranges:undefined,meta_ranges:p.meta_ranges.map(function(xa){return babelHelpers['extends']({},xa,{data:JSON.parse(xa.data)})})})}else if(p.__typename==="VoiceCallMessage"||p.__typename==="VideoCallMessage"){var ga=p.__typename,ha=ga==="VoiceCallMessage"?c('MercuryLogMessageType').PHONE_CALL:c('MercuryLogMessageType').VIDEO_CALL,ia=p.message_sender.id,ja=q.other_user_fbid,ka=ja==null?null:c('MercuryIDs').getParticipantIDFromUserID(ia===ja?c('CurrentUser').getID():ja),la=p.answered;Object.assign(y,{log_message_type:ha,log_message_data:{answered:la==null?false:la,caller:c('MercuryIDs').getParticipantIDFromUserID(ia),callee:ka},log_message_body:p.snippet})}else if(p.__typename==="ThreadNameMessage"){Object.assign(y,{log_message_type:c('MercuryLogMessageType').THREAD_NAME,log_message_data:{name:p.thread_name},log_message_body:p.snippet})}else if(p.__typename==="ThreadImageMessage"){var ma=p.image_with_metadata,na;if(ma==null){na=null}else{var oa=ma.preview;na={preview_url:oa==null?null:oa.uri,metadata:{fbid:ma.legacy_attachment_id,dimensions:c('bs_pervasives').string_of_int(ma.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(ma.original_dimensions.y))}}}Object.assign(y,{log_message_type:c('MercuryLogMessageType').THREAD_IMAGE,log_message_data:{image:na},log_message_body:p.snippet})}else if(p.__typename==="ParticipantsAddedMessage"){var pa=p.participants_added;Object.assign(y,{log_message_type:c('MercuryLogMessageType').SUBSCRIBE,log_message_data:{added_participants:pa==null?[]:c('bs_array').map(function(xa){return c('MercuryIDs').getParticipantIDFromUserID(xa.id)},pa)},log_message_body:p.snippet})}else if(p.__typename==="ParticipantLeftMessage"){var qa=p.participants_removed;Object.assign(y,{log_message_type:c('MercuryLogMessageType').UNSUBSCRIBE,log_message_data:{removed_participants:qa==null?[]:c('bs_array').map(function(xa){return c('MercuryIDs').getParticipantIDFromUserID(xa.id)},qa)},log_message_body:p.snippet})}else if(p.__typename==="GenericAdminTextMessage"){var ra=p.extensible_message_admin_text,sa=p.extensible_message_admin_text_type;if(ra==null){if(!(sa==null))Object.assign(y,{log_message_body:p.snippet,log_message_data:{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[sa])),untypedData:undefined},log_message_type:c('MercuryLogMessageType').GENERIC_ADMIN_TEXT});}else if(!(sa==null))Object.assign(y,h(ra,sa,p.snippet));}else if(p.__typename==="P2PPaymentRequestMessage"){var ta=p.p2p_sender,ua=p.p2p_receiver,va=p.amount,wa=p.message_type;Object.assign(y,{log_message_body:p.snippet,log_message_data:{transfer_id:p.transfer_id,senderId:ta==null?null:c('MercuryIDs').getParticipantIDFromUserID(ta.id),receiverId:ua==null?null:c('MercuryIDs').getParticipantIDFromUserID(ua.id),formattedAmount:va==null?null:va.formatted,subtype:wa==null?null:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('P2PPaymentLogMessageSubtype')[wa]))},log_message_type:c('MercuryLogMessageType').ORION})}return y}g._getGenericAdminTextMessage=h;g._getStyleList=i;g.unsafeCastExtensibleAttachmentWithoutSubattachments=j;g.unsafeCastExtensibleAttachment=k;g.unsafeCastBlobAttachments=l;g._getProfileRanges=m;g.transformMessage=n}),null);
__d('messengerRealtimeAttachmentTransformerRe',['messengerMessageTransformerRe','messengerAttachmentTransformerRe'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){var l=c('messengerMessageTransformerRe').unsafeCastBlobAttachments(j),m=j.extensible_attachment,n;if(m==null){n=null}else{var o=m.story_attachment;n={legacy_attachment_id:m.legacy_attachment_id,story_attachment:o==null?null:c('messengerMessageTransformerRe').unsafeCastExtensibleAttachment(o)}}return c('messengerAttachmentTransformerRe').transformAttachment(i,{extensible_attachment:n,blob_attachments:l,sticker:j.sticker},k)}g.transform=h}),null);
__d('MercurySyncNewMessageTransformer',['FBID','IrisProtocolMessageLifetime','MercuryActionType','MercuryConfig','MercuryIDs','MercuryMessageCustomizations','MercuryProfileRanges','MercuryTimestamp','MessagingTag','messengerRealtimeAttachmentTransformerRe'],(function a(b,c,d,e,f,g){'use strict';var h=function j(k){var l={};try{l=JSON.parse(k)}catch(m){}return l};function i(j,k){var l=parseInt(k.messageMetadata.timestamp,10),m=c('MercuryTimestamp').getFormatedTimestamp(l),n=k.messageMetadata.skipBumpThread,o=j!==k.messageMetadata.actorFbId,p=[];if(k.attachments)p=k.attachments.map(function(t){var u=t.mercury,v=u.extensible_attachment,w=u.blob_attachment,x=u.sticker_attachment;if(!v&&!w&&!x)return null;var y=c('FBID').isUser(j),z=[];if(v){z=c('messengerRealtimeAttachmentTransformerRe').transform(j,{extensible_attachment:v},y)}else if(w){z=c('messengerRealtimeAttachmentTransformerRe').transform(j,{blob_attachments:[w]},y)}else z=c('messengerRealtimeAttachmentTransformerRe').transform(j,{sticker:x});return z.length>0?z[0]:null});p=p.filter(Boolean);var q=k.messageMetadata.tags?k.messageMetadata.tags[0]:undefined,r=null;if(k.data&&k.data.adminSignatureCreatorID){var s=k.data;r={creatorID:s.adminSignatureCreatorID||null,creatorName:s.adminSignatureCreatorName||null,creatorType:s.adminSignatureCreatorType||null,labelType:s.adminSignatureLabelType||null,pageID:s.adminSignaturePageID||null,profileURI:s.adminSignatureProfileURI||null}}return {message_id:k.messageMetadata.messageId,threading_id:null,offline_threading_id:k.messageMetadata.offlineThreadingId,author:c('MercuryIDs').getParticipantIDFromUserID(k.messageMetadata.actorFbId),author_email:k.messageMetadata.actorFbId+'@facebook.com',ephemeral_ttl_mode:k.ttl?c('IrisProtocolMessageLifetime')[k.ttl]:0,timestamp:l,is_unread:o,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_filtered_content_quasar:false,is_filtered_content_invalid_app:false,source:q,tags:k.messageMetadata.tags,is_spoof_warning:false,folder:c('MessagingTag').INBOX,thread_fbid:k.messageMetadata.threadKey.threadFbId,other_user_fbid:k.messageMetadata.threadKey.otherUserFbId,body:k.body!==undefined?k.body:'',html_body:null,subject:null,has_attachment:p.length>0,attachments:p,ranges:undefined,thread_id:null,action_type:c('MercuryActionType').USER_GENERATED_MESSAGE,is_from_iris:true,is_sponsored:!!(k.data&&k.data.is_sponsored&&k.data.is_sponsored==='true'),commerce_message_type:k.data?k.data.commerce_message_type:null,customizations:k.data&&k.data.customization?c('MercuryMessageCustomizations').parseCustomizations(k.data.customization):null,platform_xmd:k.data&&k.data.platform_xmd?k.data.platform_xmd:null,profile_ranges:c('MercuryProfileRanges').extractFromDelta(k),message_source:k.data&&k.data.message_source_data?h(k.data.message_source_data).message_source:null,skip_bump_thread:n,montage_reply_data:k.data&&k.data.montage_reply_data?h(k.data.montage_reply_data):null,meta_ranges:k.data&&k.data.meta_ranges?h(k.data.meta_ranges):null,creator_info:r}}f.exports={transform:i}}),null);
__d('MercurySyncAdminTextMessageTransformer',['MercuryActionType','MercuryLogMessageType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercurySyncNewMessageTransformer').transform(i,j);k.action_type=c('MercuryActionType').LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={message_type:j.type,untypedData:j.untypedData};k.log_message_type=c('MercuryLogMessageType').GENERIC_ADMIN_TEXT;return k}f.exports={transform:h}}),null);
__d("LiveLocationStopReason",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({EXPIRED:1,CANCELED:2,ARRIVED:3})}),null);
__d('MercurySyncClientPayloadTransformer',['DateConsts','LiveLocationStopReason','MercuryActionType','MercuryIDs','MessageLiveLocationClientSyncProtocolStopReason','PageCommItemStatus','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')(c('LiveLocationStopReason')),i=8;function j(q){var r=q.payload;r=JSON.parse(String.fromCharCode.apply(null,r));var s=r&&r.deltas,t=s[0];if(t.deltaMessageReaction){return l(t.deltaMessageReaction)}else if(t.liveLocationData){return n(t.liveLocationData)}else if(t.deltaUpdateGroupEventRSVPStatus){var u=t.deltaUpdateGroupEventRSVPStatus;return m(u)}else if(t.deltaPageThreadFollowUpData){return p(t.deltaPageThreadFollowUpData)}else if(t.deltaChangeViewerStatus){return k(t.deltaChangeViewerStatus)}else return o(t);}function k(q){var r=q.actorFbid,s=q.canViewerReply,t=q.reason,u=q.threadKey,v=c('MercuryIDs').getParticipantIDFromUserID(u.otherUserFbId);return {action_type:c('MercuryActionType').BLOCK_STATUS_CHANGED,actorFbid:r,canViewerReply:s,reason:t,message_blocked_ids:[v],other_user_fbid:u.otherUserFbId.toString()}}function l(q){var r=q.messageId,s=q.offlineThreadingId,t=q.reaction,u=q.senderId,v=q.userId,w=q.threadKey.threadFbId||q.threadKey.otherUserFbId;return {action_type:c('MercuryActionType').REACTION_UPDATE,messageId:r,offlineThreadingId:s,reaction:t,senderId:u,thread_fbid:w.toString(),userId:v}}function m(q){var r=q.threadKey&&q.threadKey.threadFbId;if(!r)return null;var s=q.actorFbId,t=q.rsvpStatus;if(!s)return null;return {action_type:c('MercuryActionType').EVENT_RSVP_CHANGED,thread_fbid:r.toString(),actor_fbid:s.toString(),rsvp_status:t}}function n(q){var r=q.threadKey;if(!r)return null;var s=r.threadFbId||r.otherUserFbId;if(!s)return null;if(!q.messageLiveLocations||q.messageLiveLocations.length!==1)return null;var t=q.messageLiveLocations[0],u=t.expirationTime,v=t.stopReason!=null||Date.now()/c('DateConsts').MS_PER_SEC>u,w=function aa(ba){return ba/Math.pow(10,i)},x=t.coordinate?{latitude:w(t.coordinate.latitude),longitude:w(t.coordinate.longitude)}:null,y=null;if(t.destination)y={latitude:w(t.destination.latitude),longitude:w(t.destination.longitude),label:t.destination.label};var z=null;switch(t.stopReason){case c('MessageLiveLocationClientSyncProtocolStopReason').EXPIRED:z=h.EXPIRED;break;case c('MessageLiveLocationClientSyncProtocolStopReason').CANCELED:z=h.CANCELED;break;case c('MessageLiveLocationClientSyncProtocolStopReason').ARRIVED:z=h.ARRIVED;break;}return {action_type:c('MercuryActionType').LIVE_LOCATION_UPDATE,thread_fbid:s.toString(),messageId:t.messageId,liveLocation:{live_location_id:t.id.toString(),is_expired:v,expiration_time:u,sender:{id:t.senderId.toString()},coordinate:x,location_title:t.locationTitle,sender_destination:y,stop_reason:z}}}function o(q){var r=q&&q.deltaPaymentPinProtectionStatusData,s=r&&r.threadKey&&r.threadKey.otherUserFbId,t=r&&r.isPinProtected;if(!s)return null;var u=s.toString();return {action_type:c('MercuryActionType').IS_PIN_PROTECTED,thread_fbid:u,is_pin_protected:t}}function p(q){var r=q.threadKey.otherUserFbId;return {action_type:c('MercuryActionType').UPDATE_COMM_STATUS,comm_status:q.isFollowUp?c('PageCommItemStatus').FOLLOW_UP:c('PageCommItemStatus').TODO,thread_fbid:r.toString()}}f.exports={transform:j}}),null);
__d('MercurySyncDeliveryReceiptTransformer',[],(function a(b,c,d,e,f,g){'use strict';function h(i){return {delivery_receipts:[{other_user_fbid:i.threadKey.otherUserFbId?i.threadKey.otherUserFbId:'',thread_fbid:i.threadKey.threadFbId?i.threadKey.threadFbId:'',time:parseInt(i.deliveredWatermarkTimestampMs,10)}]}}f.exports={transform:h}}),null);
__d('MercurySyncMarkFolderChangeTransformer',['MercuryActionType','MessagingTag'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').CHANGE_FOLDER,other_user_fbid:i.threadKey.otherUserFbId,new_folder:c('MessagingTag').IRIS_MAPPING[i.folder]}}f.exports={transform:h}}),null);
__d('MercurySyncMarkFolderSeenTransformer',['MercuryGlobalActionType','MessagingTag'],(function a(b,c,d,e,f,g){'use strict';function h(i){return i.folders.map(function(j){return {action_type:c('MercuryGlobalActionType').MARK_ALL_SEEN,folder:c('MessagingTag').IRIS_MAPPING[j],timestamp:parseInt(i.timestamp,10)}})}f.exports={transform:h}}),null);
__d('MercurySyncMarkReadTransformer',['MercuryActionType','MercuryGlobalActionType','MessagingTag'],(function a(b,c,d,e,f,g){'use strict';function h(i){if(i.folders&&i.folders.length>0)return i.folders.map(function(j){return {action_type:c('MercuryGlobalActionType').MARK_ALL_READ,action_id:null,folder:c('MessagingTag').IRIS_MAPPING[j],timestamp:parseInt(i.watermarkTimestamp,10)}});return i.threadKeys.map(function(j){return {action_type:c('MercuryActionType').CHANGE_READ_STATUS,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId,mark_as_read:true,timestamp:parseInt(i.watermarkTimestamp,10),folder:c('MessagingTag').INBOX}})}f.exports={transform:h}}),null);
__d('MercurySyncMarkUnreadTransformer',['MercuryActionType','MessagingTag'],(function a(b,c,d,e,f,g){'use strict';function h(i){return i.threadKeys.map(function(j){return {action_type:c('MercuryActionType').CHANGE_READ_STATUS,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId,mark_as_read:false,timestamp:parseInt(i.watermarkTimestamp,10),folder:c('MessagingTag').INBOX}})}f.exports={transform:h}}),null);
__d('MercurySyncMessageDeleteTransformer',['MercuryActionType'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').DELETE_MESSAGES,message_ids:i.messageIds,other_user_fbid:i.threadKey.otherUserFbId,thread_fbid:i.threadKey.threadFbId}}f.exports={transform:h}}),null);
__d("PagesMessagingEventType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FLAG:1,CREATE_ADMIN_NOTE:2,PRIORITY_UPDATE:3})}),null);
__d('MercurySyncPagesManagerEventTransformer',['MercuryActionType','PagesMessagingEventType'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j=JSON.parse(i.jsonBlob),k=j&&j.type;if(!k)return undefined;switch(k){case c('PagesMessagingEventType').FLAG:var l=!!(j&&j.flagData&&j.flagData.state),m={action_type:c('MercuryActionType').CHANGE_FLAG,mark_as_flag:l,other_user_fbid:i.threadKey.otherUserFbId,thread_fbid:i.threadKey.threadFbId};return m;default:return undefined;}}f.exports={transform:h}}),null);
__d('MercurySyncParticipantLeftGroupThreadTransformer',['MercuryActionType','MercuryIDs','MercuryLogMessageType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercurySyncNewMessageTransformer').transform(i,j);k.action_type=c('MercuryActionType').LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={removed_participants:[c('MercuryIDs').getParticipantIDFromUserID(j.leftParticipantFbId)]};k.log_message_type=c('MercuryLogMessageType').UNSUBSCRIBE;return k}f.exports={transform:h}}),null);
__d('MercurySyncParticipantsAddedToGroupThreadTransformer',['MercuryActionType','MercuryIDs','MercuryLogMessageType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercurySyncNewMessageTransformer').transform(i,j);k.action_type=c('MercuryActionType').LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={added_participants:j.addedParticipants.map(function(l){return c('MercuryIDs').getParticipantIDFromUserID(l.userFbId)})};k.log_message_type=c('MercuryLogMessageType').SUBSCRIBE;return k}f.exports={transform:h}}),null);
__d('MercurySyncRTCEventLogTransformer',['MercuryActionType','MercuryIDs','MercuryLogMessageType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercurySyncNewMessageTransformer').transform(i,j),l=j.messageMetadata.actorFbId,m=l===i?j.messageMetadata.threadKey.otherUserFbId:i,n=j.eventType==='VOICE_EVENT'?c('MercuryLogMessageType').PHONE_CALL:c('MercuryLogMessageType').VIDEO_CALL;k.action_type=c('MercuryActionType').LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={answered:j.duration>0,callee:c('MercuryIDs').getParticipantIDFromUserID(m),caller:c('MercuryIDs').getParticipantIDFromUserID(l)};k.log_message_type=n;return k}f.exports={transform:h}}),null);
__d('MercurySyncReadReceiptTransformer',[],(function a(b,c,d,e,f,g){'use strict';function h(i){var j={watermark:parseInt(i.watermarkTimestampMs,10),action:parseInt(i.actionTimestampMs,10)},k=i.threadKey.otherUserFbId||i.actorFbId,l=i.threadKey.otherUserFbId||i.threadKey.threadFbId,m={roger:{}};m.roger[l]={};m.roger[l][k]=j;return m}f.exports={transform:h}}),null);
__d('MercurySyncReplaceMessageTransformer',['MercuryActionType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){j=Object.assign({},j.newMessage,j);return Object.assign(c('MercurySyncNewMessageTransformer').transform(i,j),{action_type:c('MercuryActionType').REPLACE_MESSAGE,replaced_message_id:j.replacedMessageId})}f.exports={transform:h}}),null);
__d('MercurySyncRtcCallDataTransformer',['MercuryActionType'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j=i.messageMetadata.threadKey&&i.messageMetadata.threadKey.threadFbId?i.messageMetadata.threadKey.threadFbId.toString():undefined,k=i.initiator&&i.initiator.userFbId?i.initiator.userFbId.toString():undefined;return {action_type:c('MercuryActionType').UPDATE_RTC_CALL_DATA,thread_fbid:j,call_state:i.callState,server_info_data:i.serverInfoData,initiator_fbid:k}}f.exports={transform:h}}),null);
__d("MessagingThreadAction",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ACTION_INVALID:"ACTION_INVALID",ACTION_ARCHIVED:"ACTION_ARCHIVED",ACTION_UNARCHIVED:"ACTION_UNARCHIVED"})}),null);
__d('MercurySyncThreadActionTransformer',['MercuryActionType','MessagingThreadAction'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j={action_type:c('MercuryActionType').CHANGE_ARCHIVED_STATUS,thread_fbid:i.threadKey.threadFbId,other_user_fbid:i.threadKey.otherUserFbId,archived:i.action===c('MessagingThreadAction').ACTION_ARCHIVED};return j}f.exports={transform:h}}),null);
__d('MercurySyncThreadAdminsAddToGroupTransformer',['MercuryActionType','MercuryIDs'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').ADD_GROUP_ADMINS,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,added_admin_ids:i.addedAdmins.map(function(j){return c('MercuryIDs').getParticipantIDFromUserID(j.userFbId)})}}f.exports={transform:h}}),null);
__d('MercurySyncThreadAdminsRemovedFromGroupTransformer',['MercuryActionType','MercuryIDs'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').REMOVE_GROUP_ADMINS,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,removed_admin_ids:i.removedAdminFbIds.map(function(j){return c('MercuryIDs').getParticipantIDFromUserID(j)})}}f.exports={transform:h}}),null);
__d('MercurySyncThreadApprovalModeTransformer',['MercuryActionType','MessengerApprovalModeTypes'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').APPROVAL_MODE,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,approval_mode:c('MessengerApprovalModeTypes')[i.mode]}}f.exports={transform:h}}),null);
__d("MessengerApprovalQueueTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({REQUESTED:"REQUESTED",REMOVED:"REMOVED"})}),null);
__d('MercurySyncThreadApprovalQueueTransformer',['MercuryActionType','MercuryIDs','MessengerApprovalQueueTypes'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j=c('MercuryIDs').getParticipantIDFromUserID(i.recipientFbId);return {action_type:c('MercuryActionType').APPROVAL_QUEUE,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,removed_id:i.action===c('MessengerApprovalQueueTypes').REMOVED?j:null,added_id:i.action===c('MessengerApprovalQueueTypes').REQUESTED?j:null}}f.exports={transform:h}}),null);
__d('MercurySyncThreadDeleteTransformer',['MercuryActionType'],(function a(b,c,d,e,f,g){'use strict';function h(i){return i.threadKeys.map(function(j){return {action_type:c('MercuryActionType').DELETE_THREAD,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId}})}f.exports={transform:h}}),null);
__d('MercurySyncThreadJoinableModeTransformer',['MercuryActionType','MessengerJoinableModeType'],(function a(b,c,d,e,f,g){'use strict';function h(i){return {action_type:c('MercuryActionType').JOINABLE_MODE,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,joinable_mode:{mode:c('MessengerJoinableModeType')[i.mode],link:i.link}}}f.exports={transform:h}}),null);
__d('MercurySyncThreadMuteSettingsTransformer',['MercuryActionType'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j={action_type:c('MercuryActionType').CHANGE_MUTE_SETTINGS,thread_fbid:i.threadKey.threadFbId,other_user_fbid:i.threadKey.otherUserFbId,mute_until:parseInt(i.expireTime,10)};return j}f.exports={transform:h}}),null);
__d('MercurySyncThreadNameTransformer',['MercuryActionType','MercuryLogMessageType','MercurySyncNewMessageTransformer'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercurySyncNewMessageTransformer').transform(i,j);k.action_type=c('MercuryActionType').LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={name:j.name};k.log_message_type=c('MercuryLogMessageType').THREAD_NAME;return k}f.exports={transform:h}}),null);
__d('MercurySyncDispatcher',['MercuryDelayedDispatcher','MercuryGlobalActionType','MercuryPayloadSource','MercuryServerPayloadPreprocessor','MercurySyncThreadAdminsAddToGroupTransformer','MercurySyncThreadAdminsRemovedFromGroupTransformer','MercurySyncAdminTextMessageTransformer','MercurySyncClientPayloadTransformer','MercurySyncDeliveryReceiptTransformer','MercurySyncMarkFolderSeenTransformer','MercurySyncMarkReadTransformer','MercurySyncMarkUnreadTransformer','MercurySyncMessageDeleteTransformer','MercurySyncNewMessageTransformer','MercurySyncReadReceiptTransformer','MercurySyncPagesManagerEventTransformer','MercurySyncParticipantLeftGroupThreadTransformer','MercurySyncParticipantsAddedToGroupThreadTransformer','MercurySyncRTCEventLogTransformer','MercurySyncThreadDeleteTransformer','MercurySyncMarkFolderChangeTransformer','MercurySyncThreadMuteSettingsTransformer','MercurySyncThreadNameTransformer','MercurySyncThreadActionTransformer','MercurySyncReplaceMessageTransformer','MercurySyncThreadJoinableModeTransformer','MercurySyncThreadApprovalModeTransformer','MercurySyncThreadApprovalQueueTransformer','MercurySyncRtcCallDataTransformer','MercurySyncDeltaTypes','MercurySingletonProvider','MontageActions'],(function a(b,c,d,e,f,g){'use strict';var h='FOLDER_MONTAGE';i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercurySyncDispatcher1=k;this.$MercurySyncDispatcher2=c('MercuryDelayedDispatcher').getForFBID(this.$MercurySyncDispatcher1);this.$MercurySyncDispatcher3=c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercurySyncDispatcher1)}i.prototype.process=function(k){var l=void 0,m=void 0;switch(k['class']){case c('MercurySyncDeltaTypes').NewMessage:l=c('MercurySyncNewMessageTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ReplaceMessage:l=c('MercurySyncReplaceMessageTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').DeliveryReceipt:l=c('MercurySyncDeliveryReceiptTransformer').transform(k);this.$MercurySyncDispatcher3.handleUpdate(l);break;case c('MercurySyncDeltaTypes').MarkRead:l=c('MercurySyncMarkReadTransformer').transform(k);var n=[],o=[];l.forEach(function(p){if(p.action_type===c('MercuryGlobalActionType').MARK_ALL_READ){n.push(p)}else o.push(p);});n.length&&this.$MercurySyncDispatcher5(n);o.length&&this.$MercurySyncDispatcher6(o);break;case c('MercurySyncDeltaTypes').MarkUnread:l=c('MercurySyncMarkUnreadTransformer').transform(k);this.$MercurySyncDispatcher6(l);break;case c('MercurySyncDeltaTypes').ParticipantLeftGroupThread:l=c('MercurySyncParticipantLeftGroupThreadTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ParticipantsAddedToGroupThread:l=c('MercurySyncParticipantsAddedToGroupThreadTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').RTCEventLog:l=c('MercurySyncRTCEventLogTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ThreadName:l=c('MercurySyncThreadNameTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ReadReceipt:l=c('MercurySyncReadReceiptTransformer').transform(k);this.$MercurySyncDispatcher3.handleUpdate(l);break;case c('MercurySyncDeltaTypes').AdminTextMessage:l=c('MercurySyncAdminTextMessageTransformer').transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').MessageDelete:m=k.threadKey.threadFbId;if(m&&k.folder&&k.folder===h){c('MontageActions').requestUpdate(m)}else{l=c('MercurySyncMessageDeleteTransformer').transform(k);this.$MercurySyncDispatcher4(l)}break;case c('MercurySyncDeltaTypes').ThreadAction:l=c('MercurySyncThreadActionTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ThreadDelete:l=c('MercurySyncThreadDeleteTransformer').transform(k);this.$MercurySyncDispatcher6(l);break;case c('MercurySyncDeltaTypes').AdminAddedToGroupThread:l=c('MercurySyncThreadAdminsAddToGroupTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').AdminRemovedFromGroupThread:l=c('MercurySyncThreadAdminsRemovedFromGroupTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ThreadMuteSettings:l=c('MercurySyncThreadMuteSettingsTransformer').transform(k);this.$MercurySyncDispatcher6([l]);break;case c('MercurySyncDeltaTypes').PagesManagerEvent:l=c('MercurySyncPagesManagerEventTransformer').transform(k);if(!l)return;this.$MercurySyncDispatcher6([l]);break;case c('MercurySyncDeltaTypes').JoinableMode:l=c('MercurySyncThreadJoinableModeTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ApprovalMode:l=c('MercurySyncThreadApprovalModeTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ApprovalQueue:l=c('MercurySyncThreadApprovalQueueTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').ClientPayload:l=c('MercurySyncClientPayloadTransformer').transform(k);if(!l)return;this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').GenieMessage:l=c('MercurySyncNewMessageTransformer').transform(this.$MercurySyncDispatcher1,k.deltaNewMessage);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').MontageMessage:m=k.newMessage.messageMetadata.actorFbId;if(m)c('MontageActions').requestUpdate(m);break;case c('MercurySyncDeltaTypes').RtcCallData:l=c('MercurySyncRtcCallDataTransformer').transform(k);this.$MercurySyncDispatcher4(l);break;case c('MercurySyncDeltaTypes').MarkFolderSeen:l=c('MercurySyncMarkFolderSeenTransformer').transform(k);this.$MercurySyncDispatcher5(l);break;case c('MercurySyncDeltaTypes').ThreadFolder:l=c('MercurySyncMarkFolderChangeTransformer').transform(k);this.$MercurySyncDispatcher6([l]);break;default:break;}};i.prototype.$MercurySyncDispatcher4=function(k){var l=k.other_user_fbid||k.thread_fbid;this.$MercurySyncDispatcher2.handleUpdateWaitForThread({actions:[k],payload_source:c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE},l)};i.prototype.$MercurySyncDispatcher5=function(k){this.$MercurySyncDispatcher3.handleUpdate({global_actions:k,payload_source:c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE})};i.prototype.$MercurySyncDispatcher6=function(k){this.$MercurySyncDispatcher3.handleUpdate({actions:k,payload_source:c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE})};var j=new (c('MercurySingletonProvider'))(i);f.exports=i}),null);
__d('MercurySyncDataFetcherImpl',['errorCode','Promise','AsyncRequest','AsyncResponse','MessagingConfig','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('MessagingConfig').syncFetchRequestTimeoutMs;function j(l){return new (c('Promise'))(function(m,n){k(l,m,n,0)})}function k(l,m,n,o){if(o>c('MessagingConfig').syncFetchRetries){n();return}var p=o===0?0:c('MessagingConfig').syncFetchInitialTimeoutMs*Math.pow(c('MessagingConfig').syncFetchTimeoutMultiplier,o);c('setTimeoutAcrossTransitions')(function(){var q=false,r=function s(t){if(q)return;q=true;if(t instanceof c('AsyncResponse'))if(t.error===1357001||t.error===1340004||t.error===1373034){n(true);return}k(l,m,n,o+1)};new (c('AsyncRequest'))().setURI(l).setHandler(function(s){q=true;m(s)}).setErrorHandler(r).setTimeoutHandler(i,r).setAllowCrossPageTransition(true).send()},p)}f.exports={fetch:j}}),null);
__d('MercurySyncDataFetcher',['Promise','LogHistory','MessagingConfig','MercurySyncDataFetcherImpl','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g){'use strict';var h=c('LogHistory').getInstance('mercury_sync_data_fetcher');function i(){var l=0;for(var m=0;m<c('MessagingConfig').syncFetchRetries;m++){var n=m===0?0:c('MessagingConfig').syncFetchInitialTimeoutMs*Math.pow(c('MessagingConfig').syncFetchTimeoutMultiplier,m);l+=n+c('MessagingConfig').syncFetchRequestTimeoutMs}return l}var j=i();function k(l){return new (c('Promise'))(function(m,n){var o=function q(r){h.error('fetch_timeout',JSON.stringify({timeout:j,uri:l.toString()}));n(r)},p=c('setTimeoutAcrossTransitions')(o,j);c('MercurySyncDataFetcherImpl').fetch(l).done(function(){clearTimeout(p);m.apply(undefined,arguments)},o)})}f.exports={fetch:k,getMaxTimeoutMs:i}}),null);
__d("XMercuryFetchMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/mercury\/fetch_message\/",{other_user_or_thread_fbid:{type:"Int",required:true},mid:{type:"String",required:true}})}),null);
__d("XMercuryInvalidateGlobalStateController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/mercury\/invalidate_global_state\/",{cachius_min_seq_id:{type:"Int"}})}),null);
__d("XMercuryInvalidateThreadStateController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/mercury\/invalidate_thread_state\/",{other_user_or_thread_fbid:{type:"Int",required:true},num_messages:{type:"Int",required:true}})}),null);
__d('MercurySyncDFFDataFetcher',['Promise','ActorURI','AsyncRequest','MercuryConfig','MercuryMessages','MercuryThreads','MercuryThreadIDMap','MercurySingletonProvider','MercurySyncDataFetcher','XMercuryFetchMessageController','XMercuryInvalidateGlobalStateController','XMercuryInvalidateThreadStateController'],(function a(b,c,d,e,f,g){'use strict';function h(j){this.$MercurySyncDFFDataFetcher1=j;this.__messages=c('MercuryMessages').getForFBID(this.$MercurySyncDFFDataFetcher1);this.__threads=c('MercuryThreads').getForFBID(this.$MercurySyncDFFDataFetcher1);this.__threadIDMap=c('MercuryThreadIDMap').getForFBID(this.$MercurySyncDFFDataFetcher1)}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.fetchInvalidateGlobalState=function(j){var k=c('XMercuryInvalidateGlobalStateController').getURIBuilder();if(c('MercuryConfig').MessengerCachiusUseClientSeqIDWWW)k.setInt('cachius_min_seq_id',j);var l=k.getURI(),m=c('ActorURI').create(l,this.$MercurySyncDFFDataFetcher1);return c('MercurySyncDataFetcher').fetch(m)};h.prototype.fetchInvalidateThreadState=function(j,k){var l=11,m=3,n=j||k,o=this.__threadIDMap.getClientIDFromServerIDNow(n);if(!o)return c('Promise').resolve({getPayload:function s(){return {}}});var p=m+this.__messages.getCurrentlyLoadedMessages(o).length,q=c('XMercuryInvalidateThreadStateController').getURIBuilder().setInt('other_user_or_thread_fbid',n).setInt('num_messages',Math.max(p,l)).getURI(),r=c('ActorURI').create(q,this.$MercurySyncDFFDataFetcher1);return c('MercurySyncDataFetcher').fetch(r)};h.prototype.fetchInvalidateMessage=function(j,k,l){var m=c('XMercuryFetchMessageController').getURIBuilder().setInt('other_user_or_thread_fbid',j||k).setString('mid',l).getURI(),n=c('ActorURI').create(m,this.$MercurySyncDFFDataFetcher1);return c('MercurySyncDataFetcher').fetch(n)};var i=new (c('MercurySingletonProvider'))(h);f.exports=h}),null);
__d('MercurySyncForcedFetchHandler',['Promise','MercurySingletonProvider','MercurySyncDFFDataFetcher','MercuryMessages','MercuryThreadIDMap'],(function a(b,c,d,e,f,g){'use strict';function h(k){return {getPayload:function l(){return {sequence_id:k}}}}i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercurySyncForcedFetchHandler1=k;this.$MercurySyncForcedFetchHandler2=c('MercuryMessages').getForFBID(this.$MercurySyncForcedFetchHandler1);this.$MercurySyncForcedFetchHandler3=c('MercuryThreadIDMap').getForFBID(this.$MercurySyncForcedFetchHandler1);this.$MercurySyncForcedFetchHandler4=c('MercurySyncDFFDataFetcher').getForFBID(this.$MercurySyncForcedFetchHandler1)}i.prototype.processMessageDFF=function(k,l,m,n){if(n){var o=l.otherUserFbId!==undefined?l.otherUserFbId.toString():l.threadFbId.toString(),p=this.$MercurySyncForcedFetchHandler3.getClientIDFromServerIDNow(o);if(p===undefined)return c('Promise').resolve(h(k));var q=this.$MercurySyncForcedFetchHandler2.getMessagesFromIDs([m]);if(q.length===0)return c('Promise').resolve(h(k));}return this.$MercurySyncForcedFetchHandler4.fetchInvalidateMessage(l.otherUserFbId,l.threadFbId,m)};i.prototype.processThreadDFF=function(k,l,m){if(m){var n=l.otherUserFbId!==undefined?l.otherUserFbId.toString():l.threadFbId.toString(),o=this.$MercurySyncForcedFetchHandler3.getClientIDFromServerIDNow(n);if(o===undefined)return c('Promise').resolve(h(k));}return this.$MercurySyncForcedFetchHandler4.fetchInvalidateThreadState(l.otherUserFbId,l.threadFbId)};i.prototype.processGlobalDFF=function(k){return this.$MercurySyncForcedFetchHandler4.fetchInvalidateGlobalState(k)};var j=new (c('MercurySingletonProvider'))(i);f.exports=i}),null);
__d("MercurySyncTopicType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DELTA:"delta",DELTAFLOW:"deltaflow",DELTAFLOWREJECT:"deltaflowreject"})}),null);
__d('MercurySyncDeltaHandler',['invariant','Promise','Arbiter','AsyncResponse','Bootloader','ChannelConstants','ChatReliabilityInstrumentation','CurrentUser','FBID','LogHistory','MercuryConfig','MessagingConfig','MercuryDelayedDispatcher','MercuryPayloadSource','MercurySyncChannelMonitor','MercurySyncConstants','MercurySyncDeltaHolder','MercurySyncDeltaTypes','MercurySyncDispatcher','MercurySyncForcedFetchHandler','MercurySyncHolesTypedLogger','MercuryServerPayloadPreprocessor','MercurySyncTopicType','MercurySingletonProvider','MercuryThreadlistConstants'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('LogHistory').getInstance('mercury_sync_delta_handler'),j=c('MessagingConfig').syncFetchRetries||0;k.getForFBID=function(m){return l.getForFBID(m)};k.get=function(){return l.get()};function k(m){this.$MercurySyncDeltaHandler1=m;this.$MercurySyncDeltaHandler2=c('MercurySyncDispatcher').getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler3=c('MercurySyncForcedFetchHandler').getForFBID(this.$MercurySyncDeltaHandler1);this.__payloadPreprocessor=c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercurySyncDeltaHandler1);this.__delayedDispatcher=c('MercuryDelayedDispatcher').getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler4=c('MercurySyncDeltaHolder').getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler5=false;this.$MercurySyncDeltaHandler11=c('MercurySyncChannelMonitor').getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler6=[];this.$MercurySyncDeltaHandler13=0;i.debug('constructor',JSON.stringify({fbid:this.$MercurySyncDeltaHandler1}));c('Arbiter').subscribe('MercurySyncDeltaHandler/initSeqID',function(n,o){i.debug('initSeqID',JSON.stringify(o));var p=o&&o.seqID,q=o&&o.fbid;if(!q)return;if(q!==this.$MercurySyncDeltaHandler1)return;if(p){this.$MercurySyncDeltaHandler4.updateLastSeqID(p)}else this.$MercurySyncDeltaHandler4.updateLastSeqID(0);this.$MercurySyncDeltaHandler15();this.$MercurySyncDeltaHandler8=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('deltaflow'),function(r,s){if(!this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler15();}.bind(this))}.bind(this))}k.prototype.$MercurySyncDeltaHandler15=function(){i.debug('setUpSubscriptionsToRealTimeUpdates',JSON.stringify({fbid:this.$MercurySyncDeltaHandler1}));if(c('MercuryConfig').USSE){this.$MercurySyncDeltaHandler7=c('Arbiter').subscribe('sse-delta',function(m,n){var o=n.seqID,p=n.delta;this.$MercurySyncDeltaHandler16(o,c('MercurySyncTopicType').DELTA);this.$MercurySyncDeltaHandler17(o,p);this.$MercurySyncDeltaHandler4.push(o,p);this.$MercurySyncDeltaHandler18()}.bind(this))}else this.$MercurySyncDeltaHandler7=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('delta'),function(m,n){var o=n&&n.obj&&n.obj.queue;if(o)if(o.toString()!==this.$MercurySyncDeltaHandler1)return;var p=n&&n.obj&&n.obj.delta,q=n&&n.obj&&n.obj.iseq;if(!p||!q)return;this.$MercurySyncDeltaHandler16(q,c('MercurySyncTopicType').DELTA);this.$MercurySyncDeltaHandler17(q,p);this.$MercurySyncDeltaHandler4.push(q,p);this.$MercurySyncDeltaHandler18()}.bind(this));this.$MercurySyncDeltaHandler12=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('deltaflowreject'),function(m,n){var o=n&&n.obj&&n.obj.queue;if(o)if(o.toString()!==this.$MercurySyncDeltaHandler1)return;if(this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler19();}.bind(this));this.$MercurySyncDeltaHandler9=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType(c('ChannelConstants').FAKE_DFF),function(m,n){var o=n&&n.obj&&n.obj.queue;if(o&&o.toString()!==this.$MercurySyncDeltaHandler1)return;var p=n&&n.obj&&n.obj.delta;if(!p)return;this.$MercurySyncDeltaHandler6.push(p);this.$MercurySyncDeltaHandler18()}.bind(this));this.$MercurySyncDeltaHandler11.setupSubscriptions();this.$MercurySyncDeltaHandler14=true};k.prototype.$MercurySyncDeltaHandler18=function(){if(this.$MercurySyncDeltaHandler5)return;if(this.$MercurySyncDeltaHandler6.length>0){var m=this.$MercurySyncDeltaHandler6.shift();this.$MercurySyncDeltaHandler20(this.$MercurySyncDeltaHandler4.getLastSeqID(),m);this.$MercurySyncDeltaHandler18()}var n=this.$MercurySyncDeltaHandler4.peek();if(!n)return;var o=n-this.$MercurySyncDeltaHandler4.getLastSeqID();if(o===1){var p=this.$MercurySyncDeltaHandler4.pop();if(!p)return;var q=p.seqID,r=p.delta;this.$MercurySyncDeltaHandler20(q,r);this.$MercurySyncDeltaHandler18()}else if(o>1){this.$MercurySyncDeltaHandler21()}else{this.$MercurySyncDeltaHandler4.pop();this.$MercurySyncDeltaHandler18()}};k.prototype.$MercurySyncDeltaHandler20=function(m,n){this.$MercurySyncDeltaHandler4.updateLastSeqID(m);if(n['class']===c('MercurySyncDeltaTypes').ForcedFetch){i.debug('DFF',JSON.stringify(n));if(n.threadKey!==undefined&&n.messageId===undefined){this.$MercurySyncDeltaHandler22(m,n)}else if(n.threadKey!==undefined&&n.messageId!==undefined){this.$MercurySyncDeltaHandler23(m,n)}else{c('ChatReliabilityInstrumentation').logDFF_DELTA_INIT(JSON.stringify(n));this.$MercurySyncDeltaHandler24(m)}}else this.$MercurySyncDeltaHandler2.process(n);};k.prototype.$MercurySyncDeltaHandler21=function(){var m=JSON.stringify({$MercurySyncDeltaHandler25:this.$MercurySyncDeltaHandler4.getLastSeqID(),nextSeqID:this.$MercurySyncDeltaHandler4.peek()});i.warn('hole',m);var n=this.$MercurySyncDeltaHandler4.peek();!!n||h(0);var o=n-1;c('ChatReliabilityInstrumentation').logDFF_HOLE_INIT(m);this.$MercurySyncDeltaHandler24(o)};k.prototype.$MercurySyncDeltaHandler26=function(m,n,o,p){!this.$MercurySyncDeltaHandler5||h(0);this.$MercurySyncDeltaHandler5=true;i.debug('_scheduleDataFetch:start',JSON.stringify({seqID:m}));n().done(function(q){i.debug('_scheduleDataFetch:success',JSON.stringify({seqID:m}));o(m,q);this.$MercurySyncDeltaHandler5=false;this.$MercurySyncDeltaHandler18()}.bind(this),function(q){i.error('_scheduleDataFetch:failure',JSON.stringify({seqID:m}));p(m,q);this.$MercurySyncDeltaHandler5=false;this.$MercurySyncDeltaHandler18()}.bind(this))};k.prototype.$MercurySyncDeltaHandler24=function(m){if(!c('CurrentUser').isLoggedInNow())return;this.$MercurySyncDeltaHandler26(undefined,function(){var n,o=this;if(c('MercuryConfig').SulfurDFF){var n=function(){var p={limit:c('MercuryThreadlistConstants').WEBMESSENGER_THREAD_COUNT+1,folder:'inbox',tags:['INBOX'],timestamp:null,offset:c('MercuryThreadlistConstants').RECENT_THREAD_OFFSET,filter:null,includeDeliveryReceipts:false,includeSeqID:true};return {v:new (c('Promise'))(function(q,r){c('Bootloader').loadModules(["messengerGraphQLThreadlistFetcherRe"],function(s){return s.fetchAll(this.$MercurySyncDeltaHandler1,[p],!c('FBID').isUser(this.$MercurySyncDeltaHandler1)).then(function(t){return q(new (c('AsyncResponse'))(null,babelHelpers['extends']({},t,{payload_source:c('MercuryPayloadSource').SERVER_INVALIDATE_GLOBAL_STATE})))},function(t){return r()})}.bind(this),'MercurySyncDeltaHandler')}.bind(o))}}();if(typeof n==="object")return n.v;}return this.$MercurySyncDeltaHandler3.processGlobalDFF(m)}.bind(this),function(n,o){var p=o.getPayload();this.__payloadPreprocessor.handleUpdate(p);if(p.sequence_id){i.debug('_initiateGlobalDFF:success',JSON.stringify({seqID:p.sequence_id}));this.$MercurySyncDeltaHandler4.updateLastSeqID(p.sequence_id)}this.$MercurySyncDeltaHandler13=0;c('Arbiter').inform(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE_RECOVER)}.bind(this),function(n,o){i.error('_initiateGlobalDFF:failure','');if(this.$MercurySyncDeltaHandler13>=j||o){if(this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler19();if(c('MercuryConfig').chatDFFUpdateSeqID)this.$MercurySyncDeltaHandler4.updateLastSeqID(m);}else{this.$MercurySyncDeltaHandler13++;c('Arbiter').inform(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE_RETRY);i.debug('_initiateGlobalDFF:retry','');this.$MercurySyncDeltaHandler5=false;this.$MercurySyncDeltaHandler24(m)}}.bind(this))};k.prototype.$MercurySyncDeltaHandler22=function(m,n){this.$MercurySyncDeltaHandler26(m,function(){return this.$MercurySyncDeltaHandler3.processThreadDFF(m,n.threadKey,n.isLazy)}.bind(this),function(o,p){this.__payloadPreprocessor.handleUpdate(p.getPayload());this.$MercurySyncDeltaHandler4.updateLastSeqID(o)}.bind(this),function(){i.error('_initiateThreadDFF:failure',JSON.stringify(n));var o=babelHelpers['extends']({},n);delete o.threadKey;this.$MercurySyncDeltaHandler4.updateLastSeqID(m-1);this.$MercurySyncDeltaHandler4.push(m,o)}.bind(this))};k.prototype.$MercurySyncDeltaHandler23=function(m,n){this.$MercurySyncDeltaHandler26(m,function(){return this.$MercurySyncDeltaHandler3.processMessageDFF(m,n.threadKey,n.messageId,n.isLazy)}.bind(this),function(o,p){var q=p.getPayload(),r=q.other_user_fbid?q.other_user_fbid:q.thread_fbid,s=[babelHelpers['extends']({},q)],t=c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:s,payload_source:t},r);this.$MercurySyncDeltaHandler4.updateLastSeqID(o)}.bind(this),function(){i.error('_initiateMessageDFF:failure',JSON.stringify(n));var o=babelHelpers['extends']({},n);delete o.messageId;this.$MercurySyncDeltaHandler4.updateLastSeqID(m-1);this.$MercurySyncDeltaHandler4.push(m,o)}.bind(this))};k.prototype.$MercurySyncDeltaHandler16=function(m,n){var o=m-this.$MercurySyncDeltaHandler4.getLastSeqID();if(o!==1&&o!==0){if(!c('MercuryConfig').WWWSyncHolesLogging)return;new (c('MercurySyncHolesTypedLogger'))().setSeqID(m).setDifference(o).setTopicType(n).log()}};k.prototype.$MercurySyncDeltaHandler17=function(m,n){switch(n['class']){case c('MercurySyncDeltaTypes').NewMessage:i.debug('message_delta',JSON.stringify({seqID:m,threadKey:n.messageMetadata.threadKey,messageId:n.messageMetadata.messageId}));break;case c('MercurySyncDeltaTypes').ReadReceipt:i.debug('read_receipt_delta',JSON.stringify({seqID:m,threadKey:n.threadKey,actionTimestampMs:n.actionTimestampMs,watermarkTimestampMs:n.watermarkTimestampMs}));break;case c('MercurySyncDeltaTypes').DeliveryReceipt:i.debug('delivery_receipt_delta',JSON.stringify({seqID:m,deliveredWatermarkTimestampMs:n.deliveredWatermarkTimestampMs,messageIds:n.messageIds}));break;}};k.prototype.$MercurySyncDeltaHandler19=function(){this.$MercurySyncDeltaHandler14=false;c('Arbiter').unsubscribe(this.$MercurySyncDeltaHandler7);c('Arbiter').unsubscribe(this.$MercurySyncDeltaHandler9);c('Arbiter').unsubscribe(this.$MercurySyncDeltaHandler12);this.$MercurySyncDeltaHandler11.killSubscriptions();c('Arbiter').inform(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE)};var l=new (c('MercurySingletonProvider'))(k);f.exports=k}),null);
__d('MercurySyncEnvironment',['Arbiter','ChannelInitialData','CurrentUser','MercurySyncDeltaHandler'],(function a(b,c,d,e,f,g){'use strict';function h(){if(!c('ChannelInitialData').channelConfig)return;c('MercurySyncDeltaHandler').get();c('Arbiter').inform('MercurySyncDeltaHandler/initSeqID',{fbid:c('CurrentUser').getAccountID(),seqID:c('ChannelInitialData').channelConfig.sequenceId})}f.exports={setUp:h}}),null);
__d('MercuryUnseenState',['MercuryFolders','KeyedCallbackManager','LogHistory','MercuryActionType','MercuryDispatcher','MercuryGlobalActionType','MercurySingletonProvider','MercuryThreadIDMap','MercuryThreadInfo','MercuryThreadlistConstants','MessagingTag','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','createObjectFrom','isEmpty'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadlistConstants').MAX_UNSEEN_COUNT,i='unseen_thread_hash',j='unseen_thread_list',k=c('LogHistory').getInstance('mercury_unseen_state');l.getForFBID=function(n){return m.getForFBID(n)};l.get=function(){return m.get()};function l(n){this.$MercuryUnseenState2=n;this.$MercuryUnseenState7=c('MercuryServerRequests').getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState8=c('MercuryThreadIDMap').getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState10=c('MercuryThreads').getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState9=c('MercuryThreadInformer').getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState1=c('MercuryDispatcher').getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState3=0;this.$MercuryUnseenState4=0;this.$MercuryUnseenState5=false;this.$MercuryUnseenState6=false;this.$MercuryUnseenState11=new (c('KeyedCallbackManager'))();this.$MercuryUnseenState1.subscribe('update-unseen',function(o,p){this.$MercuryUnseenState12(p)}.bind(this));this.$MercuryUnseenState1.subscribe('update-thread-ids',function(o,p){this.$MercuryUnseenState13(p)}.bind(this))}l.prototype.getUnseenCount=function(){if(this.exceedsMaxCount()){k.error('unguarded_unseen_count_fetch','{}');return 0}return this.$MercuryUnseenState14()};l.prototype.exceedsMaxCount=function(){return this.$MercuryUnseenState5||this.$MercuryUnseenState14()>h};l.prototype.markAsSeen=function(){var n=this.$MercuryUnseenState14();if(n===null){this.$MercuryUnseenState6=true}else if(n>0||this.$MercuryUnseenState5){this.$MercuryUnseenState7.markSeen();this.$MercuryUnseenState15(this.$MercuryUnseenState7.getLastActionTimestamp(),[])}};l.prototype.$MercuryUnseenState16=function(n,o){var p;this.$MercuryUnseenState17((p={},p[n]=0,p),o)};l.prototype.$MercuryUnseenState18=function(n){this.$MercuryUnseenState11.setResource(i,n);this.$MercuryUnseenState11.setResource(j,Object.keys(n))};l.prototype.$MercuryUnseenState19=function(n){var o=this.$MercuryUnseenState11.executeOrEnqueue(i,n),p=this.$MercuryUnseenState11.getUnavailableResources(o);if(p.length)this.$MercuryUnseenState7.fetchUnseenThreadIDs();};l.prototype.$MercuryUnseenState20=function(){return this.$MercuryUnseenState11.getResource(i)};l.prototype.$MercuryUnseenState14=function(){var n=this.$MercuryUnseenState11.getResource(j);if(n){return n.length}else return this.$MercuryUnseenState3;};l.prototype.$MercuryUnseenState12=function(n){var o,p=this,q=this.$MercuryUnseenState21(n);if(n.unseen_thread_fbids){n.unseen_thread_fbids.forEach(function(r){if(r.folder!=c('MessagingTag').INBOX)return;var s=(r.thread_fbids||[]).concat(r.other_user_fbids||[]),t=this.$MercuryUnseenState22(s),u=q.seen_timestamp?q.seen_timestamp:this.$MercuryUnseenState4;this.$MercuryUnseenState15(u,t);if(q.unseen_count>h)this.$MercuryUnseenState5=true;}.bind(this))}else if(q.seen_timestamp!==undefined){this.$MercuryUnseenState4=q.seen_timestamp;if(q.unseen_count>h){this.$MercuryUnseenState5=true;this.$MercuryUnseenState18({})}else{this.$MercuryUnseenState3=q.unseen_count;if(this.$MercuryUnseenState3===0)this.$MercuryUnseenState18({});}}else{var o=function(){var r;(n.global_actions||[]).forEach(function(x){if(x.action_type===c('MercuryGlobalActionType').MARK_ALL_SEEN)this.$MercuryUnseenState15(x.timestamp,[]);}.bind(p));if(p.$MercuryUnseenState5)return {v:void 0};var s=n.actions;if(!s||!s.length)return {v:void 0};var t={},u={},v=function x(y){var z=s[y],aa=z.action_type,ba=z.other_user_fbid?z.other_user_fbid:z.thread_fbid,ca=z.thread_id?z.thread_id:ba;if(aa===c('MercuryActionType').MARK_THREAD_SEEN){p.$MercuryUnseenState16(ca,z.persistent);return 'continue'}if(!p.$MercuryUnseenState23(z))return 'continue';if(aa===c('MercuryActionType').USER_GENERATED_MESSAGE||aa===c('MercuryActionType').LOG_MESSAGE){var da=t[ca]?z.timestamp>t[ca]:false,ea=da||!t[ca];if(z.is_unread&&ea)p.$MercuryUnseenState10.getThreadMeta(ca,function(fa){if(!c('MercuryThreadInfo').isMuted(fa)&&!(fa&&fa.last_read_timestamp>=z.timestamp))t[ca]=z.timestamp;});}else if(aa===c('MercuryActionType').CHANGE_READ_STATUS&&z.mark_as_read)u[ca]=z.timestamp;};for(var w=0;w<s.length;w++){var r=v(w);if(r==='continue')continue;}p.$MercuryUnseenState24(t);p.$MercuryUnseenState17(u)}();if(typeof o==="object")return o.v;}if(this.$MercuryUnseenState6){this.$MercuryUnseenState6=false;this.markAsSeen()}};l.prototype.$MercuryUnseenState15=function(n,o){var p=this.$MercuryUnseenState20();if(p===undefined||n>this.$MercuryUnseenState4||this.$MercuryUnseenState5){this.$MercuryUnseenState4=n;o=o||[];if(o.length<=h)this.$MercuryUnseenState5=false;var q={},r=this.$MercuryUnseenState20();for(var s in r)if(r[s]!==true){var t=r[s];if(this.$MercuryUnseenState25(t))q[s]=t;}var u=Object.assign(c('createObjectFrom')(o,true),q);this.$MercuryUnseenState18(u);this.$MercuryUnseenState9.updatedUnseenState()}};l.prototype.$MercuryUnseenState24=function(n){if(this.$MercuryUnseenState5)return;var o={},p=false;for(var q in n){var r=n[q];if(this.$MercuryUnseenState25(r)){o[q]=r;p=true}}if(!p)return;this.$MercuryUnseenState19(function(s){for(var t in o){var u=o[t];if(!s[t]&&this.$MercuryUnseenState25(u))s[t]=o[t];}this.$MercuryUnseenState18(s);this.$MercuryUnseenState9.updatedUnseenState()}.bind(this))};l.prototype.$MercuryUnseenState17=function(n,o){if(!c('isEmpty')(n))this.$MercuryUnseenState19(function(p){var q=false;for(var r in n){var s=n[r],t=s>=p[r];if(p[r]&&(!s||t)){delete p[r];q=true}}if(q){this.$MercuryUnseenState18(p);this.$MercuryUnseenState9.updatedUnseenState();if(o&&this.$MercuryUnseenState14()===0)this.$MercuryUnseenState7.markSeen();}}.bind(this));};l.prototype.$MercuryUnseenState25=function(n){return n>this.$MercuryUnseenState4};l.prototype.$MercuryUnseenState22=function(n){return n.map(this.$MercuryUnseenState8.convertThreadIDIfAvailable,this.$MercuryUnseenState8)};l.prototype.$MercuryUnseenState13=function(n){var o=this.$MercuryUnseenState20();if(!o)return;for(var p in n){var q=n[p];if(o[p]){o[q]=o[p];delete o[p]}}this.$MercuryUnseenState18(o)};l.prototype.$MercuryUnseenState23=function(n){var o=n.thread_id?this.$MercuryUnseenState10.getThreadMetaNow(n.thread_id):null,p=o?c('MercuryFolders').getFromMeta(o):n.folder;return p===c('MessagingTag').INBOX||p===undefined};l.prototype.$MercuryUnseenState21=function(n){var o=n.message_counts||[];for(var p=0;p<o.length;p++)if(o[p].folder===c('MessagingTag').INBOX)return o[p];return {}};var m=new (c('MercurySingletonProvider'))(l);f.exports=l}),null);
__d('OmniMActions',['MessengerFluxReduceDispatcher','keyMirror','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({BAR_DISMISSED:null,BAR_DISPLAYED:null,BAR_DISAPPEARED:null,BAR_TIMED_OUT:null,MERCURY_DISPATCHED:null,FETCH_SUGGESTIONS:null,PREFS_UPDATED:null,SUGGESTION_CLICKED:null,SUGGESTION_COMPLETED:null,SUGGESTION_DISMISSED:null,SUGGESTION_DISPLAYED:null,SUGGESTION_DISAPPEARED:null,SUGGESTION_MODE_SET:null,SUGGESTIONS_DISMISSED_FOR_THREAD:null}),i='omnim',j={Types:h,Namespace:i,mercuryDispatched:function k(l,m){c('MessengerFluxReduceDispatcher').dispatch({type:h.MERCURY_DISPATCHED,namespace:i,mercuryType:l,data:m})},messageFetched:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.FETCH_SUGGESTIONS,namespace:i,threadID:l,message:m})})},suggestionClicked:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_CLICKED,namespace:i,threadID:l,option:m,source:n,position:o})},suggestionCompleted:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_COMPLETED,namespace:i,threadID:l,option:m,source:n,position:o})},suggestionDismissed:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISMISSED,namespace:i,threadID:l,option:m,source:n,position:o})},suggestionsDismissedForThread:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTIONS_DISMISSED_FOR_THREAD,namespace:i,threadID:l})},suggestionDisplayed:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISPLAYED,namespace:i,option:l,position:m})})},suggestionDisappeared:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISAPPEARED,namespace:i,option:l,position:m})})},prefsUpdated:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.PREFS_UPDATED,namespace:i,prefs:l})},suggestionModeSet:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_MODE_SET,namespace:i,mode:l})},barDismissed:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISMISSED,namespace:i,options:l})},barDisplayed:function k(l){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISPLAYED,namespace:i,options:l})})},barDisappeared:function k(l){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISAPPEARED,namespace:i,options:l})})},barTimedOut:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_TIMED_OUT,namespace:i,options:m,threadID:l})})}};f.exports=j}),null);
__d('OmniMHelpers',['MercuryConfig'],(function a(b,c,d,e,f,g){function h(i){if(!c('MercuryConfig').OmniMEditConfidenceThreshold)return 0;if(i&&i.has('suggestion_mode')){var j=i.get('suggestion_mode');return j!==null&&j!==undefined?j:1}return 3}f.exports={suggestionMode:h}}),null);
__d('MNOmniMConstants',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({OMNIM:null,QUICKREPLIES:null});f.exports=babelHelpers['extends']({},h,{SUGGESTION_MODES:['conservative','balanced','aggressive','muted']})}),null);
__d("OmniMActionType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CREATE_EVENT:1,LOCATION:2,PAYMENT:3,POLL:4,STICKER:5,TEXT:6,TRANSPORTATION:7,ORDER_FOOD:8,MAKE_RESERVATION:9,SCHEDULE_CALL:10,LIVE_LOCATION:11,VIDEO_CALL:12,VOICE_CALL:13,SAVE_CONTENT:14,PLAY_GAME:15,SHARE_CONTACT:16,SEND_PHOTO:17,CREATE_REMINDER_DEPRECATED:18,CREATE_REMINDER:19,MARKETPLACE_SAFE_LOCATION:20,VIEW_SAVED:21,CHAT_EXTENSION:22,DAY_CAMERA:23,CALENDAR:24,GIF:25,PAGE_PROFILE:26})}),null);
__d("OmniMDirectiveType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADD_ACTIONS:1,CLEAR_ACTIONS:2,ADD_RANGES:3,INVOKE_NATIVE_AGENT:4,MUTATE_FLOW_STATE:5})}),null);
__d("OmniMLoggerEvents",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({MESSAGE_ANALYZED:"omni_m_message_analyzed",INTENT_DETECTED:"omni_m_intent_detected",INTENT_HANDLED:"omni_m_intent_handled",SUGGESTION_GENERATED:"omni_m_suggestion_generated",SUGGESTIONS_FILTERED:"omni_m_suggestions_filtered",SUGGESTION_SENT:"omni_m_suggestion_sent",SUGGESTION_DISPLAYED:"omni_m_suggestion_displayed",SUGGESTION_CLICKED:"omni_m_suggestion_clicked",SUGGESTION_COMPLETED:"omni_m_suggestion_completed",SUGGESTION_DISMISSED:"omni_m_suggestion_dismissed",SUGGESTION_DISAPPEARED:"omni_m_suggestion_disappeared",BAR_DISMISSED:"omni_m_bar_dismissed",BAR_DISPLAYED:"omni_m_bar_displayed",BAR_DISAPPEARED:"omni_m_bar_disappeared",ORGANIC_CLICKED:"omni_m_organic_clicked",ORGANIC_COMPLETED:"omni_m_organic_completed",SETTINGS_ON:"omni_m_setting_turned_on",SETTINGS_OFF:"omni_m_setting_turned_off",CALENDAR_EVENT:"omni_m_calendar_event"})}),null);
__d('OmniMLogHelpers',['OmniMEventTypedLogger','MNOmniMConstants','OmniMLoggerEvents','CurrentUser'],(function a(b,c,d,e,f,g){function h(s){return c('MNOmniMConstants').SUGGESTION_MODES[s]}function i(s,t,u,v){new (c('OmniMEventTypedLogger'))().setEventName(s).setPosition(u+'').setMessageID(t.messageID).setPigeonID(t.suggestionID).setSuggestionMode(h(v)).setContextUserID(c('CurrentUser').getID()).setConfidence(Math.round(t.confidence*10000)).log()}function j(s,t,u){new (c('OmniMEventTypedLogger'))().setEventName(s).setSuggestionMode(h(u)).setContextUserID(c('CurrentUser').getID()).setSuggestionIds(t.map(function(v){return v.suggestionID})).log()}function k(s,t,u){i(c('OmniMLoggerEvents').SUGGESTION_DISPLAYED,s,t,u)}function l(s,t,u){i(c('OmniMLoggerEvents').SUGGESTION_DISAPPEARED,s,t,u)}function m(s,t,u){i(c('OmniMLoggerEvents').SUGGESTION_DISMISSED,s,t,u)}function n(s,t,u){i(c('OmniMLoggerEvents').SUGGESTION_CLICKED,s,t,u)}function o(s,t,u){i(c('OmniMLoggerEvents').SUGGESTION_COMPLETED,s,t,u)}function p(s,t){j(c('OmniMLoggerEvents').BAR_DISAPPEARED,s,t)}function q(s,t){j(c('OmniMLoggerEvents').BAR_DISMISSED,s,t)}function r(s,t){j(c('OmniMLoggerEvents').BAR_DISPLAYED,s,t)}f.exports={barDisappeared:p,barDisplayed:r,barDismissed:q,suggestionDisplayed:k,suggestionDisappeared:l,suggestionDismissed:m,suggestionClicked:n,suggestionCompleted:o}}),null);
__d("XMessagingOmniMSetPrefController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/messaging\/set_omnim_prefs\/",{})}),null);
__d('OmniMReducer',['AsyncRequest','immutable','MercuryActionType','MercuryConfig','MercuryIDs','MercuryPayloadSource','MNOmniMConstants','OmniMActions','OmniMActionType','OmniMDirectiveType','OmniMLogHelpers','P2PGKValues','XMessagingOmniMSetPrefController'],(function a(b,c,d,e,f,g){'use strict';var h,i=c('OmniMActions').Types,j=c('immutable').Set([c('MercuryActionType').SEND_MESSAGE,c('MercuryActionType').REPLACE_MESSAGE,c('MercuryActionType').USER_GENERATED_MESSAGE]),k=c('immutable').Set([c('MercuryActionType').SEND_MESSAGE,c('MercuryActionType').USER_GENERATED_MESSAGE]),l=2;function m(oa,pa){switch(oa.content_type){case 'text':return true;case 'location':if(pa===c('MNOmniMConstants').OMNIM)return c('MercuryConfig').OmniMLocationSuggestion;return true;case 'sticker':return c('MercuryConfig').MessengerStickerQuickReply;case 'ride_service':return c('MercuryConfig').MessengerRideServiceQuickReply;case 'p2p_payment':return c('P2PGKValues').P2PVisible&&c('MercuryConfig').MessengerP2PPaymentQuickReply;case 'open_camera':return c('MercuryConfig').MessengerOpenCameraQuickReply;case 'record_audio':return c('MercuryConfig').MessengerRecordAudioQuickReply;default:return false;}}function n(oa){return Array.isArray(oa)}function o(oa){if(!oa)return {};var pa=JSON.parse(oa)||{},qa=n(pa.quick_replies)?pa.quick_replies:[],ra=pa.m_directives;return {quickReplies:qa,directives:ra}}function p(oa){var pa=oa.other_user_fbid,qa=oa.thread_fbid;return pa?c('MercuryIDs').getThreadIDFromUserID(pa):c('MercuryIDs').getThreadIDFromThreadFBID(qa)}var q=c('immutable').Map((h={},h[c('OmniMActionType').CREATE_EVENT]='create_event',h[c('OmniMActionType').LOCATION]='location',h[c('OmniMActionType').PAYMENT]='p2p_payment',h[c('OmniMActionType').POLL]='poll',h[c('OmniMActionType').STICKER]='sticker',h[c('OmniMActionType').TEXT]='text',h[c('OmniMActionType').TRANSPORTATION]='ride_service',h[c('OmniMActionType').ORDER_FOOD]='order_food',h[c('OmniMActionType').MAKE_RESERVATION]='make_reservation',h[c('OmniMActionType').SCHEDULE_CALL]='schedule_call',h[c('OmniMActionType').LIVE_LOCATION]='live_location',h));function r(oa){var pa=oa.confidence,qa=oa.id,ra=oa.label,sa=oa.type,ta=oa.data,ua=oa.icon,va=oa.message_id,wa=oa.thread_key;return {content_type:q.get(sa+''),data:ta,image_url:ua,title:ra,confidence:pa,messageID:va,suggestionID:qa,threadID:p(wa),messageDepth:1}}function s(oa,pa){var qa=o(pa),ra=(qa.quickReplies||[]).filter(function(ta){return m(ta,c('MNOmniMConstants').QUICKREPLIES)}),sa=(qa.directives||[]).filter(function(ta){return ta.type===c('OmniMDirectiveType').ADD_ACTIONS}).map(function(ta){return ta.data.actions}).reduce(function(ta,ua){return ta.concat(ua)},[]).map(r).filter(function(ta){return m(ta,c('MNOmniMConstants').OMNIM)}).reduce(function(ta,ua){var va=ua.threadID;return ta.updateIn([va,'agentSuggestions'],[],function(wa){return wa.concat([ua])})},c('immutable').Map({}));return sa.setIn([oa,'quickReplies'],ra)}function t(oa){var pa=oa.content_type;Object.keys(oa.data||{}).sort().map(function(qa){pa+=''+qa+oa.data[qa]});return pa}function u(oa){var pa=c('immutable').Set(),qa=[];for(var ra=oa.length-1;ra>=0;ra--){var sa=oa[ra],ta=t(sa);if(!pa.has(ta)){pa=pa.add(ta);qa.unshift(sa)}}return qa}function v(oa){var pa=0;return oa.filter(function(qa){if(qa.content_type==='sticker'){if(pa>=l)return false;pa+=1}return true})}function w(oa,pa,qa,ra){var sa=oa.getIn(['threadMetadata',pa,'timestamp']);if(sa&&sa>ra)return oa;var ta=qa.agentSuggestions,ua=qa.quickReplies,va=(oa.getIn(['suggestionsByThread',pa])||{}).agentSuggestions||[],wa=ta||[];if(va.length)wa=v(wa);var xa=u(wa.concat(va));return oa.setIn(['threadMetadata',pa,'timestamp'],ra).setIn(['suggestionsByThread',pa],{agentSuggestions:xa,quickReplies:ua})}function x(oa,pa,qa,ra,sa){var ta=s(pa,ra);return ta.reduce(function(ua,va,wa){return w(ua,wa,va.toJS(),sa)},oa)}function y(oa){if(!oa)return null;var pa=oa.agentSuggestions,qa=(pa||[]).reduce(function(ra,sa){if(sa.messageDepth>=c('MercuryConfig').OmniMMessagesToLive)return ra;return ra.concat([babelHelpers['extends']({},sa,{messageDepth:sa.messageDepth+1})])},[]);return babelHelpers['extends']({},oa,{agentSuggestions:qa})}function z(oa,pa){var qa=pa.thread_id,ra=pa.message_id,sa=pa.platform_xmd,ta=pa.timestamp;if(k.has(pa.action_type))oa=oa.updateIn(['suggestionsByThread',qa],y);return x(oa,qa,ra,sa,ta)}function aa(oa,pa){if(pa.type!==i.MERCURY_DISPATCHED)return oa;var qa=pa.data;switch(pa.mercuryType){case 'update-messages':if(qa.payload_source!==c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE)return oa;return qa.actions.filter(function(ra){return j.has(ra.action_type)}).reduce(z,oa);case 'invalidate-thread-state':return oa.deleteIn(['suggestionsByThread',qa.threadID]).deleteIn(['threadMetadata',qa.threadID]);case 'invalidate-global-state':return oa.set('suggestionsByThread',c('immutable').Map()).set('threadMetadata',c('immutable').Map());}return oa}function ba(oa,pa){if(pa.type!==i.FETCH_SUGGESTIONS)return oa;var qa=pa.message,ra=pa.threadID;return x(oa,ra,qa.message_id,qa.platform_xmd,qa.timestamp)}function ca(oa){return oa.getIn(['prefs','suggestion_mode'],0)}function da(oa,pa){if(pa.type!==i.SUGGESTION_CLICKED)return oa;var qa=pa.option,ra=pa.position,sa=pa.source;if(sa===c('MNOmniMConstants').OMNIM)c('OmniMLogHelpers').suggestionClicked(qa,ra,ca(oa));return oa}function ea(oa,pa){if(pa.type!==i.SUGGESTION_COMPLETED)return oa;var qa=pa.threadID,ra=pa.option,sa=pa.position,ta=pa.source;if(ta===c('MNOmniMConstants').OMNIM)c('OmniMLogHelpers').suggestionCompleted(ra,sa,ca(oa));return oa.deleteIn(['suggestionsByThread',qa])}function fa(oa,pa){if(pa.type!==i.SUGGESTION_DISMISSED)return oa;var qa=pa.threadID,ra=pa.option,sa=pa.source,ta=pa.position;if(sa===c('MNOmniMConstants').OMNIM)c('OmniMLogHelpers').suggestionDismissed(ra,ta,ca(oa));var ua=oa.getIn(['suggestionsByThread',qa]);if(!ua||!ua.agentSuggestions)return oa;var va=ua.agentSuggestions.map(function(wa){if(wa.suggestionID===ra.suggestionID)return babelHelpers['extends']({},wa,{dismissed:true});return wa});return oa.setIn(['suggestionsByThread',qa],babelHelpers['extends']({},ua,{agentSuggestions:va}))}function ga(oa,pa){if(pa.type!==i.SUGGESTIONS_DISMISSED_FOR_THREAD)return oa;var qa=pa.threadID,ra=oa.getIn(['suggestionsByThread',qa]);if(!ra||!ra.agentSuggestions)return oa;c('OmniMLogHelpers').barDismissed(ra.agentSuggestions,ca(oa));var sa=ra.agentSuggestions.map(function(ta,ua){if(ta.dismissed)return ta;c('OmniMLogHelpers').suggestionDismissed(ta,ua,ca(oa));return babelHelpers['extends']({},ta,{dismissed:true})});return oa.setIn(['suggestionsByThread',qa],babelHelpers['extends']({},ra,{agentSuggestions:sa}))}function ha(oa,pa){if(pa.type!==i.PREFS_UPDATED)return oa;var qa=pa.prefs;return oa.updateIn(['prefs'],function(ra){return ra.merge(c('immutable').fromJS(qa))})}function ia(oa,pa){if(pa.type!==i.SUGGESTION_MODE_SET)return oa;var qa=pa.mode,ra=c('XMessagingOmniMSetPrefController').getURIBuilder().getURI();new (c('AsyncRequest'))(ra).setMethod('POST').setData({suggestion_mode:qa}).send();return oa.setIn(['prefs','suggestion_mode'],qa)}function ja(oa,pa){if(pa.type!==i.SUGGESTION_DISPLAYED)return oa;var qa=pa.option,ra=pa.position;if(!qa.dismissed)c('OmniMLogHelpers').suggestionDisplayed(qa,ra,ca(oa));return oa}function ka(oa,pa){if(pa.type!==i.SUGGESTION_DISAPPEARED)return oa;var qa=pa.option,ra=pa.position;if(!qa.dismissed)c('OmniMLogHelpers').suggestionDisappeared(qa,ra,ca(oa));return oa}function la(oa,pa){if(pa.type!==i.BAR_TIMED_OUT)return oa;var qa=pa.threadID,ra=pa.options;c('OmniMLogHelpers').barDisappeared(ra,ca(oa));return oa.deleteIn(['suggestionsByThread',qa])}function ma(oa,pa){if(pa.type!==i.BAR_DISAPPEARED)return oa;c('OmniMLogHelpers').barDisappeared(pa.options,ca(oa));return oa}function na(oa,pa){if(pa.type!==i.BAR_DISPLAYED)return oa;c('OmniMLogHelpers').barDisplayed(pa.options,ca(oa));return oa}f.exports={barDisappeared:ma,barDisplayed:na,barTimedOut:la,mercuryDispatch:aa,messageFetched:ba,prefsUpdated:ha,suggestionClicked:da,suggestionCompleted:ea,suggestionDisappeared:ka,suggestionDismissed:fa,suggestionDisplayed:ja,suggestionModeSet:ia,suggestionsDismissedForThread:ga}}),null);
__d('OmniMState',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={suggestionsByThread:c('immutable').Map(),threadMetadata:c('immutable').Map(),prefs:c('immutable').Map()};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("XMessagingOmniMPrefController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/messaging\/get_omnim_prefs\/",{})}),null);
__d('OmniMStore',['AsyncRequest','FluxReduceStore','MercuryConfig','MercuryDispatcher','MercuryMessages','MessengerFluxReduceDispatcher','OmniMHelpers','OmniMReducer','OmniMState','OmniMActions','XMessagingOmniMPrefController'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=5,k=[].concat(Object.values(c('OmniMReducer')));h=babelHelpers.inherits(l,c('FluxReduceStore'));i=h&&h.prototype;l.prototype.getInitialState=function(){return new (c('OmniMState'))()};l.prototype.reduce=function(m,n){if(n.namespace!==c('OmniMActions').Namespace)return m;return k.reduce(function(o,p){return p(o,n)},m)};l.prototype.$OmniMStore1=function(m){c('MercuryMessages').get().getThreadMessagesRange(m,0,1,function(n){if(n&&n.length){var o=n[0];c('OmniMActions').messageFetched(m,o)}})};l.prototype.$OmniMStore2=function(){var m=this.getState().get('prefs'),n=c('OmniMHelpers').suggestionMode(m),o=c('MercuryConfig').OmniMConfidenceThresholds[n];return o||.9};l.prototype.$OmniMStore3=function(m){var n=this.$OmniMStore2();return (m||[]).filter(function(o){return o.confidence&&o.confidence>n})};l.prototype.suggestionsForThread=function(m){var n=this.getState();if(!n.getIn(['threadMetadata',m]))this.$OmniMStore1(m);var o=n.getIn(['suggestionsByThread',m],{}),p=this.$OmniMStore3(o.agentSuggestions).slice(0,j);return babelHelpers['extends']({},o,{agentSuggestions:p})};l.prototype.prefs=function(){return this.getState().get('prefs')};l.prototype.$OmniMStore4=function(){var m=c('MercuryDispatcher').get();m.subscribe('update-messages',function(n,o){c('OmniMActions').mercuryDispatched(n,o)});m.subscribe('invalidate-thread-state',function(n,o){c('OmniMActions').mercuryDispatched(n,{threadID:o})});m.subscribe('invalidate-global-state',function(n){return c('OmniMActions').mercuryDispatched(n)})};l.prototype.$OmniMStore5=function(){if(c('MercuryConfig').OmniMEditConfidenceThreshold){var m=c('XMessagingOmniMPrefController').getURIBuilder().getURI();new (c('AsyncRequest'))(m).setAllowCrossPageTransition(true).setReadOnly(true).setMethod('POST').setHandler(function(n){return c('OmniMActions').prefsUpdated(n.payload)}).send()}};l.prototype.setUp=function(){this.$OmniMStore4();this.$OmniMStore5()};function l(){h.apply(this,arguments)}f.exports=new l(c('MessengerFluxReduceDispatcher'))}),null);
__d('P2PSendMoneyDialogStore',['P2PActionConstants','EventEmitter','Map','P2PDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=36,k=void 0,l=void 0;h=babelHelpers.inherits(m,c('EventEmitter'));i=h&&h.prototype;function m(){i.constructor.call(this);l=new (c('Map'))();k=c('P2PDispatcher').register(this.onEventDispatched.bind(this))}m.prototype.onEventDispatched=function(n){var o=n.data,p=n.type;switch(p){case c('P2PActionConstants').CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(o);this.emit('change');break;case c('P2PActionConstants').CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(o);this.emit('change');break;}};m.prototype.getStateByThreadID=function(n){return l.get(n)};m.prototype.handleChatSendViewOpened=function(n){l.set(n.threadID,{amount:n.amount,groupSendRecipientUserIDs:n.groupSendRecipientUserIDs,groupSendReceiptDetails:n.groupSendReceiptDetails,groupThreadFBID:n.groupThreadFBID,onCompletion:n.onCompletion,openRequestTab:n.openRequestTab,memoText:n.memoText&&n.memoText.substr(0,j),platformData:n.platformData,referrer:n.referrer,paymentRequestID:n.paymentRequestID,sendMoneyDialogShown:true,sendMoneyNUXDismissed:n.sendMoneyNUXDismissed,useModal:n.useModal})};m.prototype.handleChatSendViewClosed=function(n){l.set(n.threadID,{amount:'',groupSendRecipientUserIDs:[],groupSendReceiptDetails:null,groupThreadFBID:'',onCompletion:null,openRequestTab:false,memoText:null,platformData:null,referrer:null,paymentRequestID:null,sendMoneyDialogShown:false,sendMoneyNUXDismissed:false,useModal:false})};m.prototype.isAnyChatSendViewOpen=function(){for(var n=l.values(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;if(r.sendMoneyDialogShown)return true;}return false};f.exports=new m()}),null);
__d('mercuryIgnoredParticipantsRe',['Set','bs_array','utilsRe','MercuryIDs','bs_js_primitive','MercuryDispatcher','mercurySingletonProviderRe','MercuryIgnoredBlockedParticipantsRe'],(function a(b,c,d,e,f,g){'use strict';function h(l){var m=new (c('Set'))(),n=c('MercuryDispatcher').getForFBID(l);n.subscribe("update-ignored-users",function(o,p){var q=p.message_ignored_ids;if(!(q==null))c('bs_array').iter(function(s){m.add(s);return 0},q);var r=c('utilsRe').$pipe$unknown(c('bs_js_primitive').null_undefined_to_opt(p.participants),[]);r.forEach(function(s){var t=c('utilsRe').nullUndefinedBooleanToOptionBool(s.is_messenger_ignored),u=s.fbid;if(t){if(t[0]!==0){if(u==null){return 0}else{m.add(c('MercuryIDs').getParticipantIDFromUserID(u));return 0}}else if(u==null){return 0}else{+m['delete'](c('MercuryIDs').getParticipantIDFromUserID(u));return 0}}else return 0;});return 0});return {findIntersection:function o(p){return c('MercuryIgnoredBlockedParticipantsRe').findIntersection(l,m,p)},isPresentInGroupThread:function o(p){return c('MercuryIgnoredBlockedParticipantsRe').isPresentInGroupThread(l,m,p)},ignoredParticipantsInGroupThread:function o(p){return c('MercuryIgnoredBlockedParticipantsRe').participantsInGroupThread(l,m,p)},isMessageIgnored:function o(p){return c('MercuryIgnoredBlockedParticipantsRe').qualifiesAs(l,m,p)},__fbid:l}}var i=c('mercurySingletonProviderRe').Provider([h]),j=i[0],k=i[1];g.getForFBID=j;g.get=k}),null);
__d('FantaTabsAppBase',['Bootloader','ChatAppActions','ChatAppStore','ChatPerfInstrumentation','CSS','JSLogger','Map'],(function a(b,c,d,e,f,g){'use strict';h.prototype.init=function(i,j,k){if(this.isInitialized()){c('JSLogger').create('chat_app').error('repeated_init');return}this.$FantaTabsAppBase1=i;this.tabsElem=j;var l=c('ChatAppStore').addListener(function(){var m=c('ChatAppStore').getPreviousState(),n=c('ChatAppStore').getState();if(m.initialDisplayDone===false&&n.initialDisplayDone===true){c('ChatPerfInstrumentation').logDisplayDone();l.remove()}});c('ChatPerfInstrumentation').init();this.$FantaTabsAppBase2(k);this.initializeFantaData(k.interstitial_data);this.initializeFantaUI();this.$FantaTabsAppBase3();c('ChatAppActions').tti();c('ChatPerfInstrumentation').logTTI()};h.prototype.isInitialized=function(){return !!c('ChatAppStore').getState().isInitialized};h.prototype.isHidden=function(){var i=c('ChatAppStore').getState();return !!(!i.isInitialized||i.isHidden)};h.prototype.hide=function(){if(this.isHidden())return;c('CSS').hide(this.$FantaTabsAppBase1);c('ChatAppActions').hide()};h.prototype.unhide=function(){var i=c('ChatAppStore').getState();if(i.isInitialized){if(i.isHidden){c('CSS').show(this.$FantaTabsAppBase1);e(['Dock'],function(j){j.resizeAllFlyouts()});c('ChatAppActions').unhide()}}else if(!i.isLoaded){e(['UIPagelet'],function(j){j.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');j.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet')});c('ChatAppActions').load()}};h.prototype.initializeFantaData=function(i){};h.prototype.initializeFantaUI=function(){};h.prototype.$FantaTabsAppBase2=function(i){e(['mercuryBlockedParticipantsRe','mercuryIgnoredParticipantsRe','MercuryDelayedRoger','MercuryDeliveryReceipts','MercuryDeliveryState','MercuryParticipants','MercuryServerPayloadPreprocessor','MercuryThreads','MercuryUnreadState','MercuryUnseenState','MercurySyncEnvironment','P2PSendMoneyDialogStore','OmniMStore'],function(j,k,l,m,n,o,p,q,r,s,t,u,v){j.get();k.get();l.get();m.get();n.get();o;q.get();s.get();r.get();t.setUp();v.setUp();c('ChatPerfInstrumentation').logInitStores();if(i.graphql_payload){c('Bootloader').loadModules(["chatInitialDataTransformerRe"],function(w){var x=i.graphql_payload,y=w.transform(x);y.message_blocked_ids=x.message_blocked_ids;y.payload_source=x.payload_source;p.get().handleUpdate(y)},'FantaTabsAppBase')}else p.get().handleUpdate(i.initial_data);})};h.prototype.$FantaTabsAppBase3=function(){e(['HotLikeSound','ChatOptions'],function(i,j){i.setCheckSoundEnabledFunc(function(){return j.getSetting('sound')});c('ChatPerfInstrumentation').logInitSound()})};function h(){}f.exports=h}),null);