if (self.CavalryLogger) { CavalryLogger.start_js(["hxSUb"]); }

__d('RHCVideoWNSController',['csx','cx','invariant','Arbiter','CSS','DOM','DOMDimensions','EventListener','Parent','Locale','ReactDOM','Run','SubscriptionsHandler','Style','VideoPlayerExperiments','ViewportBounds','VideoWatchAndScrollController','Toggler','getElementPosition','getViewportDimensions','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k=c('VideoPlayerExperiments').persistentWNSEnabled,l=350,m=10,n={init:function p(q){if(this._isInitialized){this._dock(q)}else{var r;this._container=q;this._root=this._find("._5-32");this._video=this._find("._o2t");this._isInitialized=true;c('CSS').show(this._container);this._subscriptionsHandler=new (c('SubscriptionsHandler'))();(r=this._subscriptionsHandler).addSubscriptions.apply(r,this._createSubscriptions());if(c('VideoWatchAndScrollController').isActive()){var s=c('VideoWatchAndScrollController').getReactContainer();if(!s)return;var t=this._root,u=c('ReactDOM').findDOMNode(s);if(u&&u.parentNode)u=u.parentNode;var v=c('getElementPosition')(c('DOM').find(u,"._360g")),w=v.x,x=v.y;this.mount(u);this._moveRoot(w,x);c('CSS').addClass(t,"_4nya");this.expand();t.offsetHeight;c('CSS').removeClass(t,"_4nya");this._animateThenCleanup(function(){var y=c('getElementPosition')(this._container).x,z=c('ViewportBounds').getTop();this._moveRoot(y,z)}.bind(this))}}c('Run').onLeave(function(){if(c('VideoWatchAndScrollController').isActive()){if(k){this._eject();return}this.close()}this._subscriptionsHandler.release();this._isInitialized=false;this._container=null;this._root=null;this._video=null}.bind(this))},_eject:function p(){var q=this._getRoot(),r=c('getElementPosition')(q),s=r.x,t=r.y,u=this._getContainer();c('Arbiter').inform('RHCVideoWNSController/eject',u);this._moveRoot(s,t);c('Arbiter').subscribeOnce('page_transition',function(v,w){var x=w.uri;if(!['/','/home.php'].includes(x.getPath()))this._animate(function(){this._moveToViewportEdge()}.bind(this));}.bind(this))},_dock:function p(q){c('DOM').replace(q,this._container);c('Arbiter').inform('RHCVideoWNSController/dock');var r=this._getContainer(),s=c('getElementPosition')(r),t=s.x,u=c('ViewportBounds').getTop();this._animateThenCleanup(function(){this._moveRoot(t,u)}.bind(this))},_find:function p(q){return c('DOM').find(this._getContainer(),q)},getAnimationTime:function p(){return l},mount:function p(q){c('DOM').setContent(this._video,'');this._video.appendChild(q);this._correctContainerHeight();c('Arbiter').inform('RHCVideoWNSController/mount')},_setPosition:function p(q){var r=this._getRoot();c('Style').set(r,'top',q.top==null?'':q.top+'px');c('Style').set(r,'left',q.left==null?'':q.left+'px');c('Style').set(r,'right',q.right==null?'':q.right+'px')},_moveRoot:function p(q,r){this._setPosition({top:r,left:q})},_moveToViewportEdge:function p(){var q;this._setPosition((q={top:c('ViewportBounds').getTop()+m},q[c('Locale').isRTL()?'left':'right']=c('ViewportBounds').getRight()+m,q))},_animate:function p(q){var r=arguments.length<=1||arguments[1]===undefined?false:arguments[1],s=this._getRoot();c('CSS').addClass(s,"_1dq5");q();c('setTimeoutAcrossTransitions')(function(){c('CSS').removeClass(s,"_1dq5");if(r)this._setPosition({top:null,left:null,right:null});}.bind(this),l)},_animateThenCleanup:function p(q){this._animate(q,true)},_createSubscriptions:function p(){return [c('ViewportBounds').subscribe('change',function(){if(document.body===this._getContainer().parentNode)this._moveToViewportEdge();}.bind(this)),c('Arbiter').subscribe('VideoWatchAndScrollController/resize',function(){this._correctContainerHeight();c('Arbiter').inform('RHCVideoWNSController/resize')}.bind(this)),c('Arbiter').subscribe('VideoWatchAndScrollController/start',function(){if(this.isExpanded()){this._correctContainerHeight();c('Arbiter').inform('RHCVideoWNSController/resize');return}this.expand();this._correctContainerHeight()}.bind(this)),c('Arbiter').subscribe('VideoWatchAndScrollController/exit',function(){this.close()}.bind(this)),c('Arbiter').subscribe('VideoWatchAndScrollController/collapse',function(){this.collapse()}.bind(this)),c('EventListener').listen(this._getRoot(),'click',function(event){var q=event.target;if(!c('Parent').bySelector(q,"._2se8"))this.expand();}.bind(this)),c('Arbiter').subscribe('bluebarFixedBehaviorController/isfixed',function(q,r){var s=this._getRoot();c('CSS').conditionClass(s,"_2rdq",!r)}.bind(this))]},_getRoot:function p(){this._root||j(0);return this._root},_getContainer:function p(){this._container||j(0);return this._container},_correctContainerHeight:function p(){if(!c('VideoPlayerExperiments').rhcWNSDrawerEnabled){var q=o(this._video),r=this._getRoot(),s=this._getContainer();c('Style').set(s,'height',q+'px');c('Style').set(r,'height',q+'px')}},isExpanded:function p(){var q=this._getContainer(),r="._2afq";return c('CSS').matchesSelector(q,r)},isCollapsed:function p(){var q=this._getContainer(),r="._2afm";return c('CSS').matchesSelector(q,r)},isClosed:function p(){var q=this._getContainer(),r="._2afo";return c('CSS').matchesSelector(q,r)},expand:function p(){if(!c('VideoWatchAndScrollController').isActive()||!this._isInitialized||this.isExpanded())return;var q=this._getContainer();c('CSS').removeClass(q,"_2afm");c('CSS').removeClass(q,"_2afo");c('CSS').addClass(q,"_2afq");c('Arbiter').inform('RHCVideoWNSController/expandStart');c('setTimeoutAcrossTransitions')(function(){c('Arbiter').inform('RHCVideoWNSController/expandEnd');if(!c('VideoWatchAndScrollController').isActiveVideoDonePlaying())c('VideoWatchAndScrollController').playActiveVideo();},l)},collapse:function p(){if(!this._isInitialized||this.isCollapsed())return;c('VideoWatchAndScrollController').pauseActiveVideo();c('Toggler').hide();var q=this._getContainer();c('CSS').removeClass(q,"_2afq");c('CSS').addClass(q,"_2afm");c('Arbiter').inform('RHCVideoWNSController/collapseStart');c('setTimeoutAcrossTransitions')(function(){c('Arbiter').inform('RHCVideoWNSController/collapseEnd')},l)},close:function p(){if(!this._isInitialized||this.isClosed())return;c('VideoWatchAndScrollController').pauseActiveVideo();var q=this._getContainer();c('CSS').addClass(q,"_2afo");c('Arbiter').inform('RHCVideoWNSController/closeStart');c('setTimeoutAcrossTransitions')(function(){c('CSS').removeClass(q,"_2afm");c('CSS').removeClass(q,"_2afq");c('Arbiter').inform('RHCVideoWNSController/closeEnd')},l)}};function o(p){return c('DOMDimensions').getElementDimensions(p).height}f.exports=n}),null);
__d('VideoUnitRHC',['cx','csx','Arbiter','CSS','DirectionalDockingElement','DOM','DOMDimensions','Event','ViewportBounds','RHCVideoWNSController','Run','Style','SubscriptionsHandler','ge','getElementPosition','getViewportDimensions','requestAnimationFrame','throttle'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=35,k=33;function l(s){return function(t){return c('Arbiter').subscribe(t,s)}}var m={init:function s(t){this._root=t;this._dockingInstance=new (c('DirectionalDockingElement'))(t);this._isInitialized=true;var u=new (c('SubscriptionsHandler'))();u.addSubscriptions.apply(u,this._createSubscriptions());c('Run').onLeave(function(){u.release();this._isInitialized=false;this._root=null;this._dockingInstance=null}.bind(this))},_createSubscriptions:function s(){var t=this._updateOffsetAndTop.bind(this),u=this._onCollapse.bind(this),v=this._onExpand.bind(this),w=l(t);return [this._dockingInstance.subscribe('changedheight',t),w('header_loaded'),w('browse_top_filters_full_width_displayed'),w('netego_loaded'),w('video_fullscreen_change'),c('Event').listen(window,'resize',c('throttle')(t)),w('RHCVideoWNSController/collapseEnd'),w('RHCVideoWNSController/expandEnd'),w('RHCVideoWNSController/closeEnd'),c('Arbiter').subscribe('RHCVideoWNSController/collapseStart',u),c('Arbiter').subscribe('RHCVideoWNSController/expandStart',v),c('Arbiter').subscribe('RHCVideoWNSController/closeStart',u),c('Arbiter').subscribe('RHCVideoWNSController/resize',function(){this._updateOffsetAndTop();window.scrollBy(0,1);c('requestAnimationFrame')(function(){window.scrollBy(0,-1)})}.bind(this))]},_onCollapse:function s(){var t=n(this.getRoot()),u=r(),v=Math.abs(p()-q());if(u<=t){this._moveY(0)}else if(u-t<v){this._moveY(0);this._animateY(function(){this._moveY(u-t)}.bind(this))}else if(!this._isFixed()){this._moveY(0);this._animateY(function(){this._moveY(v)}.bind(this))}},_onExpand:function s(){var t=n(this.getRoot()),u=r(),v=Math.abs(p()-q());if(u<=t||this._getRHCScrollDistance()<=v){this._moveY(0)}else if(!this._isFixed()){this._moveY(0);this._animateY(function(){this._moveY(-v)}.bind(this))}},_isFixed:function s(){return c('Style').get(this.getRoot(),'position')==='fixed'},_updateOffsetAndTop:function s(){if(!this._isInitialized)return;var t=c('ViewportBounds').getTop()+p(),u=this._calculateOffset(t);this._dockingInstance.setOffsetAndTop(u,t)},_calculateOffset:function s(t){var u=c('getViewportDimensions')().height,v=o(this.getRoot());if(v>u-j-t)return u-j-v;return t},getRoot:function s(){return this._root},_getRHCScrollDistance:function s(){var t=this.getRoot(),u=this._dockingInstance.getPlaceholder();return n(t)-n(u)},_moveY:function s(t){var u=this.getRoot();this._dockingInstance.translateY(t);u.offsetHeight},_animateY:function s(t){var u=this.getRoot();c('CSS').addClass(u,"_5-ky");t();setTimeout(function(){c('CSS').removeClass(u,"_5-ky")},c('RHCVideoWNSController').getAnimationTime())}};function n(s){return c('getElementPosition')(s).y}function o(s){return s?c('DOMDimensions').getElementDimensions(s).height:0}function p(){if(c('RHCVideoWNSController').isExpanded()){var s=c('ge')('fbRHCVideoWNS-container'),t=c('DOM').find(s,"._o2t");return o(t)}if(c('RHCVideoWNSController').isCollapsed())return k;return 0}function q(){var s=c('ge')('fbRHCVideoWNS-container'),t=c('DOM').find(s,"._5-32");return o(t)}function r(){var s=c('ge')('fbRHCVideoWNS-container'),t=c('DOM').find(s,"._5-32");return n(t)+o(t)}f.exports=m}),null);