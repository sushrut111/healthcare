if (self.CavalryLogger) { CavalryLogger.start_js(["q4BR4"]); }

__d("SubscribeStatuses",[],(function a(b,c,d,e,f,g){f.exports={CANNOT_SUBSCRIBE:"CANNOT_SUBSCRIBE",IS_SUBSCRIBED:"IS_SUBSCRIBED",CAN_SUBSCRIBE:"CAN_SUBSCRIBE"}}),null);
__d('CameraPostBucketOwnerHelper',['idx'],(function a(b,c,d,e,f,g){'use strict';var h={getId:function i(j){var k;return ((k=j)!=null?k.id:k)||''},getName:function i(j){var k;return ((k=j)!=null?k.name:k)||''},getGender:function i(j){if(!j)return '';return j.gender?j.gender:''},isEventHost:function i(j){if(!j)return false;return j.is_viewer_host?!!j.is_viewer_host:false},isViewerFriend:function i(j){if(!j)return false;return j.is_viewer_friend?!!j.is_viewer_friend:false},getSubscribeStatus:function i(j){if(!j)return null;return j.subscribe_status?j.subscribe_status:null},getProfilePictureUri:function i(j){if(!j||!j.profile_picture)return '';return j.profile_picture.uri||''},getCoverPhotoUri:function i(j){var k;if(!j||!j.cover_photo)return '';return ((k=j)!=null?(k=k.cover_photo)!=null?(k=k.photo)!=null?(k=k.image)!=null?k.uri:k:k:k:k)||''}};f.exports=h}),null);
__d('CameraPostMediaHelper',['idx'],(function a(b,c,d,e,f,g){'use strict';var h={getId:function i(j){var k;return ((k=j)!=null?k.id:k)||''},getWidth:function i(j){if(!j)return 0;if(j.width)return j.width;if(j.image)return j.image.width||0;return 0},getHeight:function i(j){if(!j)return 0;if(j.height)return j.height;if(j.image)return j.image.height||0;return 0},getType:function i(j){var k;return ((k=j)!=null?k.__typename:k)||''},getImageUri:function i(j){if(!j)return null;return j.image?j.image.uri:null},isImage:function i(j){return h.getType(j)==='Photo'},isVideo:function i(j){return h.getType(j)==='Video'},getPreviewImage:function i(j){if(!j)return null;return j.preview_image?j.preview_image.uri:null}};f.exports=h}),null);
__d('CameraPostThreadOwnerHelper',['idx'],(function a(b,c,d,e,f,g){'use strict';var h={getId:function i(j){var k;return (k=j)!=null?k.id:k},getName:function i(j){var k;return ((k=j)!=null?k.name:k)||''},getIsViewerFriend:function i(j){var k;return !!((k=j)!=null?k.is_viewer_friend:k)},getProfilePictureUri:function i(j){var k;return ((k=j)!=null?(k=k.profile_picture)!=null?k.uri:k:k)||''}};f.exports=h}),null);
__d('FBStoriesActionTypes',[],(function a(b,c,d,e,f,g){var h={LOAD:'FB_STORIES.LOAD',LOADING:'FB_STORIES.LOADING',LOADED:'FB_STORIES.LOADED',LOADED_ERROR:'FB_STORIES.LOADED_ERROR',VIEWER_LIST_LOADED_FOR_THREAD:'FB_STORIES.VIEWER_LIST_LOADED_FOR_THREAD',RESET_LOCAL_SEEN_HISTORY:'FB_STORIES.RESET_LOCAL_SEEN_HISTORY',SELECTED_BUCKET_IDX_CHANGED:'FB_STORIES.SELECTED_BUCKET_IDX_CHANGED',SET_ALL_BUCKETS_VIEWED:'FB_STORIES.SET_ALL_BUCKETS_VIEWED',SET_UNSEEN_MODE:'FB_STORIES.SET_UNSEEN_MODE',SELECTED_THREAD_IDX_CHANGED:'FB_STORIES.SELECTED_THREAD_IDX_CHANGED',SELECTED_THREAD_PERCENT_DONE:'FB_STORIES.SELECTED_THREAD_PERCENT_DONE',SUBSCRIPTION_BUCKET_UPDATE:'FB_STORIES.SUBSCRIPTION_BUCKET_UPDATE',UPDATE_THREAD_SEEN_OPTIMISTIC:'FB_STORIES.UPDATE_THREAD_SEEN_OPTIMISTIC',UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:'FB_STORIES.UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC',DELETE_THREAD_FROM_BUCKET:'FB_STORIES.DELETE_THREAD_FROM_BUCKET',REMOVE_BUCKET:'FB_STORIES.REMOVE_BUCKET',SET_SATP_NATIVE_RENDER:'FB_STORIES.SET_SATP_NATIVE_RENDER',REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:'FB_STORIES.REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET',SET_IS_COMMERCIAL_BREAK_RUNNING:'FB_STORIES.SET_IS_COMMERCIAL_BREAK_RUNNING',UNSELECT_BUCKET:'FBSTORIES.UNSELECT_BUCKET'};f.exports=h}),null);
__d("CameraPostTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DIRECT:"DIRECT",GROUP_DIRECT:"GROUP_DIRECT",DIRECT_NUX:"DIRECT_NUX",STORY:"STORY",STORY_NUX:"STORY_NUX",PAGE_STORY:"PAGE_STORY",EVENT_STORY:"EVENT_STORY",BIRTHDAY_STORY:"BIRTHDAY_STORY",GROUP_STORY:"GROUP_STORY",LIVE_STORY:"LIVE_STORY",PROMOTION_STORY:"PROMOTION_STORY"})}),null);
__d('FBStoriesLoggingConstants',[],(function a(b,c,d,e,f,g){'use strict';var h={EVENT_STORY:'eventStory',FOLLOWEE_STORY:'followeeStory',FRIEND_STORY:'friendStory',MISSING_STORY_DATA:'missingStoryData',PAGE_STORY:'pageStory',SELF_STORY:'selfStory',STORY_PROMOTION:'storyPromotion'};f.exports=h}),null);
__d('FBStoriesThreadHelper',['CameraPostMediaHelper','CameraPostThreadOwnerHelper','idx'],(function a(b,c,d,e,f,g){'use strict';var h={getId:function i(j){var k;return ((k=j)!=null?k.id:k)||''},getCameraPostType:function i(j){var k;return ((k=j)!=null?k.camera_post_type:k)||''},getCameraPostSource:function i(j){var k;return ((k=j)!=null?k.post_source:k)||'CAMERA_SYSTEM'},isSeenByViewer:function i(j){var k;return !!((k=j)!=null?k.is_seen_by_viewer:k)},setIsSeenByViewer:function i(j,k){if(!j)return;j.is_seen_by_viewer=k},getLatestMessageID:function i(j){var k;return (k=j)!=null?(k=k.latest_message)!=null?k.id:k:k},getStatus:function i(j){var k;return (k=j)!=null?k.thread_status:k},getTime:function i(j){var k;return ((k=j)!=null?k.time:k)||0},getFollowersSeenCount:function i(j){var k;return ((k=j)!=null?k.followers_seen_count:k)||0},setFollowersSeenCount:function i(j,k){if(!j)return;j.followers_seen_count=k},getFriendsSeenCount:function i(j){var k;return ((k=j)!=null?k.friends_seen_count:k)||0},setFriendsSeenCount:function i(j,k){if(!j)return;j.friends_seen_count=k},getSeenReceiptsLastSeenTime:function i(j){var k;return ((k=j)!=null?k.seen_receipts_last_seen_time:k)||0},setSeenReceiptsLastSeenTime:function i(j,k){if(!j)return;j.seen_receipts_last_seen_time=k},getSeenReceiptsUnseenCount:function i(j){var k;return ((k=j)!=null?k.seen_receipts_unseen_count:k)||0},setSeenReceiptsUnseenCount:function i(j,k){if(!j)return;j.seen_receipts_unseen_count=k},getOwner:function i(j){var k;return (k=j)!=null?k.camera_post_thread_owner:k},getOwnerId:function i(j){return c('CameraPostThreadOwnerHelper').getId(h.getOwner(j))},isViewerFriendOfOwner:function i(j){return c('CameraPostThreadOwnerHelper').getIsViewerFriend(h.getOwner(j))},getViewers:function i(j){var k;return ((k=j)!=null?(k=k.story_viewers)!=null?k.edges:k:k)||[]},setViewers:function i(j,k){if(!j)return;j.story_viewers=k},getRootMessage:function i(j){var k;return (k=j)!=null?k.root_message:k},getMedia:function i(j){var k;return (k=h.getRootMessage(j))!=null?k.message_media:k},getMediaId:function i(j){return c('CameraPostMediaHelper').getId(h.getMedia(j))},getMediaType:function i(j){return c('CameraPostMediaHelper').getType(h.getMedia(j))},getMediaPreviewImage:function i(j){return c('CameraPostMediaHelper').getPreviewImage(h.getMedia(j))},getWWWTextFormatMetadata:function i(j){var k;return ((k=h.getRootMessage(j))!=null?k.www_text_format_metadata:k)||null},getMessageText:function i(j){var k;return ((k=h.getRootMessage(j))!=null?k.message_text:k)||''},getStoryViewerId:function i(j){var k;return (k=j)!=null?(k=k.node)!=null?k.id:k:k},getStoryViewerSeenTime:function i(j){var k;return ((k=j)!=null?k.seen_time:k)||0}};f.exports=h}),null);
__d('FBStoriesBucketHelper',['CameraPostBucketOwnerHelper','CameraPostTypes','CurrentUser','FBStoriesLoggingConstants','FBStoriesThreadHelper','idx'],(function a(b,c,d,e,f,g){'use strict';var h={getUnseenThread:function j(k){var l=i.getThreads(k);return l[Math.max(0,i.getUnseenThreadIndex(k))]}},i={isUserBucket:function j(k){return i.getOwnerId(k)===c('CurrentUser').getID()},getLiveVideo:function j(k){var l;return (l=k)!=null?l.live_video:l},isLive:function j(k){var l;return !!((l=i.getLiveVideo(k))!=null?l.id:l)},setLiveVideo:function j(k,l){if(!k)return;k.live_video=l},hasData:function j(k){if(!k)return false;return i.getThreads(k).length>0},getThreads:function j(k){var l,m=((l=k)!=null?(l=l.threads)!=null?l.nodes:l:l)||[];return m.filter(function(n){return c('FBStoriesThreadHelper').getStatus(n)==='PUBLISHED'&&c('FBStoriesThreadHelper').getMedia(n)!==null})},setThreads:function j(k,l){if(!k)return;k.threads={nodes:l}},getUnseenThreadIndex:function j(k){var l=i.getThreads(k),m=i.isUserBucket(k);return m?l.findIndex(function(n){return c('FBStoriesThreadHelper').getSeenReceiptsUnseenCount(n)>0}):l.findIndex(function(n){return !c('FBStoriesThreadHelper').isSeenByViewer(n)})},getPreviewImage:function j(k){var l=h.getUnseenThread(k);return c('FBStoriesThreadHelper').getMediaPreviewImage(l)},getId:function j(k){var l;return ((l=k)!=null?l.id:l)||''},getCameraPostType:function j(k){var l;return ((l=k)!=null?l.camera_post_type:l)||''},getUnseenCount:function j(k){var l;return ((l=k)!=null?l.unseen_count:l)||0},setUnseenCount:function j(k,l){if(!k)return;k.unseen_count=l},hasLiveVideoEnded:function j(k){var l;return !!((l=k)!=null?l.has_live_video_ended:l)},setHasLiveVideoEnded:function j(k,l){if(!k)return;k.has_live_video_ended=l},getOwner:function j(k){var l;return ((l=k)!=null?l.camera_post_bucket_owner:l)||{id:null,name:null,short_name:null,gender:null,is_viewer_friend:false,profile_picture:null,subscribe_status:null}},getOwnerId:function j(k){return c('CameraPostBucketOwnerHelper').getId(i.getOwner(k))},getOwnerGender:function j(k){return c('CameraPostBucketOwnerHelper').getGender(i.getOwner(k))},isViewerEventHost:function j(k){return c('CameraPostBucketOwnerHelper').isEventHost(i.getOwner(k))},isViewerFriendOfOwner:function j(k){return c('CameraPostBucketOwnerHelper').isViewerFriend(i.getOwner(k))},getOwnerSubscribeStatus:function j(k){return c('CameraPostBucketOwnerHelper').getSubscribeStatus(i.getOwner(k))},getOwnerProfilePictureUri:function j(k){return c('CameraPostBucketOwnerHelper').getProfilePictureUri(i.getOwner(k))},getOwnerCoverPhotoUri:function j(k){return c('CameraPostBucketOwnerHelper').getCoverPhotoUri(i.getOwner(k))},getOwnerName:function j(k){var l=i.getCameraPostType(k),m=i.getOwner(k);if(l===c('CameraPostTypes').STORY&&m.short_name){return m.short_name}else return m.name;},getLoggingType:function j(k){if(!k)return c('FBStoriesLoggingConstants').MISSING_STORY_DATA;if(i.isUserBucket(k))return c('FBStoriesLoggingConstants').SELF_STORY;var l=i.getCameraPostType(k);if(l===c('CameraPostTypes').PAGE_STORY)return c('FBStoriesLoggingConstants').PAGE_STORY;if(l===c('CameraPostTypes').EVENT_STORY)return c('FBStoriesLoggingConstants').EVENT_STORY;if(l===c('CameraPostTypes').PROMOTION_STORY)return c('FBStoriesLoggingConstants').STORY_PROMOTION;if(!i.isViewerFriendOfOwner(k))return c('FBStoriesLoggingConstants').FOLLOWEE_STORY;return c('FBStoriesLoggingConstants').FRIEND_STORY},getDefaultBucket:function j(){return {id:null,camera_post_type:null,unseen_count:0,ranking:null,live_video:null,camera_post_bucket_owner:null,threads:null}}};f.exports=i}),null);
__d('friendsBucketSorter',['CameraPostTypes','idx'],(function a(b,c,d,e,f,g){'use strict';function h(q){return function r(s,t){var u=s.live_video&&s.live_video.id,v=t.live_video&&t.live_video.id;if(u!==v)return u?-1:1;if(i(s,t))return k(s)?-1:1;if(j(s,t))return l(s)?-1:1;if(m(s,t,q))return n(s,q)?-1:1;return p(s)>=p(t)?-1:1}}function i(q,r){return o(q,r,k)}function j(q,r){return o(q,r,l)}function k(q){return q.unseen_count>0}function l(q){return q.camera_post_type===c('CameraPostTypes').EVENT_STORY}function m(q,r,s){return n(q,s)!==n(r,s)}function n(q,r){var s,t=((s=q)!=null?(s=s.threads)!=null?s.nodes:s:s)||[];for(var u=0;u<t.length;u++){var v,w=(v=t[u])!=null?(v=v.camera_post_thread_owner)!=null?v.id:v:v;if(w===r)return true;}return false}function o(q,r,s){var t=s(q),u=s(r);return t!=u}function p(q){return q.ranking.score}f.exports=h}),null);
__d('FBStoriesDataHelper',['friendsBucketSorter','idx','CameraPostTypes','FBStoriesBucketHelper','SubscribeStatuses'],(function a(b,c,d,e,f,g){'use strict';var h={getBucketsDataFromLoadedObject:function i(j){var k=h.getUserDataNodesFromLoadedObject(j),l=k[0],m=h.getUserInfoFromLoadedObject(j),n=h.getFriendsBucketDataFromLoadedObject(j);n=n.reduce(function(o,p){var q=c('FBStoriesBucketHelper').getThreads(p),r=q&&q.length>0,s=c('FBStoriesBucketHelper').getCameraPostType(p),t=s===c('CameraPostTypes').STORY_NUX,u=s===c('CameraPostTypes').EVENT_STORY,v=c('FBStoriesBucketHelper').getOwnerSubscribeStatus(p)===c('SubscribeStatuses').IS_SUBSCRIBED;if(t)return o;if(!r){if(c('FBStoriesBucketHelper').isLive(p))return o.concat([p]);return o}if(v||u)return o.concat([p]);return o},[]);n.sort(c('friendsBucketSorter')(m.userID));return {userInfo:m,userBucketData:l,friendsBucketData:n}},getFriendsBucketDataFromLoadedObject:function i(j){var k;return ((k=j)!=null?(k=k.me)!=null?(k=k.friends_stories_buckets)!=null?k.nodes:k:k:k)||[]},getUserDataNodesFromLoadedObject:function i(j){var k;return ((k=j)!=null?(k=k.me)!=null?(k=k.story_bucket)!=null?k.nodes:k:k:k)||[]},getUserInfoFromLoadedObject:function i(j){var k,l,m,n;return {userName:(k=j)!=null?(k=k.me)!=null?k.name:k:k,userID:(l=j)!=null?(l=l.me)!=null?l.id:l:l,userGender:(m=j)!=null?(m=m.me)!=null?m.gender:m:m,userProfilePic:(n=j)!=null?(n=n.me)!=null?n.profile_picture:n:n}},getFriendsDataWithEndedLiveBucket:function i(j,k,l){if(!k||l||!c('FBStoriesBucketHelper').isLive(k))return j;var m=c('FBStoriesBucketHelper').getId(k),n=false;j=j.reduce(function(o,p){if(c('FBStoriesBucketHelper').getId(p)===m){n=true;var q=!c('FBStoriesBucketHelper').isLive(p);if(k&&q){c('FBStoriesBucketHelper').setLiveVideo(p,k.live_video);c('FBStoriesBucketHelper').setHasLiveVideoEnded(p,true)}}o.push(p);return o},[]);if(!n){c('FBStoriesBucketHelper').setHasLiveVideoEnded(k,true);j=[k].concat(j)}return j}};f.exports=h}),null);
__d('FBStoriesDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this)}f.exports=new j({strict:true})}),null);
__d("FBStoriesBucketsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1546576858698384"};j.getQueryID=function(){"use strict";return "958226110996721"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesDeleteMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1340045906066120"};j.getQueryID=function(){"use strict";return "967072946766012"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1386522808128715"};j.getQueryID=function(){"use strict";return "1384057201673076"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesTraySubscriptionWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function a(b,c,d,e,f,g){'use strict';f.exports=c("WebGraphQLSubscriptionHelper").getExports({docID:"1640224732696627",queryID:"307777106357848"})}),null);
__d('FBStoriesTraySubscription',['BaseGraphQLSubscription','FBStoriesTraySubscriptionWebGraphQLSubscription','uuid'],(function a(b,c,d,e,f,g){var h=babelHelpers['extends']({},c('BaseGraphQLSubscription'),{_getTopic:function i(j){return 'gqls/stories_tray_subscribe/user_id_'+j},_getQueryID:function i(){return c('FBStoriesTraySubscriptionWebGraphQLSubscription').getDocID()},_getQueryParameters:function i(j){return {input:JSON.stringify({client_subscription_id:c('uuid')(),user_id:j})}},_getSubscriptionCallName:function i(){return 'stories_tray_subscribe'}});f.exports=h}),null);
__d("FBStoriesViewerBucketViewersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1641309632559607"};j.getQueryID=function(){"use strict";return "259112971249828"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d('FBStoriesGraphQLAPI',['WebGraphQL','FBStoriesBucketsQueryWebGraphQLQuery','FBStoriesViewerBucketViewersQueryWebGraphQLQuery','FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation','FBStoriesTraySubscription','FBStoriesDeleteMutationWebGraphQLMutation','CurrentUser','uniqueID'],(function a(b,c,d,e,f,g){'use strict';f.exports={load:function h(){return c('WebGraphQL').exec(new (c('FBStoriesBucketsQueryWebGraphQLQuery'))())},loadViewerListForThread:function h(i){return c('WebGraphQL').exec(new (c('FBStoriesViewerBucketViewersQueryWebGraphQLQuery'))({threadId:i}))},subscribeToTrayChanges:function h(i){c('FBStoriesTraySubscription').subscribe(c('CurrentUser').getID(),i)},updateThreadSeenReciept:function h(i){var j={client_mutation_id:c('uniqueID')(),actor_id:c('CurrentUser').getID(),thread_id:i};return c('WebGraphQL').exec(new (c('FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation'))({input:j}))},deleteStory:function h(i,j){return c('WebGraphQL').exec(new (c('FBStoriesDeleteMutationWebGraphQLMutation'))({input:{client_mutation_id:c('uniqueID')(),actor_id:i,story_thread_ids:[j]}}))}}}),null);
__d("BackstageMediaType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({LIVE:"live",PHOTO:"photo",VIDEO:"video",UNKNOWN:"unknown"})}),null);
__d('FBStoriesLiveVideoActionTypes',['keyMirror'],(function a(b,c,d,e,f,g){var h=c('keyMirror')({SET_UI_COMPONENTS:null,REMOVE_UI_COMPONENTS:null,LIVE_BUCKET_LOADED:null});f.exports=h}),null);
__d('FBStoriesStore',['friendsBucketSorter','idx','BackstageMediaType','CameraPostTypes','FBStoriesActionTypes','FBStoriesDispatcher','FBStoriesBucketHelper','FBStoriesDataHelper','FBStoriesThreadHelper','FBStoriesLiveVideoActionTypes','FluxReduceStore','LoadObject','Map','SubscribeStatuses'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {data:c('LoadObject').empty(),selectedBucketIndex:-1,currentThreadIndex:-1,currentThreadPercentDone:0,unseenMode:false,allBucketsViewed:false,lastViewedThreadIndexForBucket:new (c('Map'))(),showSATPNativeRender:false,isCommercialBreakRunning:new (c('Map'))()}};j.prototype.reduce=function(k,l){var m,n=this,o,p,q,r;switch(l.type){case c('FBStoriesActionTypes').LOADING:return babelHelpers['extends']({},k,{data:c('LoadObject').loading()});case c('FBStoriesActionTypes').LOADED:var s=l.data,t=s.userInfo,u=s.userBucketData,v=s.friendsBucketData;v=c('FBStoriesDataHelper').getFriendsDataWithEndedLiveBucket(v,this.$FBStoriesStore1(),this.isOwnBucket(this.getSelectedBucketId()));return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userInfo:t,userBucketData:u,friendsBucketData:v})});case c('FBStoriesActionTypes').VIEWER_LIST_LOADED_FOR_THREAD:{var m=function(){var ja=l.data.node,ka=babelHelpers['extends']({},n.getUserBucketData(),{threads:{nodes:n.$FBStoriesStore2().map(function(la){if(c('FBStoriesThreadHelper').getId(la)===l.threadID){var ma=babelHelpers['extends']({},la);c('FBStoriesThreadHelper').setFriendsSeenCount(ma,c('FBStoriesThreadHelper').getFriendsSeenCount(ja));c('FBStoriesThreadHelper').setFollowersSeenCount(ma,c('FBStoriesThreadHelper').getFollowersSeenCount(ja));c('FBStoriesThreadHelper').setViewers(ma,ja.story_viewers);return ma}return la})}});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:ka,userInfo:n.getUserInfo(),friendsBucketData:n.getFriendsBucketData()})})}}();if(typeof m==="object")return m.v;}case c('FBStoriesActionTypes').SUBSCRIPTION_BUCKET_UPDATE:{var o=function(){var ja=l.bucketData,ka=n.$FBStoriesStore3(ja),la=ka.length>0||n.$FBStoriesStore4(ja),ma=c('FBStoriesBucketHelper').getOwnerSubscribeStatus(ja)===c('SubscribeStatuses').IS_SUBSCRIBED,na=c('FBStoriesBucketHelper').getId(ja),oa=n.getFriendsBucketData(),pa=false,qa=oa.reduce(function(ra,sa){if(c('FBStoriesBucketHelper').getId(sa)===na){pa=true;if(la&&ma)ra.push(ja);}else ra.push(sa);return ra},[]);if(!pa&&la)qa=[ja].concat(oa);qa=c('FBStoriesDataHelper').getFriendsDataWithEndedLiveBucket(qa,n.$FBStoriesStore1(),n.isOwnBucket(n.getSelectedBucketId()));qa.sort(c('friendsBucketSorter')(n.getUserInfo().userID));return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),userInfo:n.getUserInfo(),friendsBucketData:qa})})}}();if(typeof o==="object")return o.v;}case c('FBStoriesActionTypes').LOADED_ERROR:return babelHelpers['extends']({},k,{data:c('LoadObject').withError(new Error(l.error.errorSummary))});case c('FBStoriesActionTypes').RESET_LOCAL_SEEN_HISTORY:return babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:new (c('Map'))()});case c('FBStoriesActionTypes').SELECTED_BUCKET_IDX_CHANGED:{var w=l.bucketIndex;return w<0||w>=this.getBucketCount()?k:babelHelpers['extends']({},k,{selectedBucketIndex:w})}case c('FBStoriesActionTypes').SELECTED_THREAD_IDX_CHANGED:var x=this.getThreadCountForSelectedBucket();if(!this.isSelectedBucketLive()&&(l.index<0||l.index>=x))return k;var y=new (c('Map'))(k.lastViewedThreadIndexForBucket);y.set(this.getSelectedBucketIndex(),l.index);return babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:y,currentThreadIndex:l.index});case c('FBStoriesActionTypes').SELECTED_THREAD_PERCENT_DONE:var z=Math.min(100,Math.max(l.percentDone,0));return babelHelpers['extends']({},k,{currentThreadPercentDone:z});case c('FBStoriesActionTypes').SET_ALL_BUCKETS_VIEWED:var aa=l.value;if(aa===k.allBucketsViewed)return k;return babelHelpers['extends']({},k,{allBucketsViewed:aa,unseenMode:k.unseenMode&&aa?false:k.unseenMode});case c('FBStoriesActionTypes').SET_UNSEEN_MODE:return babelHelpers['extends']({},k,{unseenMode:l.value});case c('FBStoriesActionTypes').UPDATE_THREAD_SEEN_OPTIMISTIC:var ba=this.getSelectedBucketId(),ca=this.getFriendsBucketData().map(function(ja){var ka,la=this;if(c('FBStoriesBucketHelper').getId(ja)===ba){var ka=function(){var ma=c('FBStoriesBucketHelper').getUnseenCount(ja),na=la.$FBStoriesStore3(ja).map(function(pa){if(c('FBStoriesThreadHelper').getId(pa)===l.threadID){if(!c('FBStoriesThreadHelper').isSeenByViewer(pa))ma=Math.max(ma-1,0);var qa=babelHelpers['extends']({},pa);c('FBStoriesThreadHelper').setIsSeenByViewer(qa,true);return qa}else return pa;}),oa=babelHelpers['extends']({},ja);c('FBStoriesBucketHelper').setUnseenCount(oa,ma);c('FBStoriesBucketHelper').setThreads(oa,na);return {v:oa}}();if(typeof ka==="object")return ka.v;}else return ja;}.bind(this));return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:ca})});case c('FBStoriesActionTypes').UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:{var da=babelHelpers['extends']({},this.getUserBucketData(),{threads:{nodes:this.$FBStoriesStore2().map(function(ja){if(c('FBStoriesThreadHelper').getId(ja)===l.threadID){var ka=babelHelpers['extends']({},ja);c('FBStoriesThreadHelper').setSeenReceiptsLastSeenTime(ka,Date.now());c('FBStoriesThreadHelper').setSeenReceiptsUnseenCount(ka,0);return ka}else return ja;})}});return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:da,userInfo:this.getUserInfo(),friendsBucketData:this.getFriendsBucketData()})})}case c('FBStoriesActionTypes').DELETE_THREAD_FROM_BUCKET:{var p=function(){var ja=l.threadID,ka=l.bucketID;if(!n.isUserManagedThread(ja,ka))return {v:k};var la=n.getUserBucketData(),ma=null;if(ka===c('FBStoriesBucketHelper').getId(la)){c('FBStoriesBucketHelper').setThreads(la,n.$FBStoriesStore3(la).filter(function(oa){return c('FBStoriesThreadHelper').getId(oa)!==ja}));ma=n.getFriendsBucketData()}else ma=n.getFriendsBucketData().map(function(oa){if(c('FBStoriesBucketHelper').getId(oa)===ka){var pa=this.$FBStoriesStore3(oa).filter(function(ra){return c('FBStoriesThreadHelper').getId(ra)!==ja}),qa=babelHelpers['extends']({},oa);c('FBStoriesBucketHelper').setThreads(qa,pa);return qa}else return oa;}.bind(n)).filter(function(oa){return this.$FBStoriesStore3(oa).length>0}.bind(n));var na=k.lastViewedThreadIndexForBucket;if(ja===n.getCurrentThreadIDForSelectedBucket()){na=new (c('Map'))(na);na.set(n.getSelectedBucketIndex(),undefined)}return {v:babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:na,data:c('LoadObject').withValue({userBucketData:la,friendsBucketData:ma,userInfo:n.getUserInfo()})})}}();if(typeof p==="object")return p.v;}case c('FBStoriesActionTypes').REMOVE_BUCKET:{var q=function(){var ja=l.bucketID,ka=n.getFriendsBucketData().filter(function(la){return c('FBStoriesBucketHelper').getId(la)!==ja});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),friendsBucketData:ka,userInfo:n.getUserInfo()})})}}();if(typeof q==="object")return q.v;}case c('FBStoriesActionTypes').SET_SATP_NATIVE_RENDER:return babelHelpers['extends']({},k,{showSATPNativeRender:l.value});case c('FBStoriesLiveVideoActionTypes').LIVE_BUCKET_LOADED:{var ea=l.data,fa=c('FBStoriesDataHelper').getFriendsBucketDataFromLoadedObject(ea),ga=[].concat(this.getFriendsBucketData()),ha=fa.reduce(function(ja,ka){if(this.$FBStoriesStore4(ka)&&this.getBucketIndexByBucketId(c('FBStoriesBucketHelper').getId(ka))===-1)ja.push(ka);return ja}.bind(this),ga);return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:ha})})}case c('FBStoriesActionTypes').REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:{var r=function(){var ja=l.bucketID,ka=n.getFriendsBucketData().map(function(la){if(c('FBStoriesBucketHelper').getId(la)===ja){c('FBStoriesBucketHelper').setLiveVideo(la,null);c('FBStoriesBucketHelper').setHasLiveVideoEnded(la,false)}return la});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),friendsBucketData:ka,userInfo:n.getUserInfo()})})}}();if(typeof r==="object")return r.v;}case c('FBStoriesActionTypes').SET_IS_COMMERCIAL_BREAK_RUNNING:{var ia=new (c('Map'))(this.getState().isCommercialBreakRunning);return babelHelpers['extends']({},k,{isCommercialBreakRunning:ia.set(l.videoID,l.isCommercialBreakRunning)})}case c('FBStoriesActionTypes').UNSELECT_BUCKET:return babelHelpers['extends']({},k,{selectedBucketIndex:-1});default:return k;}};j.prototype.$FBStoriesStore5=function(){var k=this.getState().data;return k.hasValue()?k.getValueEnforcing():{friendsBucketData:[],userBucketData:c('FBStoriesBucketHelper').getDefaultBucket(),userInfo:{}}};j.prototype.getUserBucketData=function(){return this.$FBStoriesStore5().userBucketData||{}};j.prototype.getUserInfo=function(){return this.$FBStoriesStore5().userInfo||{}};j.prototype.getFriendsBucketData=function(){return this.$FBStoriesStore5().friendsBucketData||[]};j.prototype.isLoading=function(){return this.getState().data.isLoading()};j.prototype.getBucketIds=function(){var k=this.getFriendsBucketData().map(function(m){return m.id?m.id:''}),l=this.getUserBucketData().id||'';return [l].concat(k)};j.prototype.getSelectedBucketIndex=function(){return this.getState().selectedBucketIndex};j.prototype.getSelectedBucketId=function(){return this.getBucketIds()[this.getSelectedBucketIndex()]};j.prototype.areAllBucketsViewed=function(){return this.getState().allBucketsViewed};j.prototype.getCameraPostTypeForBucketId=function(k){return c('FBStoriesBucketHelper').getCameraPostType(this.$FBStoriesStore6(k))};j.prototype.doesBucketContainThreadId=function(k,l){var m=this.$FBStoriesStore6(k),n=c('FBStoriesBucketHelper').getThreads(m);return n.find(function(o){return c('FBStoriesThreadHelper').getId(o)===l})!==undefined};j.prototype.$FBStoriesStore6=function(k){return this.$FBStoriesStore7(this.getBucketIndexByBucketId(k))};j.prototype.getBucketIndexByBucketId=function(k){return this.getBucketIds().indexOf(k)};j.prototype.getSelectedBucketCameraPostType=function(){return c('FBStoriesBucketHelper').getCameraPostType(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwner=function(){return c('FBStoriesBucketHelper').getOwner(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwnerID=function(){return c('FBStoriesBucketHelper').getOwnerId(this.$FBStoriesStore1())};j.prototype.getSelectedBucketUnseenCount=function(){return c('FBStoriesBucketHelper').getUnseenCount(this.$FBStoriesStore1())};j.prototype.getThreadsForSelectedBucket=function(){return this.$FBStoriesStore3(this.$FBStoriesStore1())};j.prototype.getCurrentThreadIndexForSelectedBucket=function(){return this.getState().currentThreadIndex};j.prototype.getCurrentThreadIDForSelectedBucket=function(){return c('FBStoriesThreadHelper').getId(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadCameraPostTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?c('CameraPostTypes').STORY:c('FBStoriesThreadHelper').getCameraPostType(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?c('BackstageMediaType').LIVE:c('FBStoriesThreadHelper').getMediaType(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaIDForSelectedBucket=function(){if(this.isSelectedBucketLive()){var k=this.getThreadDataForLive();return k&&k.media.id}return c('FBStoriesThreadHelper').getMediaId(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaViewerCountForSelectedBucket=function(){var k=this.getCurrentThreadForSelectedBucket();return c('FBStoriesThreadHelper').getFollowersSeenCount(k)+c('FBStoriesThreadHelper').getFriendsSeenCount(k)};j.prototype.getCurrentThreadForSelectedBucket=function(){return this.getThreadsForSelectedBucket()[this.getCurrentThreadIndexForSelectedBucket()]};j.prototype.getCurrentThreadData=function(){if(this.isSelectedBucketLive())return this.getThreadDataForLive();return this.$FBStoriesStore8(this.getState().currentThreadIndex)};j.prototype.shouldDisableReply=function(){var k=this.isOwnThread(),l=c('FBStoriesBucketHelper').isViewerFriendOfOwner(this.$FBStoriesStore1()),m=c('FBStoriesThreadHelper').isViewerFriendOfOwner(this.getCurrentThreadForSelectedBucket());return k||!l&&!m||this.isSelectedBucketLive()};j.prototype.getFollowersSeenCount=function(){return c('FBStoriesThreadHelper').getFollowersSeenCount(this.getCurrentThreadForSelectedBucket())};j.prototype.getFriendsSeenCount=function(){return c('FBStoriesThreadHelper').getFriendsSeenCount(this.getCurrentThreadForSelectedBucket())};j.prototype.isOwnBucket=function(k){return (k!=undefined?k:this.getSelectedBucketId())===c('FBStoriesBucketHelper').getId(this.getUserBucketData())};j.prototype.isOwnThread=function(){if(this.isOwnBucket())return true;var k=this.getCurrentThreadForSelectedBucket(),l=c('FBStoriesThreadHelper').getOwnerId(k);return l===this.getUserInfo().userID};j.prototype.isBucketViewerEventHost=function(){var k=this.$FBStoriesStore1();return c('FBStoriesBucketHelper').isViewerEventHost(k)};j.prototype.isUserManagedThread=function(k,l){var m=this.$FBStoriesStore6(l);if(!m)return false;var n=this.$FBStoriesStore9(k,m),o=c('FBStoriesThreadHelper').getOwnerId(n);return n&&(o===this.getUserInfo().userID||c('FBStoriesBucketHelper').getId(m)===c('FBStoriesBucketHelper').getId(this.getUserBucketData())||c('FBStoriesBucketHelper').isViewerEventHost(m))||false};j.prototype.getBucketCount=function(){return this.getFriendsBucketData().length+1};j.prototype.hasDataInSelectedBucket=function(){return c('FBStoriesBucketHelper').hasData(this.$FBStoriesStore1())};j.prototype.hasOwnBucketViewers=function(){if(this.userBucketIsLive())return false;var k=this.$FBStoriesStore2(),l=k.filter(function(m){return c('FBStoriesThreadHelper').getSeenReceiptsUnseenCount(m)>0});return l.length>0};j.prototype.hasOwnBucketContent=function(){return this.$FBStoriesStore2().length>0||this.userBucketIsLive()};j.prototype.getThreadCountForSelectedBucket=function(){return this.getThreadsForSelectedBucket().length};j.prototype.userBucketIsLive=function(){return this.$FBStoriesStore4(this.getUserBucketData())};j.prototype.isSelectedBucketLive=function(){return this.$FBStoriesStore4(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwnerType=function(){return c('FBStoriesBucketHelper').getLoggingType(this.$FBStoriesStore1())};j.prototype.$FBStoriesStore4=function(k){return c('FBStoriesBucketHelper').isLive(k)};j.prototype.getCurrentThreadViewers=function(){if(!this.isOwnThread())return [];var k=this.getCurrentThreadForSelectedBucket(),l=c('FBStoriesThreadHelper').getViewers(k),m=this.getUserInfo().userID;return l.reduce(function(n,o){var p=c('FBStoriesThreadHelper').getStoryViewerId(o),q=c('FBStoriesThreadHelper').getStoryViewerSeenTime(o);if(p!==m)n.push(babelHelpers['extends']({},o.node,{seenTime:q,isNewViewer:q>=c('FBStoriesThreadHelper').getSeenReceiptsLastSeenTime(k)}));return n},[])};j.prototype.isUnseenMode=function(){return this.getState().unseenMode};j.prototype.getCurrentThreadPercentDone=function(){return this.getState().currentThreadPercentDone};j.prototype.getThreadCount=function(k){var l=this.$FBStoriesStore7(k);if(this.$FBStoriesStore4(l))return 0;if(k===0){var m=this.$FBStoriesStore3(this.getUserBucketData());return m.length}if(k>0){var n=this.$FBStoriesStore3(l);return n.length}return -1};j.prototype.getUnseenThreadIndex=function(k){return c('FBStoriesBucketHelper').getUnseenThreadIndex(this.$FBStoriesStore7(k))};j.prototype.getAllowedNavigationType=function(){var k=this.getSelectedBucketIndex(),l=k===0||k==1&&!c('FBStoriesBucketHelper').hasData(this.getUserBucketData()),m=k===this.getBucketCount()-1,n=l&&this.getCurrentThreadIndexForSelectedBucket()==0,o=m&&this.getCurrentThreadIndexForSelectedBucket()===this.getThreadsForSelectedBucket().length-1;if(n)return 'NEXT_ONLY';if(o)return 'PREV_ONLY';return 'BOTH'};j.prototype.getLastSeenThreadIndexForBucket=function(k){var l=this.getState().lastViewedThreadIndexForBucket,m=l.get(k);return m==undefined?0:m};j.prototype.$FBStoriesStore2=function(){return this.$FBStoriesStore3(this.getUserBucketData())};j.prototype.$FBStoriesStore1=function(){return this.$FBStoriesStore7(this.getSelectedBucketIndex())};j.prototype.$FBStoriesStore7=function(k){var l;return k===0?this.getUserBucketData():(l=this.getFriendsBucketData())!=null?l[k-1]:l};j.prototype.$FBStoriesStore9=function(k,l){var m=this.$FBStoriesStore3(l),n=m.filter(function(o){return o.id===k});return n.length>0?n[0]:null};j.prototype.$FBStoriesStore3=function(k){return c('FBStoriesBucketHelper').getThreads(k)};j.prototype.$FBStoriesStore8=function(k){var l=this.getSelectedBucketOwner(),m=this.getThreadsForSelectedBucket()[k];if(!m)return null;var n=c('FBStoriesThreadHelper').getMedia(m),o=c('FBStoriesThreadHelper').getWWWTextFormatMetadata(m),p=c('FBStoriesThreadHelper').getMessageText(m);return {isLive:false,media:n,bucketOwner:l,threadOwner:c('FBStoriesThreadHelper').getOwner(m)||{name:null,id:null,is_viewer_friend:false,profile_picture:null},participants:[],isSeen:c('FBStoriesThreadHelper').isSeenByViewer(m),latestMessageID:c('FBStoriesThreadHelper').getLatestMessageID(m),time:c('FBStoriesThreadHelper').getTime(m),threadID:c('FBStoriesThreadHelper').getId(m),cameraPostType:c('FBStoriesThreadHelper').getCameraPostType(m),cameraPostSource:c('FBStoriesThreadHelper').getCameraPostSource(m),wwwTextFormatMetadata:o,messageText:p}};j.prototype.getThreadDataForLive=function(){var k=this.$FBStoriesStore1();if(!k)return null;var l=c('FBStoriesBucketHelper').getLiveVideo(k);if(!l||!this.$FBStoriesStore4(k))return null;var m=this.getSelectedBucketOwner();return {isLive:true,media:l,bucketOwner:m,isSeen:false,cameraPostType:c('FBStoriesBucketHelper').getCameraPostType(k)}};j.prototype.isSelectedBucketLiveAndEnded=function(){return this.isSelectedBucketLive()&&c('FBStoriesBucketHelper').hasLiveVideoEnded(this.$FBStoriesStore1())};j.prototype.getSATPNativeRender=function(){return this.getState().showSATPNativeRender};j.prototype.getIsCommercialBreakRunning=function(k){return !!this.getState().isCommercialBreakRunning.get(k)};function j(){h.apply(this,arguments)}f.exports=new j(c('FBStoriesDispatcher'))}),null);
__d('FBStoriesAppController',['Bootloader','FBStoriesGraphQLAPI','FBStoriesDispatcher','FBStoriesActionTypes','FBStoriesDataHelper','idx','Visibility','FBStoriesStore'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBStoriesDispatcher').dispatch;f.exports={init:function i(j){c('FBStoriesDispatcher').explicitlyRegisterStores([c('FBStoriesStore')]);h({type:c('FBStoriesActionTypes').LOADING});var k=j.preloader;k.onLoaded(function(l){var m=l.result,n=c('FBStoriesDataHelper').getBucketsDataFromLoadedObject(m.data);c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(o){o.logStoryTrayLoad(n)},'FBStoriesAppController');h({type:c('FBStoriesActionTypes').LOADED,data:n})});k.onError(function(l){return h({type:c('FBStoriesActionTypes').LOADED_ERROR,error:l})});c('FBStoriesGraphQLAPI').subscribeToTrayChanges(function(l){var m;h({type:c('FBStoriesActionTypes').SUBSCRIPTION_BUCKET_UPDATE,bucketData:(m=l)!=null?(m=m.stories_tray_subscribe)!=null?m.bucket:m:m})});c('Visibility').addListener(c('Visibility').VISIBLE,function(){c('FBStoriesGraphQLAPI').load().done(function(l){var m=c('FBStoriesDataHelper').getBucketsDataFromLoadedObject(l);h({type:c('FBStoriesActionTypes').LOADED,data:m})},function(l){return h({type:c('FBStoriesActionTypes').LOADED_ERROR,error:l})})});h({type:c('FBStoriesActionTypes').SET_SATP_NATIVE_RENDER,value:j.showSATPNativeRender})}}}),null);
__d('FBStoryTrayItem.react',['ix','cx','fbt','CameraPostTypes','Image.react','Tooltip.react','React','fbglyph','emptyFunction','IntlVariations','XUISpinner.react'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;k=babelHelpers.inherits(m,c('React').Component);l=k&&k.prototype;function m(n){l.constructor.call(this,n);this.$FBStoryTrayItem1=function(){if(!this.state.didUserInteract)this.setState({didUserInteract:true});if(this.props.onHover)this.props.onHover(this.props.bucketID);}.bind(this);this.$FBStoryTrayItem2=function(){if(this.props.onHoverOut)this.props.onHoverOut(this.props.bucketID);}.bind(this);this.$FBStoryTrayItem3=function(){if(!this.props.disabled&&!this.props.loading)this.props.onSelect(this.props.bucketID);}.bind(this);this.state={didUserInteract:!n.renderTooltipOnHover}}m.prototype.render=function(){if(!this.props.bucketID)return null;var n=this.props.cameraPostType===c('CameraPostTypes').EVENT_STORY,o=this.props.isBucketLive,p=!!this.props.imageUrl,q=!n&&!o,r="_1fw9"+(this.props.highlighted?' '+"_1fw0":'')+(o?' '+"_erm":'')+(p?' '+"_1fwa":''),s=p?c('React').createElement(c('Image.react'),{src:this.props.imageUrl,className:"_1fwb"}):null,t=q&&this.props.secondaryImageUrl?c('React').createElement(c('Image.react'),{src:this.props.secondaryImageUrl,className:"_1fwc"}):null,u=c('React').createElement('div',{className:"_1464"}),v=p?c('React').createElement('div',{className:"_1dbr"},u):c('React').createElement('div',{className:"_1fwb"+(' '+"_144-")},u),w=c('React').createElement('div',{className:r},s,this.props.showBlueIndicator&&c('React').createElement('div',{className:"_3xlk"}),n&&v,this.props.loading&&c('React').createElement('div',{className:"_1dbr"},c('React').createElement(c('XUISpinner.react'),{background:p?'light':'dark',className:"_1dbs"})),o&&c('React').createElement('div',{className:"_ern"},c('React').createElement(c('Image.react'),{alt:j._("LIVE"),src:h("118398")})),t),x=c('React').createElement('div',{className:"_efz"},c('React').createElement('span',{className:"_ef_"},j._("Your Story"))),y=c('React').createElement('div',{className:"_1fw3"},this.props.actorName),z=c('IntlVariations').GENDER_UNKNOWN;if(this.props.actorGender=='MALE'){z=c('IntlVariations').GENDER_MALE}else if(this.props.actorGender=='FEMALE')z=c('IntlVariations').GENDER_FEMALE;var aa=this.props.isOwnBucket?j._("Watch Your Story"):j._({"*":"Watch {actor name}'s Story"},[j.param('actor name',this.props.actorName,[1,z])]),ba=this.props.isOwnBucket?x:y,ca=this.state.didUserInteract?c('React').createElement(c('Tooltip.react'),{tooltip:aa,alignH:'center'},w,ba):c('React').createElement('div',null,w,ba);return c('React').createElement('div',{role:'button',tabIndex:'0',onMouseEnter:this.$FBStoryTrayItem1,onMouseLeave:this.$FBStoryTrayItem2,onClick:this.$FBStoryTrayItem3,onKeyPress:this.$FBStoryTrayItem3,className:"_1fvw"+(this.props.disabled?' '+"_4lu8":'')},ca)};m.defaultProps={disabled:false,actorName:'',actorGender:'',highlighted:false,showBlueIndicator:false,isOwnBucket:false,isBucketLive:false,onHover:c('emptyFunction'),onHoverOut:c('emptyFunction'),loading:false,renderTooltipOnHover:false};f.exports=m}),null);
__d("range",[],(function a(b,c,d,e,f,g){function h(i,j,k){k=!k?i<j?1:-1:k;var l=-1,m=Math.max(Math.ceil((j-i)/k),0),n=Array(m);while(m--){n[++l]=i;i+=k}return n}f.exports=h}),null);
__d('FixedWidthHorizontalScroll.react',['ix','cx','fbt','asset','compactArray','emptyFunction','range','Bootloader','BootloadOnRender.react','Image.react','JSResource','LazyComponent.react','React'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=400;k=babelHelpers.inherits(n,c('React').Component);l=k&&k.prototype;function n(o){l.constructor.call(this,o);this.defaultProps={placeholderFactory:c('emptyFunction')};this.$FixedWidthHorizontalScroll7=function(){if(!this.state.scrolling&&this.$FixedWidthHorizontalScroll1)this.setState({scrollLeft:this.$FixedWidthHorizontalScroll1.scrollLeft});}.bind(this);var p=o.itemWidth,q=o.width,r=o.itemMarginWidth,s=0;if(p<=q)s=1+Math.floor((q-p)/(p+r));var t=this.$FixedWidthHorizontalScroll4(o),u=this.$FixedWidthHorizontalScroll5(o,t);this.state={viewportItemsCount:s,itemCount:t,scrollWidth:u,scrolling:false,scrollLeft:0};this.$FixedWidthHorizontalScroll2=this.$FixedWidthHorizontalScroll2.bind(this);this.$FixedWidthHorizontalScroll3=this.$FixedWidthHorizontalScroll3.bind(this)}n.prototype.componentDidUpdate=function(o,p){if(p.scrollLeft!==this.state.scrollLeft)if(this.$FixedWidthHorizontalScroll1){c('Bootloader').loadModules(["Animation","Ease"],function(q,r){new q(this.$FixedWidthHorizontalScroll1).duration(m).ease(r.circOut).ondone(function(){this.setState({scrolling:false})}.bind(this)).to('scrollLeft',this.state.scrollLeft).go()}.bind(this),'FixedWidthHorizontalScroll.react');this.setState({scrolling:true})}};n.prototype.componentWillUpdate=function(o,p){var q=this.$FixedWidthHorizontalScroll4(o),r=this.$FixedWidthHorizontalScroll5(o,q);if(q!=this.state.itemCount)this.setState({itemCount:q,scrollWidth:r});};n.prototype.$FixedWidthHorizontalScroll4=function(o){var p=o.children?c('compactArray')(c('React').Children.toArray(o.children)):[];return p.length};n.prototype.$FixedWidthHorizontalScroll5=function(o,p){return p*(o.itemWidth+o.itemMarginWidth)};n.prototype.render=function(){var o=this.state.scrollLeft===0,p=this.state.scrollLeft>=this.$FixedWidthHorizontalScroll6()||this.state.itemCount<=this.state.viewportItemsCount,q=c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the left"),className:"_1rk2"+(' '+"_6107"),'data-testid':'horizontalScroll/leftArrow',href:{url:'#'},image:c('React').createElement(c('Image.react'),{src:h("374382")}),label:'With a Hidden Label',labelIsHidden:true,onClick:this.$FixedWidthHorizontalScroll2}),loader:c('JSResource')('XUIButton.react').__setRef('FixedWidthHorizontalScroll.react'),placeholder:c('React').createElement('span',null)}),r=c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the right"),className:"_1rkd"+(' '+"_6107"),'data-testid':'horizontalScroll/rightArrow',href:{url:'#'},image:c('React').createElement(c('Image.react'),{src:h("374391")}),label:'With a Hidden Label',labelIsHidden:true,onClick:this.$FixedWidthHorizontalScroll3}),loader:c('JSResource')('XUIButton.react').__setRef('FixedWidthHorizontalScroll.react'),placeholder:c('React').createElement('span',null)});return c('React').createElement('div',{className:"_lmj"+(this.state.scrolling?' '+"_3_9y":''),onScroll:this.$FixedWidthHorizontalScroll7,ref:function(s){return this.$FixedWidthHorizontalScroll1=s}.bind(this)},this.props.children,this.$FixedWidthHorizontalScroll8(),!o&&q,!p&&r)};n.prototype.$FixedWidthHorizontalScroll6=function(){return this.state.scrollWidth-this.props.width-this.props.itemMarginWidth};n.prototype.$FixedWidthHorizontalScroll8=function(){var o=Math.max(0,this.state.viewportItemsCount-this.state.itemCount);return c('range')(0,o).map(this.props.placeholderFactory)};n.prototype.$FixedWidthHorizontalScroll9=function(o){var p=this.state.viewportItemsCount*(this.props.itemWidth+this.props.itemMarginWidth),q=this.$FixedWidthHorizontalScroll6(),r=o?q-(this.state.scrollLeft+p):this.state.scrollLeft-p;return r<this.props.itemWidth?q:p};n.prototype.$FixedWidthHorizontalScroll2=function(){var o=Math.max(0,this.$FixedWidthHorizontalScroll1.scrollLeft-this.$FixedWidthHorizontalScroll9(false));this.setState({scrollLeft:o})};n.prototype.$FixedWidthHorizontalScroll3=function(){var o=Math.min(this.$FixedWidthHorizontalScroll6(),this.$FixedWidthHorizontalScroll1.scrollLeft+this.$FixedWidthHorizontalScroll9(true));this.setState({scrollLeft:o})};f.exports=n}),null);
__d('HorizontalScroll.react',['ix','cx','fbt','asset','compactArray','emptyFunction','range','Bootloader','BootloadOnRender.react','Image.react','JSResource','LazyComponent.react','React'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=400;k=babelHelpers.inherits(n,c('React').Component);l=k&&k.prototype;function n(o){l.constructor.call(this,o);this.defaultProps={placeholderFactory:c('emptyFunction')};this.$HorizontalScroll5=function(){if(!this.state.scrolling&&this.$HorizontalScroll1)this.setState({scrollLeft:this.$HorizontalScroll1.scrollLeft});}.bind(this);this.state={itemCount:0,offsetWidth:0,scrolling:false,scrollLeft:0,scrollWidth:0,viewportItemsCount:0};this.$HorizontalScroll2=this.$HorizontalScroll2.bind(this);this.$HorizontalScroll3=this.$HorizontalScroll3.bind(this)}n.prototype.componentDidMount=function(){var o=this.props.itemMarginWidth,p=this.props.itemWidth,q=this.$HorizontalScroll1.offsetWidth,r=0;if(p<=q)r=1+Math.floor((q-p)/(p+o));this.setState({offsetWidth:q,scrollLeft:this.$HorizontalScroll1.scrollLeft,scrollWidth:this.$HorizontalScroll1.scrollWidth,viewportItemsCount:r})};n.prototype.componentDidUpdate=function(o,p){if(p.scrollLeft!==this.state.scrollLeft)if(this.$HorizontalScroll1){c('Bootloader').loadModules(["Animation","Ease"],function(q,r){new q(this.$HorizontalScroll1).duration(m).ease(r.circOut).ondone(function(){this.setState({scrolling:false})}.bind(this)).to('scrollLeft',this.state.scrollLeft).go()}.bind(this),'HorizontalScroll.react');this.setState({scrolling:true})}};n.prototype.componentWillUpdate=function(o,p){var q=o.children?c('compactArray')(c('React').Children.toArray(o.children)):[],r=q.length;if(r!=this.state.itemCount)this.setState({itemCount:r});};n.prototype.render=function(){var o=this.state.scrollLeft===0,p=this.state.scrollLeft>=this.$HorizontalScroll4()||this.state.itemCount<=this.state.viewportItemsCount,q=c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the left"),className:"_1rk2"+(' '+"_6107"),'data-testid':'horizontalScroll/leftArrow',href:{url:'#'},image:c('React').createElement(c('Image.react'),{src:h("374382")}),label:'With a Hidden Label',labelIsHidden:true,onClick:this.$HorizontalScroll2}),loader:c('JSResource')('XUIButton.react').__setRef('HorizontalScroll.react'),placeholder:c('React').createElement('span',null)}),r=c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the right"),className:"_1rkd"+(' '+"_6107"),'data-testid':'horizontalScroll/rightArrow',href:{url:'#'},image:c('React').createElement(c('Image.react'),{src:h("374391")}),label:'With a Hidden Label',labelIsHidden:true,onClick:this.$HorizontalScroll3}),loader:c('JSResource')('XUIButton.react').__setRef('HorizontalScroll.react'),placeholder:c('React').createElement('span',null)});return c('React').createElement('div',{className:"_lmj"+(this.state.scrolling?' '+"_3_9y":''),onScroll:this.$HorizontalScroll5,ref:function(s){return this.$HorizontalScroll1=s}.bind(this)},this.props.children,this.$HorizontalScroll6(),!o&&q,!p&&r)};n.prototype.$HorizontalScroll4=function(){return this.state.scrollWidth-this.state.offsetWidth-this.props.itemMarginWidth};n.prototype.$HorizontalScroll6=function(){var o=Math.max(0,this.state.viewportItemsCount-this.state.itemCount);return c('range')(0,o).map(this.props.placeholderFactory)};n.prototype.$HorizontalScroll7=function(o){var p=this.state.viewportItemsCount*(this.props.itemWidth+this.props.itemMarginWidth),q=this.$HorizontalScroll4(),r=o?q-(this.state.scrollLeft+p):this.state.scrollLeft-p;return r<this.props.itemWidth?q:p};n.prototype.$HorizontalScroll2=function(){var o=Math.max(0,this.$HorizontalScroll1.scrollLeft-this.$HorizontalScroll7(false));this.setState({scrollLeft:o})};n.prototype.$HorizontalScroll3=function(){var o=Math.min(this.$HorizontalScroll4(),this.$HorizontalScroll1.scrollLeft+this.$HorizontalScroll7(true));this.setState({scrollLeft:o})};f.exports=n}),null);
__d('FBStoriesTray.react',['cx','React','emptyFunction','CameraPostTypes','FBStoriesBucketHelper','FBStoriesThreadHelper','FBStoryTrayItem.react','HorizontalScroll.react','FixedWidthHorizontalScroll.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=52,l=284,m=6;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){var o=this.props,p=o.userBucket,q=o.friendsData,r=o.userBucketHasNewViewers,s=o.userBucketHasContent,t=o.userBucketIsLive,u=!q||q.length===0;if(u&&!s)return null;var v=c('FBStoriesBucketHelper').getOwnerProfilePictureUri(p),w=c('FBStoriesBucketHelper').getPreviewImage(p),x=c('FBStoriesBucketHelper').getCameraPostType(p),y=c('FBStoriesBucketHelper').getId(p),z=this.props.showAsPreviews&&!t,aa=[s?c('React').createElement(c('FBStoryTrayItem.react'),{renderTooltipOnHover:this.props.renderPerf,highlighted:r,showBlueIndicator:r,bucketID:y,key:y,imageUrl:z?w:v,secondaryImageUrl:z?v:null,isOwnBucket:true,isBucketLive:t,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:x,loading:this.props.loadingBucketID===y}):null].concat(this.$FBStoriesTray1());if(this.props.renderPerf)return c('React').createElement(c('FixedWidthHorizontalScroll.react'),{itemWidth:k,width:l,itemMarginWidth:m,placeholderFactory:this.$FBStoriesTray2},aa);return c('React').createElement(c('HorizontalScroll.react'),{itemWidth:k,itemMarginWidth:m,placeholderFactory:this.$FBStoriesTray2},aa)};n.prototype.$FBStoriesTray2=function(o){return c('React').createElement('div',{key:o,className:"_1fvw"},c('React').createElement('div',{className:"_rqg"}))};n.prototype.$FBStoriesTray1=function(){return this.props.friendsData.map(function(o,p){var q=c('FBStoriesBucketHelper').getId(o);if(!q)return null;var r=c('FBStoriesBucketHelper').getCameraPostType(o),s=c('FBStoriesBucketHelper').getOwnerId(o),t=c('FBStoriesBucketHelper').getOwnerName(o);if(!s||!t)return null;var u=r===c('CameraPostTypes').EVENT_STORY,v=c('FBStoriesBucketHelper').isLive(o),w=c('FBStoriesBucketHelper').getOwnerProfilePictureUri(o),x=void 0,y=void 0;if(u){x=c('FBStoriesBucketHelper').getOwnerCoverPhotoUri(o);y=null}else if(this.props.showAsPreviews&&!v){x=c('FBStoriesBucketHelper').getPreviewImage(o);y=w}else{x=w;y=null}var z=c('FBStoriesBucketHelper').getThreads(o),aa=z.filter(function(ca){return !c('FBStoriesThreadHelper').isSeenByViewer(ca)}).length>0,ba={bucketID:q,actorName:t,actorGender:c('FBStoriesBucketHelper').getOwnerGender(o),imageUrl:x,secondaryImageUrl:y,highlighted:aa,isBucketLive:v,key:s,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:r,loading:this.props.loadingBucketID===q,renderTooltipOnHover:this.props.renderPerf};return c('React').createElement(c('FBStoryTrayItem.react'),ba)}.bind(this))};function n(){i.apply(this,arguments)}n.defaultProps={onItemHover:c('emptyFunction'),onItemHoverOut:c('emptyFunction'),loadingBucketID:null,renderPerf:false};f.exports=n}),null);
__d('FBStoriesTrayHeader.react',['ix','cx','fbt','React','Tooltip.react','Image.react','fbglyph'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;k=babelHelpers.inherits(m,c('React').Component);l=k&&k.prototype;function m(n){l.constructor.call(this,n);this.$FBStoriesTrayHeader1=function(){if(!this.state.didUserInteract)this.setState({didUserInteract:true});}.bind(this);this.state={didUserInteract:!this.props.renderTooltipOnHover}}m.prototype.render=function(){var n=c('React').createElement(c('Image.react'),{onMouseOver:this.$FBStoriesTrayHeader1,className:"_2ms3",src:h("126682")}),o=!this.state.didUserInteract?n:c('React').createElement(c('Tooltip.react'),{tooltip:j._("Stories are photos and videos that only last temporarily. When a friend shares to their story, it'll appear here.")},n);return c('React').createElement('div',{className:"_2mro"},c('React').createElement('span',{className:"_2ms2"},j._("Stories")),o)};f.exports=m}),null);
__d('FBStoriesTrayContainer.react',['cx','React','Bootloader','FBStoriesBucketHelper','FBStoriesTray.react','FBStoriesTrayHeader.react','FBStoriesStore','FluxContainer','BootloadOnRender.react','LazyComponent.react','JSResource','range'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k,l;i=babelHelpers.inherits(m,c('React').PureComponent);j=i&&i.prototype;function m(p){j.constructor.call(this,p);this.$FBStoriesTrayContainer3=function(){if(!this.state.isViewerOpen)return;c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(q){q.storyLog('closeStory','closeFromClickingOnModal');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer4=function(){c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(q){q.storyLog('closeStory','closeFromClickingOnModalClose');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer5=function(){c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(q){q.storyLog('closeStory','closeFromLastStoryFinishing');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer2=function(q){this.setState({showItemLoader:true});c('Bootloader').loadModules(["FBStoriesActions","FBStoriesLoggingHelper"],function(r,s){r.userSelectedBucket(q);s.storyLog('openStory','openFromStoryHead');this.setState({isViewerOpen:true,showItemLoader:false})}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer6=function(){this.setState({isStoryMuted:!this.state.isStoryMuted})}.bind(this);this.state={friendsData:[],userBucket:c('FBStoriesBucketHelper').getDefaultBucket(),userBucketHasNewViewers:false,userBucketHasContent:false,loading:true,currentThreadID:null,isViewerOpen:false,showItemLoader:false,isStoryMuted:false,userBucketIsLive:false,selectedBucketIsLive:false,bucketID:null}}m.getStores=function(){return [c('FBStoriesStore')]};m.calculateState=function(p){return {userBucket:c('FBStoriesStore').getUserBucketData(),userBucketHasNewViewers:c('FBStoriesStore').hasOwnBucketViewers(),userBucketHasContent:c('FBStoriesStore').hasOwnBucketContent(),friendsData:c('FBStoriesStore').getFriendsBucketData(),loading:c('FBStoriesStore').isLoading(),currentThreadID:c('FBStoriesStore').getCurrentThreadIDForSelectedBucket(),isOwnBucket:c('FBStoriesStore').isOwnBucket(),userBucketIsLive:c('FBStoriesStore').userBucketIsLive(),bucketID:c('FBStoriesStore').getSelectedBucketId(),selectedBucketIsLive:c('FBStoriesStore').isSelectedBucketLive()}};m.prototype.render=function(){if(this.state.loading)return c('React').createElement('div',{className:"_60kg"},c('React').createElement(c('FBStoriesTrayHeader.react'),{renderTooltipOnHover:this.props.renderPerf}),c('React').createElement(o,null));if(this.$FBStoriesTrayContainer1())c('React').createElement('div',{className:"_60kg"});return c('React').createElement('div',{className:"_60kg"},c('React').createElement(c('FBStoriesTrayHeader.react'),{renderTooltipOnHover:this.props.renderPerf}),c('React').createElement(c('FBStoriesTray.react'),{showAsPreviews:this.props.showAsPreviews,renderPerf:this.props.renderPerf,friendsData:this.state.friendsData,userBucket:this.state.userBucket,userBucketHasContent:this.state.userBucketHasContent,userBucketHasNewViewers:this.state.userBucketHasNewViewers,loading:this.state.loading,loadingBucketID:this.state.showItemLoader?this.state.bucketID:null,userBucketIsLive:this.state.userBucketIsLive,onItemSelect:this.$FBStoriesTrayContainer2}),this.state.isViewerOpen&&c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('FBStoriesTheater.react').__setRef('FBStoriesTrayContainer.react'),placeholder:c('React').createElement(n,null),component:c('React').createElement(c('LazyComponent.react'),{onHide:this.$FBStoriesTrayContainer3,onClose:this.$FBStoriesTrayContainer4,onDone:this.$FBStoriesTrayContainer5,onMute:this.$FBStoriesTrayContainer6,isStoryMuted:this.state.isStoryMuted})}))};m.prototype.$FBStoriesTrayContainer1=function(){var p=this.state,q=p.friendsData,r=p.userBucket,s=p.loading,t=!c('FBStoriesBucketHelper').hasData(r),u=!q||q.length===0,v=t&&u;return !s&&v};m.prototype.$FBStoriesTrayContainer7=function(){if(this.state.isOwnBucket&&this.state.currentThreadID)c('Bootloader').loadModules(["FBStoriesActions"],function(p){p.markThreadViewersSeen(this.state.currentThreadID)}.bind(this),'FBStoriesTrayContainer.react');if(this.state.selectedBucketIsLive)c('Bootloader').loadModules(["FBStoriesActions"],function(p){p.removeEndedLiveVideo()},'FBStoriesTrayContainer.react');c('Bootloader').loadModules(["FBStoriesActions","FBStoriesLiveVideoActions","UFIRootRegistry"],function(p,q,r){p.unselectBucket();q.removeUIComponents();r.cleanupSnowliftNodes()},'FBStoriesTrayContainer.react');this.setState({isViewerOpen:false,isStoryMuted:false})};m.defaultProps={showAsPreviews:false,renderPerf:false};k=babelHelpers.inherits(n,c('React').PureComponent);l=k&&k.prototype;n.prototype.componentWillMount=function(){if(this.props.onLoad)this.props.onLoad();};n.prototype.componentWillUnmount=function(){if(this.props.onHide)this.props.onHide();};n.prototype.render=function(){return null};function n(){k.apply(this,arguments)}var o=function p(){var q=function r(s){return c('React').createElement('div',{className:"_h0-",key:s},c('React').createElement('div',{className:"_2ms4"},c('React').createElement('div',{className:"_2ms5"})),c('React').createElement('div',{className:"_2ms6"}),c('React').createElement('div',{className:"_2ms8"}))};return c('React').createElement('div',{className:"_h1i"},c('React').createElement('div',{className:"_h1m"},c('range')(0,10).map(q)))};f.exports=c('FluxContainer').create(m)}),null);